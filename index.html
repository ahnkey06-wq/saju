<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ì‚¬ì£¼íŒ”ì ë¶„ì„ Â· å››æŸ±å…«å­—</title>
<meta name="description" content="ìƒë…„ì›”ì¼ì‹œë¥¼ ì…ë ¥í•˜ë©´ ì‚¬ì£¼íŒ”ì(å››æŸ±å…«å­—)ë¥¼ ìë™ ê³„ì‚°í•˜ê³  ì˜¤í–‰ ë¶„ì„, ì„±ê²©, ìš´ì„¸ë¥¼ ì•Œë ¤ë“œë¦½ë‹ˆë‹¤.">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700;900&family=Noto+Serif+KR:wght@400;500;600;700;900&display=swap" rel="stylesheet">
<style>
:root {
    --bg: #f5f5f5;
    --bg-light: #2a2218;
    --bg-card: #332a1f;
    --bg-card-light: #3d3225;
    --border: #5a4a35;
    --border-light: #7a6a50;
    --gold: #d4a543;
    --gold-light: #e8c468;
    --gold-dark: #b08930;
    --red: #c44040;
    --red-light: #e06060;
    --text: #f0e6d6;
    --text-secondary: #bfb09a;
    --text-muted: #8a7a65;
    --wood: #4a9e5e;
    --fire: #d45050;
    --earth: #c4a042;
    --metal: #c0c0c0;
    --water: #4a7ec4;
}
* { margin:0; padding:0; box-sizing:border-box; }
body {
    font-family: 'Noto Sans KR', sans-serif;
    background: transparent;
    color: var(--text);
    min-height: 100vh;
    position: relative;
}
body::before {
    content: '';
    position: fixed;
    top: 0; left: 0; right: 0; bottom: 0;
    z-index: 0;
    pointer-events: none;
    background-color: #ede5d5;
    background-image:
        url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1600 1000'%3E%3Cdefs%3E%3ClinearGradient id='sky' x1='0' y1='0' x2='0' y2='1'%3E%3Cstop offset='0' stop-color='%23ddd5c5'/%3E%3Cstop offset='0.3' stop-color='%23e5ddd0'/%3E%3Cstop offset='0.7' stop-color='%23ede5d5'/%3E%3Cstop offset='1' stop-color='%23ede5d5'/%3E%3C/linearGradient%3E%3ClinearGradient id='mist' x1='0' y1='0' x2='1' y2='0'%3E%3Cstop offset='0' stop-color='%23ede5d5' stop-opacity='0'/%3E%3Cstop offset='0.2' stop-color='%23ede5d5' stop-opacity='0.85'/%3E%3Cstop offset='0.5' stop-color='%23ede5d5' stop-opacity='0.95'/%3E%3Cstop offset='0.8' stop-color='%23ede5d5' stop-opacity='0.85'/%3E%3Cstop offset='1' stop-color='%23ede5d5' stop-opacity='0'/%3E%3C/linearGradient%3E%3ClinearGradient id='fade' x1='0' y1='0' x2='0' y2='1'%3E%3Cstop offset='0' stop-color='%23ede5d5' stop-opacity='0.9'/%3E%3Cstop offset='1' stop-color='%23ede5d5' stop-opacity='0'/%3E%3C/linearGradient%3E%3Cfilter id='ink'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.04' numOctaves='4' seed='2'/%3E%3CfeDisplacementMap in='SourceGraphic' scale='3'/%3E%3C/filter%3E%3C/defs%3E%3Crect fill='url(%23sky)' width='1600' height='1000'/%3E%3Crect y='0' width='1600' height='200' fill='url(%23fade)'/%3E%3Cg opacity='0.15'%3E%3Ccircle cx='250' cy='150' r='55' fill='%23c0a878'/%3E%3Ccircle cx='275' cy='155' r='45' fill='%23ede5d5'/%3E%3C/g%3E%3Cg opacity='0.06'%3E%3Cellipse cx='900' cy='100' rx='140' ry='30' fill='%23c0a878'/%3E%3Cellipse cx='950' cy='95' rx='110' ry='24' fill='%23ddd5c5'/%3E%3Cellipse cx='860' cy='105' rx='90' ry='20' fill='%23ddd5c5'/%3E%3C/g%3E%3Cg opacity='0.05'%3E%3Cellipse cx='400' cy='130' rx='100' ry='22' fill='%23c0a878'/%3E%3Cellipse cx='440' cy='126' rx='75' ry='18' fill='%23ddd5c5'/%3E%3C/g%3E%3Cpath d='M-50 1000 L-50 480 Q0 400 80 440 Q160 350 260 420 Q340 300 440 380 Q520 280 600 340 Q650 300 700 330 L700 1000Z' fill='%23706050' opacity='0.22' filter='url(%23ink)'/%3E%3Cpath d='M-50 1000 L-50 520 Q30 460 120 490 Q200 400 300 460 Q380 350 460 410 Q530 340 600 380 Q660 340 700 360 L700 1000Z' fill='%23887868' opacity='0.12'/%3E%3Cpath d='M-50 1000 L-50 560 Q50 510 140 530 Q220 470 310 510 Q390 440 470 480 Q530 430 580 460 L580 1000Z' fill='%23a09888' opacity='0.06'/%3E%3Cpath d='M900 1000 L900 420 Q980 340 1080 390 Q1140 280 1250 340 Q1320 240 1420 300 Q1500 250 1560 280 Q1620 260 1680 290 L1680 1000Z' fill='%23605040' opacity='0.25' filter='url(%23ink)'/%3E%3Cpath d='M930 1000 L930 460 Q1010 390 1100 430 Q1180 330 1280 380 Q1350 290 1440 340 Q1510 300 1580 320 Q1640 290 1680 310 L1680 1000Z' fill='%23887060' opacity='0.13'/%3E%3Cpath d='M960 1000 L960 500 Q1040 440 1120 470 Q1200 380 1290 420 Q1360 350 1440 390 Q1500 360 1560 380 L1560 1000Z' fill='%23a09080' opacity='0.07'/%3E%3Cpath d='M350 1000 L350 580 Q430 530 530 560 Q620 500 720 540 Q790 480 870 520 Q920 490 980 510 L980 1000Z' fill='%23807060' opacity='0.12'/%3E%3Cpath d='M400 1000 L400 620 Q480 580 560 600 Q630 560 710 580 Q770 540 840 570 Q890 550 940 560 L940 1000Z' fill='%23908070' opacity='0.07'/%3E%3Crect y='440' width='1600' height='40' fill='url(%23mist)' opacity='0.7'/%3E%3Crect y='520' width='1600' height='25' fill='url(%23mist)' opacity='0.5'/%3E%3Crect y='620' width='1600' height='35' fill='url(%23mist)' opacity='0.4'/%3E%3Crect y='750' width='1600' height='20' fill='url(%23mist)' opacity='0.3'/%3E%3Cg opacity='0.1' stroke='%23605040' stroke-width='0.8' fill='none'%3E%3Cpath d='M80 600 Q85 570 90 580 Q95 555 100 570 Q105 545 108 560'/%3E%3Cpath d='M95 570 L97 530 M92 575 L90 535 M100 565 L102 528'/%3E%3Cpath d='M85 580 Q82 575 88 572 Q84 568 90 566'/%3E%3C/g%3E%3Cg opacity='0.08' stroke='%23605040' stroke-width='0.8' fill='none'%3E%3Cpath d='M1420 520 Q1425 485 1430 498 Q1435 470 1440 488 Q1445 462 1448 478'/%3E%3Cpath d='M1435 490 L1437 445 M1432 495 L1430 450 M1440 485 L1442 442'/%3E%3Cpath d='M1425 500 Q1422 494 1428 491 Q1424 487 1430 485'/%3E%3C/g%3E%3Cg opacity='0.07' stroke='%23605040' stroke-width='0.7' fill='none'%3E%3Cpath d='M750 640 Q755 610 760 622 Q765 598 770 614'/%3E%3Cpath d='M762 618 L764 580 M758 624 L756 586'/%3E%3Cpath d='M755 628 Q752 623 758 620'/%3E%3C/g%3E%3Cg opacity='0.04' stroke='%23605040' stroke-width='0.5' fill='none'%3E%3Cpath d='M500 700 Q510 692 520 696 Q530 688 540 694 Q550 685 560 690'/%3E%3Cpath d='M1100 670 Q1110 662 1120 666 Q1130 658 1140 664'/%3E%3C/g%3E%3Cg opacity='0.04' fill='%23605040'%3E%3Ccircle cx='160' cy='680' r='1.5'/%3E%3Ccircle cx='165' cy='675' r='1'/%3E%3Ccircle cx='155' cy='678' r='1.2'/%3E%3Ccircle cx='1350' cy='620' r='1.5'/%3E%3Ccircle cx='1345' cy='615' r='1'/%3E%3Ccircle cx='1355' cy='618' r='1.2'/%3E%3C/g%3E%3C/svg%3E");
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
}
body > * {
    position: relative;
    z-index: 1;
}
.serif { font-family: 'Noto Serif KR', serif; }

/* Header */
.header {
    text-align: center;
    padding: 48px 20px 32px;
    position: relative;
}
.header::after {
    content: '';
    display: block;
    width: 120px;
    height: 2px;
    background: linear-gradient(90deg, transparent, var(--gold), transparent);
    margin: 24px auto 0;
}
.header-hanja {
    font-size: 14px;
    color: var(--gold);
    letter-spacing: 12px;
    margin-bottom: 8px;
}
.header h1 {
    font-family: 'Noto Serif KR', serif;
    font-size: 36px;
    font-weight: 700;
    color: var(--text);
    letter-spacing: 4px;
}
.header h1 span { color: var(--gold); }
.header-sub {
    font-size: 14px;
    color: var(--text-muted);
    margin-top: 8px;
}

/* Container */
.container {
    max-width: 800px;
    margin: 0 auto;
    padding: 0 20px 80px;
}

/* Input Section */
.input-section {
    background: var(--bg-card);
    border: 1px solid var(--border);
    border-radius: 16px;
    padding: 32px;
    margin-top: 32px;
    position: relative;
}
.input-section::before {
    content: 'â˜°';
    position: absolute;
    top: -14px;
    left: 50%;
    transform: translateX(-50%);
    background: var(--bg-card);
    color: var(--gold);
    padding: 0 16px;
    font-size: 20px;
}
.section-title {
    font-family: 'Noto Serif KR', serif;
    font-size: 20px;
    font-weight: 600;
    text-align: center;
    margin-bottom: 24px;
    color: var(--gold-light);
}
.form-row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 16px;
    margin-bottom: 16px;
}
.form-group {
    display: flex;
    flex-direction: column;
    gap: 6px;
}
.form-group.full {
    grid-column: 1 / -1;
}
.form-label {
    font-size: 13px;
    color: var(--text-secondary);
    font-weight: 500;
}
.form-input {
    background: var(--bg-light);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 12px 16px;
    color: var(--text);
    font-size: 15px;
    font-family: 'Noto Sans KR', sans-serif;
    outline: none;
    transition: all 0.3s;
    -webkit-appearance: none;
}
.form-input:focus {
    border-color: var(--gold);
    box-shadow: 0 0 0 3px rgba(212,165,67,0.15);
}
select.form-input {
    cursor: pointer;
}
.gender-row {
    display: flex;
    gap: 12px;
}
.gender-btn {
    flex: 1;
    padding: 12px;
    background: var(--bg-light);
    border: 1px solid var(--border);
    border-radius: 10px;
    color: var(--text-secondary);
    font-size: 15px;
    cursor: pointer;
    transition: all 0.3s;
    text-align: center;
    font-family: 'Noto Sans KR', sans-serif;
}
.gender-btn:hover { border-color: var(--gold); }
.gender-btn.active {
    background: rgba(212,165,67,0.15);
    border-color: var(--gold);
    color: var(--gold-light);
    font-weight: 600;
}
.submit-btn {
    display: block;
    width: 100%;
    padding: 16px;
    margin-top: 24px;
    background: linear-gradient(135deg, var(--gold-dark), var(--gold));
    border: none;
    border-radius: 12px;
    color: #1a1410;
    font-size: 17px;
    font-weight: 700;
    font-family: 'Noto Serif KR', serif;
    cursor: pointer;
    transition: all 0.3s;
    letter-spacing: 4px;
}
.submit-btn:hover {
    background: linear-gradient(135deg, var(--gold), var(--gold-light));
    transform: translateY(-1px);
    box-shadow: 0 4px 20px rgba(212,165,67,0.3);
}
.submit-btn:active { transform: translateY(0); }

/* Result Section */
#result { display: none; margin-top: 32px; }

/* Saju Pillars */
.pillars-card {
    background: var(--bg-card);
    border: 1px solid var(--border);
    border-radius: 16px;
    padding: 28px;
    text-align: center;
}
.pillars-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 12px;
    margin-top: 20px;
}
.pillar {
    background: var(--bg-light);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 16px 8px;
    transition: all 0.3s;
}
.pillar:hover {
    border-color: var(--gold);
    transform: translateY(-2px);
}
.pillar-label {
    font-size: 12px;
    color: var(--text-muted);
    margin-bottom: 4px;
}
.pillar-hanja {
    font-size: 11px;
    color: var(--text-muted);
}
.pillar-char {
    font-family: 'Noto Serif KR', serif;
    font-size: 36px;
    font-weight: 700;
    line-height: 1.2;
    margin: 6px 0;
}
.pillar-name {
    font-size: 13px;
    color: var(--text-secondary);
    margin-top: 2px;
}
.pillar-element {
    display: inline-block;
    font-size: 11px;
    padding: 2px 8px;
    border-radius: 6px;
    margin-top: 6px;
    font-weight: 500;
}
.el-wood { background: rgba(74,158,94,0.2); color: var(--wood); }
.el-fire { background: rgba(212,80,80,0.2); color: var(--fire); }
.el-earth { background: rgba(196,160,66,0.2); color: var(--earth); }
.el-metal { background: rgba(192,192,192,0.2); color: var(--metal); }
.el-water { background: rgba(74,126,196,0.2); color: var(--water); }
.divider {
    width: 100%;
    height: 1px;
    background: var(--border);
    margin: 8px 0;
}

/* Ohaeng (Five Elements) */
.ohaeng-card {
    background: var(--bg-card);
    border: 1px solid var(--border);
    border-radius: 16px;
    padding: 28px;
    margin-top: 16px;
}
.ohaeng-bars {
    display: flex;
    flex-direction: column;
    gap: 14px;
    margin-top: 20px;
}
.ohaeng-row {
    display: flex;
    align-items: center;
    gap: 12px;
}
.ohaeng-label {
    width: 60px;
    font-size: 14px;
    font-weight: 600;
    text-align: right;
    flex-shrink: 0;
}
.ohaeng-bar-bg {
    flex: 1;
    height: 28px;
    background: var(--bg-light);
    border-radius: 8px;
    overflow: hidden;
    position: relative;
}
.ohaeng-bar {
    height: 100%;
    border-radius: 8px;
    transition: width 1s ease-out;
    display: flex;
    align-items: center;
    padding-left: 10px;
    font-size: 12px;
    font-weight: 600;
    color: #fff;
    min-width: 30px;
}
.bar-wood { background: linear-gradient(90deg, #3a7e4e, #5abe72); }
.bar-fire { background: linear-gradient(90deg, #b03030, #e05050); }
.bar-earth { background: linear-gradient(90deg, #a08030, #c4a042); }
.bar-metal { background: linear-gradient(90deg, #808080, #b0b0b0); }
.bar-water { background: linear-gradient(90deg, #3a5ea0, #5a8ed4); }
.ohaeng-count {
    width: 28px;
    font-size: 14px;
    font-weight: 700;
    text-align: center;
    flex-shrink: 0;
}

/* Analysis Cards */
.analysis-card {
    background: var(--bg-card);
    border: 1px solid var(--border);
    border-radius: 16px;
    padding: 28px;
    margin-top: 16px;
}
.analysis-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
    margin-top: 16px;
}
.analysis-item {
    background: var(--bg-light);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 16px;
}
.analysis-item-title {
    font-size: 13px;
    color: var(--gold);
    font-weight: 600;
    margin-bottom: 6px;
}
.analysis-item-text {
    font-size: 14px;
    color: var(--text-secondary);
    line-height: 1.6;
}
.personality-text {
    margin-top: 16px;
    font-size: 15px;
    color: var(--text-secondary);
    line-height: 1.8;
    padding: 20px;
    background: var(--bg-light);
    border-radius: 12px;
    border-left: 3px solid var(--gold);
}

/* Ilgan Box */
.ilgan-box {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 20px;
    margin-top: 16px;
    padding: 20px;
    background: var(--bg-light);
    border-radius: 12px;
    border: 1px solid var(--border);
}
.ilgan-char {
    font-family: 'Noto Serif KR', serif;
    font-size: 48px;
    font-weight: 900;
}
.ilgan-info h3 {
    font-size: 18px;
    font-weight: 700;
    margin-bottom: 4px;
}
.ilgan-info p {
    font-size: 14px;
    color: var(--text-secondary);
}

/* 2026 Fortune Section */
.fortune-card {
    background: var(--bg-card);
    border: 1px solid var(--border);
    border-radius: 16px;
    padding: 28px;
    margin-top: 16px;
    position: relative;
    overflow: hidden;
}
.fortune-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 3px;
    background: linear-gradient(90deg, var(--fire), var(--gold), var(--fire));
}
.fortune-year-header {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 16px;
    margin-bottom: 20px;
    padding: 16px;
    background: linear-gradient(135deg, rgba(212,80,80,0.1), rgba(212,165,67,0.1));
    border-radius: 12px;
    border: 1px solid rgba(212,80,80,0.2);
}
.fortune-year-char {
    font-family: 'Noto Serif KR', serif;
    font-size: 42px;
    font-weight: 900;
    color: var(--fire);
}
.fortune-year-info h3 {
    font-size: 20px;
    font-weight: 700;
    color: var(--gold-light);
}
.fortune-year-info p {
    font-size: 13px;
    color: var(--text-secondary);
}
.fortune-score {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 24px;
    margin: 20px 0;
    padding: 20px;
    background: var(--bg-light);
    border-radius: 12px;
}
.score-circle {
    width: 90px;
    height: 90px;
    border-radius: 50%;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    font-weight: 700;
    border: 3px solid;
    flex-shrink: 0;
}
.score-circle .score-num {
    font-size: 28px;
    line-height: 1;
}
.score-circle .score-label {
    font-size: 11px;
    margin-top: 2px;
}
.score-detail {
    flex: 1;
}
.score-row {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 8px;
}
.score-row-label {
    width: 70px;
    font-size: 13px;
    color: var(--text-secondary);
    flex-shrink: 0;
}
.score-bar-bg {
    flex: 1;
    height: 10px;
    background: rgba(255,255,255,0.05);
    border-radius: 5px;
    overflow: hidden;
}
.score-bar {
    height: 100%;
    border-radius: 5px;
    transition: width 1s ease-out;
}
.score-row-val {
    width: 30px;
    text-align: right;
    font-size: 13px;
    font-weight: 600;
    flex-shrink: 0;
}
.fortune-monthly {
    margin-top: 20px;
}
.monthly-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 8px;
    margin-top: 12px;
}
.month-card {
    background: var(--bg-light);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 12px 8px;
    text-align: center;
    transition: all 0.3s;
}
.month-card:hover {
    border-color: var(--gold);
    transform: translateY(-2px);
}
.month-num {
    font-size: 12px;
    color: var(--text-muted);
    margin-bottom: 4px;
}
.month-icon {
    font-size: 20px;
    margin-bottom: 4px;
}
.month-luck {
    font-size: 12px;
    font-weight: 600;
}
.month-desc {
    font-size: 11px;
    color: var(--text-secondary);
    margin-top: 4px;
    line-height: 1.4;
}
.fortune-advice {
    margin-top: 20px;
    padding: 20px;
    background: linear-gradient(135deg, rgba(212,165,67,0.08), rgba(74,126,196,0.05));
    border: 1px solid rgba(212,165,67,0.2);
    border-radius: 12px;
    border-left: 3px solid var(--gold);
}
.fortune-advice-title {
    font-size: 14px;
    font-weight: 700;
    color: var(--gold);
    margin-bottom: 8px;
}
.fortune-advice-text {
    font-size: 14px;
    color: var(--text-secondary);
    line-height: 1.8;
}
.luck-excellent { color: #f59e0b; }
.luck-good { color: #10b981; }
.luck-normal { color: #94a3b8; }
.luck-caution { color: #f97316; }
.luck-difficult { color: #ef4444; }
.bar-excellent { background: linear-gradient(90deg, #d97706, #f59e0b); }
.bar-good { background: linear-gradient(90deg, #059669, #10b981); }
.bar-normal { background: linear-gradient(90deg, #64748b, #94a3b8); }
.bar-caution { background: linear-gradient(90deg, #c2410c, #f97316); }

/* í‰ìƒìš´(ëŒ€ìš´) ì„¹ì…˜ */
.lifetime-card {
    background: var(--bg-card);
    border: 1px solid var(--border);
    border-radius: 16px;
    padding: 28px;
    margin-top: 16px;
    position: relative;
    overflow: hidden;
}
.lifetime-card::before {
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0;
    height: 3px;
    background: linear-gradient(90deg, var(--water), var(--gold), var(--wood), var(--fire), var(--metal));
}
.lifetime-summary {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 12px;
    margin: 16px 0;
}
.lifetime-summary-item {
    background: var(--bg-light);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 14px;
    text-align: center;
}
.lifetime-summary-item .ls-label {
    font-size: 12px;
    color: var(--text-muted);
    margin-bottom: 4px;
}
.lifetime-summary-item .ls-value {
    font-size: 18px;
    font-weight: 700;
}
.daeun-timeline {
    display: flex;
    overflow-x: auto;
    gap: 0;
    margin: 20px 0;
    padding: 8px 0;
    position: relative;
}
.daeun-timeline::after {
    content: '';
    position: absolute;
    top: 50%;
    left: 0; right: 0;
    height: 2px;
    background: var(--border);
    z-index: 0;
}
.daeun-item {
    flex: 0 0 auto;
    width: 100px;
    text-align: center;
    position: relative;
    z-index: 1;
    cursor: default;
    transition: all 0.3s;
    padding: 8px 4px;
}
.daeun-item:hover {
    transform: translateY(-3px);
}
.daeun-item.current {
    transform: scale(1.08);
}
.daeun-item.current .daeun-box {
    border-color: var(--gold);
    box-shadow: 0 0 12px rgba(212,165,67,0.3);
}
.daeun-item.past .daeun-box {
    opacity: 0.5;
}
.daeun-box {
    background: var(--bg-card);
    border: 2px solid var(--border);
    border-radius: 12px;
    padding: 10px 6px;
    transition: all 0.3s;
}
.daeun-age {
    font-size: 11px;
    color: var(--text-muted);
    margin-bottom: 4px;
}
.daeun-chars {
    font-family: 'Noto Serif KR', serif;
    font-size: 22px;
    font-weight: 700;
    line-height: 1.3;
}
.daeun-name {
    font-size: 11px;
    color: var(--text-secondary);
    margin-top: 2px;
}
.daeun-element-tag {
    display: inline-block;
    font-size: 10px;
    padding: 1px 6px;
    border-radius: 4px;
    margin-top: 4px;
    font-weight: 500;
}
.daeun-score-bar {
    width: 100%;
    height: 4px;
    background: rgba(255,255,255,0.05);
    border-radius: 2px;
    margin-top: 6px;
    overflow: hidden;
}
.daeun-score-fill {
    height: 100%;
    border-radius: 2px;
    transition: width 1s ease-out;
}
.current-daeun-detail {
    background: var(--bg-light);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 20px;
    margin: 16px 0;
    border-left: 3px solid var(--gold);
}
.current-daeun-detail h4 {
    font-size: 16px;
    font-weight: 700;
    color: var(--gold-light);
    margin-bottom: 12px;
}
.cd-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 10px;
}
.cd-item {
    background: var(--bg-card);
    border-radius: 8px;
    padding: 12px;
}
.cd-item-label {
    font-size: 12px;
    color: var(--text-muted);
    margin-bottom: 4px;
}
.cd-item-value {
    font-size: 14px;
    font-weight: 600;
    color: var(--text);
}
.lifetime-flow {
    margin-top: 16px;
}
.flow-title {
    font-size: 15px;
    font-weight: 700;
    color: var(--gold-light);
    margin-bottom: 12px;
}
.flow-chart {
    display: flex;
    align-items: flex-end;
    gap: 2px;
    height: 80px;
    padding: 4px 0;
}
.flow-bar-wrap {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    height: 100%;
    justify-content: flex-end;
}
.flow-bar {
    width: 100%;
    max-width: 32px;
    border-radius: 4px 4px 0 0;
    transition: height 1s ease-out;
    min-height: 4px;
}
.flow-bar-label {
    font-size: 9px;
    color: var(--text-muted);
    margin-top: 4px;
    white-space: nowrap;
}
.lifetime-advice {
    margin-top: 16px;
    padding: 16px;
    background: linear-gradient(135deg, rgba(74,126,196,0.08), rgba(212,165,67,0.05));
    border: 1px solid rgba(74,126,196,0.2);
    border-radius: 12px;
    border-left: 3px solid var(--water);
}
.lifetime-advice-title {
    font-size: 14px;
    font-weight: 700;
    color: var(--water);
    margin-bottom: 8px;
}
.lifetime-advice-text {
    font-size: 14px;
    color: var(--text-secondary);
    line-height: 1.8;
}

@media (max-width: 640px) {
    .monthly-grid { grid-template-columns: repeat(3, 1fr); }
    .fortune-score { flex-direction: column; }
    .fortune-year-char { font-size: 32px; }
    .lifetime-summary { grid-template-columns: 1fr; }
    .daeun-item { width: 80px; }
    .daeun-chars { font-size: 18px; }
    .cd-grid { grid-template-columns: 1fr; }
    .flow-bar-label { font-size: 8px; }
}

/* Footer */
.footer {
    text-align: center;
    padding: 32px 20px;
    color: var(--text-muted);
    font-size: 12px;
    border-top: 1px solid var(--border);
    margin-top: 48px;
}
.footer-hanja {
    font-family: 'Noto Serif KR', serif;
    font-size: 14px;
    color: var(--border-light);
    letter-spacing: 8px;
    margin-bottom: 8px;
}

/* Responsive */
@media (max-width: 640px) {
    .header h1 { font-size: 28px; }
    .form-row { grid-template-columns: 1fr; }
    .pillars-grid { grid-template-columns: repeat(4, 1fr); gap: 6px; }
    .pillar { padding: 12px 4px; }
    .pillar-char { font-size: 28px; }
    .analysis-grid { grid-template-columns: 1fr; }
    .input-section, .pillars-card, .ohaeng-card, .analysis-card { padding: 20px; }
    .ilgan-char { font-size: 36px; }
}
</style>
</head>
<body>

<header class="header">
    <div class="header-hanja serif">å›› æŸ± å…« å­—</div>
    <h1 class="serif">ì‚¬ì£¼<span>íŒ”ì</span> ë¶„ì„</h1>
    <div class="header-sub">ìƒë…„ì›”ì¼ì‹œë¥¼ ì…ë ¥í•˜ë©´ ë‹¹ì‹ ì˜ ì‚¬ì£¼íŒ”ìë¥¼ í’€ì–´ë“œë¦½ë‹ˆë‹¤</div>
</header>

<main class="container">
    <!-- Input Form -->
    <section class="input-section">
        <div class="section-title serif">ìƒë…„ì›”ì¼ì‹œ ì…ë ¥</div>
        <div class="form-row">
            <div class="form-group">
                <label class="form-label">ì–‘ë ¥ / ìŒë ¥</label>
                <select id="calType" class="form-input">
                    <option value="solar">ì–‘ë ¥ (é™½æ›†)</option>
                    <option value="lunar">ìŒë ¥ (é™°æ›†)</option>
                </select>
            </div>
            <div class="form-group">
                <label class="form-label">ì„±ë³„</label>
                <div class="gender-row">
                    <button type="button" class="gender-btn active" data-gender="male" onclick="selectGender(this)">â™‚ ë‚¨ì„±</button>
                    <button type="button" class="gender-btn" data-gender="female" onclick="selectGender(this)">â™€ ì—¬ì„±</button>
                </div>
            </div>
        </div>
        <div class="form-row">
            <div class="form-group">
                <label class="form-label">ì¶œìƒë…„ë„</label>
                <select id="year" class="form-input"></select>
            </div>
            <div class="form-group">
                <label class="form-label">ì¶œìƒì›”</label>
                <select id="month" class="form-input"></select>
            </div>
        </div>
        <div class="form-row">
            <div class="form-group">
                <label class="form-label">ì¶œìƒì¼</label>
                <select id="day" class="form-input"></select>
            </div>
            <div class="form-group">
                <label class="form-label">ì¶œìƒì‹œê°„</label>
                <select id="hour" class="form-input">
                    <option value="-1">ëª¨ë¦„</option>
                    <option value="0">å­ì‹œ (23:00~01:00)</option>
                    <option value="1">ä¸‘ì‹œ (01:00~03:00)</option>
                    <option value="2">å¯…ì‹œ (03:00~05:00)</option>
                    <option value="3">å¯ì‹œ (05:00~07:00)</option>
                    <option value="4">è¾°ì‹œ (07:00~09:00)</option>
                    <option value="5">å·³ì‹œ (09:00~11:00)</option>
                    <option value="6">åˆì‹œ (11:00~13:00)</option>
                    <option value="7">æœªì‹œ (13:00~15:00)</option>
                    <option value="8">ç”³ì‹œ (15:00~17:00)</option>
                    <option value="9">é…‰ì‹œ (17:00~19:00)</option>
                    <option value="10">æˆŒì‹œ (19:00~21:00)</option>
                    <option value="11">äº¥ì‹œ (21:00~23:00)</option>
                </select>
            </div>
        </div>
        <div class="form-row">
            <div class="form-group" style="flex:1">
                <label class="form-label">ì´ë¦„ (ì„±ëª…í•™ ë¶„ì„ìš©, í•œê¸€)</label>
                <input id="userName" type="text" class="form-input" placeholder="ì˜ˆ: í™ê¸¸ë™" maxlength="10" style="background:var(--bg-card);border:1px solid var(--border);color:var(--text);padding:12px 16px;border-radius:8px;font-size:15px;">
            </div>
        </div>
        <button class="submit-btn" onclick="analyze()">ì¢… í•© ë¶„ ì„</button>
    </section>

    <!-- Result -->
    <div id="result">
        <!-- Ilgan (Day Master) -->
        <section class="analysis-card" id="ilganSection">
            <div class="section-title serif">ğŸ”® ì¼ê°„ (æ—¥å¹²) â€” ë‚˜ì˜ ë³¸ì§ˆ</div>
            <div id="ilganBox" class="ilgan-box"></div>
        </section>

        <!-- Four Pillars -->
        <section class="pillars-card" id="pillarsSection">
            <div class="section-title serif">å››æŸ±å…«å­— â€” ì‚¬ì£¼íŒ”ì</div>
            <div class="pillars-grid" id="pillarsGrid"></div>
        </section>

        <!-- Five Elements -->
        <section class="ohaeng-card" id="ohaengSection">
            <div class="section-title serif">äº”è¡Œ â€” ì˜¤í–‰ ë¶„ì„</div>
            <div class="ohaeng-bars" id="ohaengBars"></div>
        </section>

        <!-- Personality -->
        <section class="analysis-card" id="personalitySection">
            <div class="section-title serif">æ€§æ ¼ â€” ì„±ê²© ë¶„ì„</div>
            <div id="personalityText" class="personality-text"></div>
        </section>

        <!-- Detailed Analysis -->
        <section class="analysis-card" id="detailSection">
            <div class="section-title serif">å‘½ç† â€” ìƒì„¸ ë¶„ì„</div>
            <div class="analysis-grid" id="detailGrid"></div>
        </section>

        <!-- 2026 Fortune -->
        <section class="fortune-card" id="fortuneSection">
            <div class="section-title serif">ğŸ´ 2026ë…„ ä¸™åˆå¹´ ìš´ì„¸</div>
            <div id="fortuneYearHeader" class="fortune-year-header"></div>
            <div id="fortuneScore" class="fortune-score"></div>
            <div id="fortuneMonthly" class="fortune-monthly"></div>
            <div id="fortuneAdvice" class="fortune-advice"></div>
        </section>

        <!-- ì„±ëª…í•™ (Name Analysis) -->
        <section class="analysis-card" id="nameSection">
            <div class="section-title serif">å§“åå­¸ â€” ì„±ëª…í•™ ë¶„ì„</div>
            <div id="nameContent"></div>
        </section>

        <!-- ìˆ˜ë¦¬í•™ (Numerology) -->
        <section class="analysis-card" id="numerologySection">
            <div class="section-title serif">æ•¸ç†å­¸ â€” ìˆ˜ë¦¬ ë¶„ì„</div>
            <div id="numerologyContent"></div>
        </section>

        <!-- ì ì„±í•™ (Astrology) -->
        <section class="analysis-card" id="astrologySection">
            <div class="section-title serif">å æ˜Ÿå­¸ â€” ì„œì–‘ ì ì„±í•™ ë¶„ì„</div>
            <div id="astrologyContent"></div>
        </section>

        <!-- ìë¯¸ë‘ìˆ˜ (Purple Star Astrology) -->
        <section class="analysis-card" id="ziWeiSection">
            <div class="section-title serif">ç´«å¾®æ–—æ•¸ â€” ìë¯¸ë‘ìˆ˜ ë¶„ì„</div>
            <div id="ziWeiContent"></div>
        </section>

        <!-- ì‹ ì  ìŠ¤íƒ€ì¼ ë¶„ì„ (Shamanic Fortune) -->
        <section class="analysis-card" id="shamanSection">
            <div class="section-title serif">ğŸ”® ç¥å  â€” ì‹ ì  ìŠ¤íƒ€ì¼ ë¶„ì„</div>
            <div id="shamanContent"></div>
        </section>

        <!-- í‰ìƒìš´ (ëŒ€ìš´) -->
        <section class="lifetime-card" id="lifetimeSection">
            <div class="section-title serif">ğŸŒŠ í‰ìƒìš´ â€” å¤§é‹ì˜ íë¦„</div>
            <div id="lifetimeSummary" class="lifetime-summary"></div>
            <div id="daeunTimeline" class="daeun-timeline"></div>
            <div id="currentDaeunDetail" class="current-daeun-detail"></div>
            <div id="lifetimeFlow" class="lifetime-flow"></div>
            <div id="lifetimeAdvice" class="lifetime-advice"></div>
        </section>
    </div>
</main>

<footer class="footer">
    <div class="footer-hanja serif">å‘½ ç† å­¸</div>
    <p>ë³¸ ì‚¬ì´íŠ¸ì˜ ì‚¬ì£¼ ë¶„ì„ì€ ì°¸ê³ ìš©ì´ë©°, ì „ë¬¸ ì—­í•™ì¸ì˜ ìƒë‹´ì„ ëŒ€ì²´í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>
    <p style="margin-top:4px;">Â© 2025 ì‚¬ì£¼íŒ”ì ë¶„ì„ Â· å››æŸ±å…«å­—</p>
</footer>

<script>
// ===== ì²œê°„(å¤©å¹²) & ì§€ì§€(åœ°æ”¯) ë°ì´í„° =====
const CHEONGAN = ['ê°‘','ì„','ë³‘','ì •','ë¬´','ê¸°','ê²½','ì‹ ','ì„','ê³„'];
const CHEONGAN_HANJA = ['ç”²','ä¹™','ä¸™','ä¸','æˆŠ','å·±','åºš','è¾›','å£¬','ç™¸'];
const JIJI = ['ì','ì¶•','ì¸','ë¬˜','ì§„','ì‚¬','ì˜¤','ë¯¸','ì‹ ','ìœ ','ìˆ ','í•´'];
const JIJI_HANJA = ['å­','ä¸‘','å¯…','å¯','è¾°','å·³','åˆ','æœª','ç”³','é…‰','æˆŒ','äº¥'];

// ì˜¤í–‰ ë§¤í•‘
const CHEONGAN_ELEMENT = [0,0,1,1,2,2,3,3,4,4]; // ëª©,ëª©,í™”,í™”,í† ,í† ,ê¸ˆ,ê¸ˆ,ìˆ˜,ìˆ˜
const JIJI_ELEMENT = [4,2,0,0,2,1,1,2,3,3,2,4]; // ìˆ˜,í† ,ëª©,ëª©,í† ,í™”,í™”,í† ,ê¸ˆ,ê¸ˆ,í† ,ìˆ˜
const ELEMENT_NAMES = ['ëª©(æœ¨)','í™”(ç«)','í† (åœŸ)','ê¸ˆ(é‡‘)','ìˆ˜(æ°´)'];
const ELEMENT_COLORS = ['var(--wood)','var(--fire)','var(--earth)','var(--metal)','var(--water)'];
const ELEMENT_CLASSES = ['el-wood','el-fire','el-earth','el-metal','el-water'];
const BAR_CLASSES = ['bar-wood','bar-fire','bar-earth','bar-metal','bar-water'];
const ELEMENT_SHORT = ['æœ¨','ç«','åœŸ','é‡‘','æ°´'];

// ìŒì–‘
const CHEONGAN_YINYANG = ['ì–‘','ìŒ','ì–‘','ìŒ','ì–‘','ìŒ','ì–‘','ìŒ','ì–‘','ìŒ'];

// ì‹œê°„ ì²œê°„ ê³„ì‚° (ì¼ê°„ ê¸°ì¤€)
function getHourGan(dayGanIdx, hourIdx) {
    const base = (dayGanIdx % 5) * 2;
    return (base + hourIdx) % 10;
}

// ===== ë§Œì„¸ë ¥ ê³„ì‚° (ê°„ì†Œí™”) =====
// ê¸°ì¤€ì¼: 1900ë…„ 1ì›” 31ì¼ = ê²½ì(åºšå­)ë…„ ì •ì¶•(ä¸ä¸‘)ì›” ê°‘ì§„(ç”²è¾°)ì¼
// Julian Day Number ê¸°ë°˜ ê³„ì‚°

function solarToJDN(y, m, d) {
    const a = Math.floor((14 - m) / 12);
    const yy = y + 4800 - a;
    const mm = m + 12 * a - 3;
    return d + Math.floor((153 * mm + 2) / 5) + 365 * yy + Math.floor(yy / 4) - Math.floor(yy / 100) + Math.floor(yy / 400) - 32045;
}

// ì ˆê¸°(ç¯€æ°£) ê¸°ë°˜ ì›”ì£¼ ê³„ì‚° - ê°„ì†Œí™”ëœ ì ˆê¸° ì‹œì‘ì¼
// ê° ì›”ì˜ ì ˆê¸° ì‹œì‘ì¼ (ì–‘ë ¥ ê¸°ì¤€ ëŒ€ëµì )
const JEOLGI_DATES = [
    [2, 4],   // 1ì›”(ì¸ì›”): ì…ì¶˜ ~2/4
    [3, 6],   // 2ì›”(ë¬˜ì›”): ê²½ì¹© ~3/6
    [4, 5],   // 3ì›”(ì§„ì›”): ì²­ëª… ~4/5
    [5, 6],   // 4ì›”(ì‚¬ì›”): ì…í•˜ ~5/6
    [6, 6],   // 5ì›”(ì˜¤ì›”): ë§ì¢… ~6/6
    [7, 7],   // 6ì›”(ë¯¸ì›”): ì†Œì„œ ~7/7
    [8, 7],   // 7ì›”(ì‹ ì›”): ì…ì¶” ~8/7
    [9, 8],   // 8ì›”(ìœ ì›”): ë°±ë¡œ ~9/8
    [10, 8],  // 9ì›”(ìˆ ì›”): í•œë¡œ ~10/8
    [11, 7],  // 10ì›”(í•´ì›”): ì…ë™ ~11/7
    [12, 7],  // 11ì›”(ìì›”): ëŒ€ì„¤ ~12/7
    [1, 5],   // 12ì›”(ì¶•ì›”): ì†Œí•œ ~1/5
];

function getMonthPillar(yearGanIdx, solarMonth, solarDay) {
    // ì ˆê¸° ê¸°ì¤€ìœ¼ë¡œ ì›” ê²°ì •
    let monthIdx = -1; // ì¸ì›”=0 (1ì›”), ë¬˜ì›”=1 (2ì›”), ...
    for (let i = 0; i < 12; i++) {
        const [jm, jd] = JEOLGI_DATES[i];
        if (solarMonth === jm && solarDay >= jd) {
            monthIdx = i;
        } else if (solarMonth === jm && solarDay < jd) {
            monthIdx = (i + 11) % 12;
        }
    }
    if (monthIdx === -1) {
        // í•´ë‹¹ ì›”ì˜ ì ˆê¸° ê¸°ë°˜
        for (let i = 0; i < 12; i++) {
            const [jm, jd] = JEOLGI_DATES[i];
            if (solarMonth === jm) {
                monthIdx = solarDay >= jd ? i : (i + 11) % 12;
                break;
            }
        }
    }
    if (monthIdx === -1) monthIdx = (solarMonth + 9) % 12;

    // ì›” ì²œê°„: ì—°ê°„ ê¸°ì¤€
    const monthGanBase = (yearGanIdx % 5) * 2 + 2;
    const monthGan = (monthGanBase + monthIdx) % 10;
    // ì›” ì§€ì§€: ì¸(2)ë¶€í„°
    const monthJi = (monthIdx + 2) % 12;

    return { gan: monthGan, ji: monthJi };
}

// ì—°ì£¼ ê³„ì‚°
function getYearPillar(year, solarMonth, solarDay) {
    // ì…ì¶˜(2/4) ì „ì´ë©´ ì „ë…„ë„
    let adjYear = year;
    if (solarMonth < 2 || (solarMonth === 2 && solarDay < 4)) {
        adjYear = year - 1;
    }
    const ganIdx = (adjYear - 4) % 10;
    const jiIdx = (adjYear - 4) % 12;
    return { gan: (ganIdx + 10) % 10, ji: (jiIdx + 12) % 12 };
}

// ì¼ì£¼ ê³„ì‚° (JDN ê¸°ì¤€)
function getDayPillar(y, m, d) {
    const jdn = solarToJDN(y, m, d);
    // ê¸°ì¤€: JDN 2451911 = 2001-01-01 = ê°‘ì(ç”²å­)ì¼
    // ç”²=0, å­=0
    const diff = jdn - 2451911;
    const ganIdx = ((diff % 10) + 10) % 10;
    const jiIdx = ((diff % 12) + 12) % 12;
    return { gan: ganIdx, ji: jiIdx };
}

// ===== ì¼ê°„ë³„ ì„±ê²© & ë¶„ì„ =====
const ILGAN_DATA = {
    0: { name: 'ê°‘ëª©(ç”²æœ¨)', symbol: 'ğŸŒ³', nature: 'í° ë‚˜ë¬´, ëŒ€ë“¤ë³´',
        personality: 'ì •ì˜ê°ì´ ê°•í•˜ê³  ê³§ì€ ì„±í’ˆì˜ ì†Œìœ ìì…ë‹ˆë‹¤. ë¦¬ë”ì‹­ì´ ë›°ì–´ë‚˜ë©° í° ëœ»ì„ í’ˆê³  ìˆìŠµë‹ˆë‹¤. ìš°ì§í•˜ê³  ì±…ì„ê°ì´ ê°•í•˜ì§€ë§Œ, ë•Œë¡œëŠ” ê³ ì§‘ì´ ì„¸ê³  ìœ ì—°ì„±ì´ ë¶€ì¡±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í° ë‚˜ë¬´ì²˜ëŸ¼ í•œ ê³³ì— ë¿Œë¦¬ë¥¼ ë‚´ë¦¬ë©´ í”ë“¤ë¦¬ì§€ ì•ŠëŠ” ëˆê¸°ê°€ ìˆìŠµë‹ˆë‹¤.',
        career: 'ê²½ì˜ì, ì •ì¹˜ì¸, êµìœ¡ì, ë²•ì¡°ì¸',
        love: 'í—Œì‹ ì ì´ë©° í•œë²ˆ ë§ˆìŒì„ ì£¼ë©´ ë³€í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤',
        health: 'ê°„(è‚), ë‹´(è†½) ì£¼ì˜',
        lucky: 'ë´„(æ˜¥), ë™ìª½(æ±)' },
    1: { name: 'ì„ëª©(ä¹™æœ¨)', symbol: 'ğŸŒ¿', nature: 'í’€, ë„ì¿¨, ê½ƒ',
        personality: 'ë¶€ë“œëŸ½ê³  ìœ ì—°í•œ ì„±í’ˆìœ¼ë¡œ ì ì‘ë ¥ì´ ë›°ì–´ë‚©ë‹ˆë‹¤. ì˜ˆìˆ ì  ê°ê°ì´ íƒì›”í•˜ë©° ì„¬ì„¸í•œ ê°ì„±ì˜ ì†Œìœ ìì…ë‹ˆë‹¤. ê²‰ìœ¼ë¡œëŠ” ìœ ìˆœí•´ ë³´ì´ì§€ë§Œ ë‚´ë©´ì— ê°•í•œ ìƒëª…ë ¥ì„ í’ˆê³  ìˆì–´, ì–´ë–¤ í™˜ê²½ì—ì„œë„ ì‚´ì•„ë‚¨ëŠ” ëˆì§ˆê¸´ ë©´ì´ ìˆìŠµë‹ˆë‹¤.',
        career: 'ì˜ˆìˆ ê°€, ë””ìì´ë„ˆ, ìƒë‹´ì‚¬, êµì‚¬',
        love: 'ê°ì„±ì ì´ë©° ìƒëŒ€ë°©ì˜ ë§ˆìŒì„ ì˜ ì½ìŠµë‹ˆë‹¤',
        health: 'ê°„(è‚), ì‹ ê²½ê³„ ì£¼ì˜',
        lucky: 'ë´„(æ˜¥), ë™ìª½(æ±)' },
    2: { name: 'ë³‘í™”(ä¸™ç«)', symbol: 'â˜€ï¸', nature: 'íƒœì–‘, í° ë¶ˆ',
        personality: 'ë°ê³  í™”ë ¤í•œ ì„±ê²©ìœ¼ë¡œ ì£¼ë³€ì„ í™˜í•˜ê²Œ ë°íˆëŠ” ì‚¬ëŒì…ë‹ˆë‹¤. ì—´ì •ì ì´ê³  í™œë™ì ì´ë©° í‘œí˜„ë ¥ì´ ë›°ì–´ë‚©ë‹ˆë‹¤. ë‚™ì²œì ì´ê³  ê¸ì •ì ì¸ ì—ë„ˆì§€ê°€ ë„˜ì¹˜ì§€ë§Œ, ë•Œë¡œëŠ” ë‹¤í˜ˆì§ˆì ì´ê³  ê¸‰í•œ ë©´ì´ ìˆìŠµë‹ˆë‹¤. íƒœì–‘ì²˜ëŸ¼ ëª¨ë‘ì—ê²Œ ë”°ëœ»í•¨ì„ ì¤ë‹ˆë‹¤.',
        career: 'ë°©ì†¡ì¸, ì—°ì˜ˆì¸, ê°•ì‚¬, ë§ˆì¼€í„°',
        love: 'ì ê·¹ì ì´ë©° ì‚¬ë‘ì— ìˆì–´ ëœ¨ê±°ìš´ ì—´ì •ì„ ë³´ì…ë‹ˆë‹¤',
        health: 'ì‹¬ì¥(å¿ƒ), ì†Œì¥(å°è…¸) ì£¼ì˜',
        lucky: 'ì—¬ë¦„(å¤), ë‚¨ìª½(å—)' },
    3: { name: 'ì •í™”(ä¸ç«)', symbol: 'ğŸ•¯ï¸', nature: 'ì´›ë¶ˆ, ë³„ë¹›',
        personality: 'ì€ì€í•˜ê³  ì§€ì ì¸ ë§¤ë ¥ì˜ ì†Œìœ ìì…ë‹ˆë‹¤. ë‚´ë©´ì´ ë”°ëœ»í•˜ê³  ë°°ë ¤ì‹¬ì´ ê¹Šìœ¼ë©°, ì§ê´€ë ¥ì´ ë›°ì–´ë‚©ë‹ˆë‹¤. ì¡°ìš©í•˜ì§€ë§Œ ê¹Šì€ í†µì°°ë ¥ìœ¼ë¡œ í•µì‹¬ì„ ê¿°ëš«ìŠµë‹ˆë‹¤. ì´›ë¶ˆì²˜ëŸ¼ ì–´ë‘  ì†ì—ì„œ ë¹›ì„ ë°œí•˜ë©°, í•™ë¬¸ê³¼ ì˜ˆìˆ ì— ì¬ëŠ¥ì´ ìˆìŠµë‹ˆë‹¤.',
        career: 'ì—°êµ¬ì, í•™ì, ì‘ê°€, ì¢…êµì¸',
        love: 'ê¹Šì€ ë‚´ë©´ì˜ êµê°ì„ ì¤‘ì‹œí•©ë‹ˆë‹¤',
        health: 'ì‹¬ì¥(å¿ƒ), ëˆˆ(ç›®) ì£¼ì˜',
        lucky: 'ì—¬ë¦„(å¤), ë‚¨ìª½(å—)' },
    4: { name: 'ë¬´í† (æˆŠåœŸ)', symbol: 'â›°ï¸', nature: 'ì‚°, í° ë•…, ì œë°©',
        personality: 'ë“¬ì§í•˜ê³  í¬ìš©ë ¥ì´ í° ì„±ê²©ì…ë‹ˆë‹¤. ì‚°ì²˜ëŸ¼ ë¬µì§í•˜ê³  ì•ˆì •ì ì´ë©°, ë„“ì€ ëŒ€ì§€ì²˜ëŸ¼ ëª¨ë“  ê²ƒì„ í’ˆì–´ì£¼ëŠ” ë„ˆê·¸ëŸ¬ì›€ì´ ìˆìŠµë‹ˆë‹¤. ì‹ ë¢°ê°ì„ ì£¼ë©° ì£¼ë³€ ì‚¬ëŒë“¤ì˜ ì¤‘ì‹¬ì´ ë©ë‹ˆë‹¤. ë•Œë¡œëŠ” ë³€í™”ì— ë‘”ê°í•˜ê³  ëŠë¦° ë©´ì´ ìˆìŠµë‹ˆë‹¤.',
        career: 'ë¶€ë™ì‚°, ê±´ì¶•, ë†ì—…, ì¤‘ê°œì—…',
        love: 'ì•ˆì •ì ì´ê³  ë¯¿ìŒì§í•œ íŒŒíŠ¸ë„ˆì…ë‹ˆë‹¤',
        health: 'ìœ„(èƒƒ), ë¹„ì¥(è„¾) ì£¼ì˜',
        lucky: 'í™˜ì ˆê¸°(åœŸç”¨), ì¤‘ì•™' },
    5: { name: 'ê¸°í† (å·±åœŸ)', symbol: 'ğŸŒ¾', nature: 'ë°­, ë…¼, ì •ì›',
        personality: 'ì„¬ì„¸í•˜ê³  ì‹¤ë¦¬ì ì¸ ì„±ê²©ì…ë‹ˆë‹¤. ë°­ì²˜ëŸ¼ ë§Œë¬¼ì„ ê¸°ë¥´ëŠ” ì–‘ìœ¡ì˜ í˜ì´ ìˆìœ¼ë©°, ê¼¼ê¼¼í•˜ê³  ì‹¤ìš©ì ì…ë‹ˆë‹¤. ê²¸ì†í•˜ê³  ë´‰ì‚¬ì •ì‹ ì´ ê°•í•˜ë©°, ì‘ì€ ê²ƒë„ ì†Œì¤‘íˆ ì—¬ê¸°ëŠ” ë”°ëœ»í•œ ë§ˆìŒì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤.',
        career: 'êµìœ¡ì, ìš”ë¦¬ì‚¬, ë†ì—…, ì„œë¹„ìŠ¤ì—…',
        love: 'í—Œì‹ ì ì´ë©° ê°€ì •ì ì¸ ì„±í–¥ì´ ê°•í•©ë‹ˆë‹¤',
        health: 'ìœ„(èƒƒ), ì†Œí™”ê¸° ì£¼ì˜',
        lucky: 'í™˜ì ˆê¸°(åœŸç”¨), ì¤‘ì•™' },
    6: { name: 'ê²½ê¸ˆ(åºšé‡‘)', symbol: 'âš”ï¸', nature: 'ì‡ , ì¹¼, ë°”ìœ„',
        personality: 'ê°•ì¸í•˜ê³  ê²°ë‹¨ë ¥ ìˆëŠ” ì„±ê²©ì…ë‹ˆë‹¤. ì‡ ì²˜ëŸ¼ ë‹¨ë‹¨í•˜ê³  ì¹¼ì²˜ëŸ¼ ë‚ ì¹´ë¡œìš´ íŒë‹¨ë ¥ì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤. ì˜ë¦¬ê°€ ìˆê³  ì •ì˜ê°ì´ ê°•í•˜ë©°, ëª©í‘œë¥¼ í–¥í•´ ê³¼ê°í•˜ê²Œ ëŒì§„í•©ë‹ˆë‹¤. ë•Œë¡œëŠ” ì§€ë‚˜ì¹˜ê²Œ ê°•í•´ì„œ ë¶€ë”ªí˜ì´ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.',
        career: 'êµ°ì¸, ê²€ì°°, ì™¸ê³¼ì˜ì‚¬, ì—”ì§€ë‹ˆì–´',
        love: 'ì§ì„ ì ì´ë©° í•œë²ˆ ê²°ì •í•˜ë©´ ë°€ì–´ë¶™ì…ë‹ˆë‹¤',
        health: 'í(è‚º), ëŒ€ì¥(å¤§è…¸) ì£¼ì˜',
        lucky: 'ê°€ì„(ç§‹), ì„œìª½(è¥¿)' },
    7: { name: 'ì‹ ê¸ˆ(è¾›é‡‘)', symbol: 'ğŸ’', nature: 'ë³´ì„, ê¸ˆì€, ë°”ëŠ˜',
        personality: 'ì„¸ë ¨ë˜ê³  ì˜ˆë¯¼í•œ ê°ì„±ì˜ ì†Œìœ ìì…ë‹ˆë‹¤. ë³´ì„ì²˜ëŸ¼ ë¹›ë‚˜ëŠ” ë§¤ë ¥ì´ ìˆìœ¼ë©°, ë¯¸ì  ê°ê°ì´ ë›°ì–´ë‚©ë‹ˆë‹¤. ì™„ë²½ì£¼ì˜ì  ì„±í–¥ì´ ìˆê³ , ë‚ ì¹´ë¡œìš´ í†µì°°ë ¥ìœ¼ë¡œ ë³¸ì§ˆì„ ê¿°ëš«ìŠµë‹ˆë‹¤. ì˜ˆë¯¼í•˜ì—¬ ìƒì²˜ë¥¼ ì˜ ë°›ê¸°ë„ í•©ë‹ˆë‹¤.',
        career: 'ë³´ì„ìƒ, ê¸ˆìœµ, ì˜ˆìˆ ê°€, IT ì „ë¬¸ê°€',
        love: 'ì´ìƒì´ ë†’ê³  ë¡œë§¨í‹±í•œ ì—°ì• ë¥¼ í•©ë‹ˆë‹¤',
        health: 'í(è‚º), ê¸°ê´€ì§€ ì£¼ì˜',
        lucky: 'ê°€ì„(ç§‹), ì„œìª½(è¥¿)' },
    8: { name: 'ì„ìˆ˜(å£¬æ°´)', symbol: 'ğŸŒŠ', nature: 'ë°”ë‹¤, ê°•, í° ë¬¼',
        personality: 'ì§€í˜œë¡­ê³  í¬ìš©ë ¥ì´ í° ì„±ê²©ì…ë‹ˆë‹¤. ë°”ë‹¤ì²˜ëŸ¼ ë„“ê³  ê¹Šì€ ë§ˆìŒì„ ê°€ì§€ê³  ìˆìœ¼ë©°, ì–´ë–¤ ê²ƒì´ë“  ìˆ˜ìš©í•˜ëŠ” ê´€ëŒ€í•¨ì´ ìˆìŠµë‹ˆë‹¤. í™œë™ì ì´ë©° ë³€í™”ë¥¼ ë‘ë ¤ì›Œí•˜ì§€ ì•Šê³ , ê°•í•œ ì¶”ì§„ë ¥ìœ¼ë¡œ ëª©í‘œë¥¼ ë‹¬ì„±í•©ë‹ˆë‹¤.',
        career: 'ë¬´ì—­, ìœ í†µ, ì—¬í–‰ì—…, ì² í•™ì',
        love: 'ììœ ë¡œìš°ë©´ì„œë„ ê¹Šì€ ì‚¬ë‘ì„ í•©ë‹ˆë‹¤',
        health: 'ì‹ ì¥(è…), ë°©ê´‘(è†€èƒ±) ì£¼ì˜',
        lucky: 'ê²¨ìš¸(å†¬), ë¶ìª½(åŒ—)' },
    9: { name: 'ê³„ìˆ˜(ç™¸æ°´)', symbol: 'ğŸ’§', nature: 'ì´ìŠ¬, ë¹„, ì‹œëƒ‡ë¬¼',
        personality: 'ì§€ì ì´ê³  ì„¬ì„¸í•œ ì„±ê²©ì…ë‹ˆë‹¤. ì´ìŠ¬ì²˜ëŸ¼ ë§‘ê³  ìˆœìˆ˜í•œ ë§ˆìŒì„ ê°€ì§€ê³  ìˆìœ¼ë©°, ì§ê´€ë ¥ê³¼ ì˜ê°ì´ ë›°ì–´ë‚©ë‹ˆë‹¤. ì¡°ìš©í•˜ì§€ë§Œ ê¹Šì€ ì‚¬ê³ ë ¥ì„ ê°€ì§€ê³  ìˆê³ , í•™ë¬¸ê³¼ ì˜ˆìˆ ì— ì¬ëŠ¥ì´ ìˆìŠµë‹ˆë‹¤. ê°ì„±ì´ í’ë¶€í•˜ê³  ë°°ë ¤ì‹¬ì´ ê¹ŠìŠµë‹ˆë‹¤.',
        career: 'í•™ì, ì—°êµ¬ì›, ì˜ˆìˆ ê°€, ì‹¬ë¦¬ìƒë‹´',
        love: 'ì„¬ì„¸í•˜ë©° ëˆˆì— ë³´ì´ì§€ ì•ŠëŠ” ë°°ë ¤ë¥¼ í•©ë‹ˆë‹¤',
        health: 'ì‹ ì¥(è…), ë¹„ë‡¨ê¸° ì£¼ì˜',
        lucky: 'ê²¨ìš¸(å†¬), ë¶ìª½(åŒ—)' }
};

// ===== UI í•¨ìˆ˜ =====
function selectGender(btn) {
    document.querySelectorAll('.gender-btn').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
}

// í¼ ì´ˆê¸°í™”
(function initForm() {
    const yearSel = document.getElementById('year');
    const monthSel = document.getElementById('month');
    const daySel = document.getElementById('day');
    const currentYear = new Date().getFullYear();

    for (let y = currentYear; y >= 1920; y--) {
        yearSel.add(new Option(y + 'ë…„', y));
    }
    yearSel.value = 1990;

    for (let m = 1; m <= 12; m++) {
        monthSel.add(new Option(m + 'ì›”', m));
    }

    for (let d = 1; d <= 31; d++) {
        daySel.add(new Option(d + 'ì¼', d));
    }
})();

// ===== ë¶„ì„ ì‹¤í–‰ =====
function analyze() {
    const year = parseInt(document.getElementById('year').value);
    const month = parseInt(document.getElementById('month').value);
    const day = parseInt(document.getElementById('day').value);
    const hourIdx = parseInt(document.getElementById('hour').value);
    const gender = document.querySelector('.gender-btn.active').dataset.gender;

    // ì—°ì£¼
    const yearP = getYearPillar(year, month, day);
    // ì›”ì£¼
    const monthP = getMonthPillar(yearP.gan, month, day);
    // ì¼ì£¼
    const dayP = getDayPillar(year, month, day);
    // ì‹œì£¼
    let hourP = null;
    if (hourIdx >= 0) {
        const hourGan = getHourGan(dayP.gan, hourIdx);
        hourP = { gan: hourGan, ji: hourIdx };
    }

    // ì˜¤í–‰ ê³„ì‚°
    const elements = [0, 0, 0, 0, 0]; // ëª©,í™”,í† ,ê¸ˆ,ìˆ˜
    elements[CHEONGAN_ELEMENT[yearP.gan]]++;
    elements[JIJI_ELEMENT[yearP.ji]]++;
    elements[CHEONGAN_ELEMENT[monthP.gan]]++;
    elements[JIJI_ELEMENT[monthP.ji]]++;
    elements[CHEONGAN_ELEMENT[dayP.gan]]++;
    elements[JIJI_ELEMENT[dayP.ji]]++;
    if (hourP) {
        elements[CHEONGAN_ELEMENT[hourP.gan]]++;
        elements[JIJI_ELEMENT[hourP.ji]]++;
    }

    const totalElements = elements.reduce((a, b) => a + b, 0);

    // ê²°ê³¼ í‘œì‹œ
    renderIlgan(dayP.gan);
    renderPillars(yearP, monthP, dayP, hourP);
    renderOhaeng(elements, totalElements);
    renderPersonality(dayP.gan, elements);
    renderDetail(dayP.gan, yearP, monthP, dayP, hourP, elements, gender);
    render2026Fortune(dayP.gan, dayP.ji, elements, gender);

    // ìƒˆ ë¶„ì„ ì„¹ì…˜ë“¤
    const userName = document.getElementById('userName').value.trim();
    renderNameAnalysis(userName, dayP.gan, elements);
    renderNumerology(year, month, day, dayP.gan, elements);
    renderAstrology(month, day, year, gender, dayP.gan, elements);
    renderZiWei(yearP, monthP, dayP, hourP, gender, elements, year);
    renderShamanFortune(dayP.gan, dayP.ji, yearP, monthP, hourP, elements, gender, year, month, day);

    renderLifetimeFortune(dayP.gan, dayP.ji, yearP.gan, monthP.gan, monthP.ji, elements, gender, year);

    document.getElementById('result').style.display = 'block';
    document.getElementById('result').scrollIntoView({ behavior: 'smooth', block: 'start' });
}

function renderIlgan(ganIdx) {
    const data = ILGAN_DATA[ganIdx];
    const elIdx = CHEONGAN_ELEMENT[ganIdx];
    document.getElementById('ilganBox').innerHTML = `
        <div class="ilgan-char" style="color:${ELEMENT_COLORS[elIdx]}">${data.symbol} ${CHEONGAN_HANJA[ganIdx]}</div>
        <div class="ilgan-info">
            <h3 style="color:${ELEMENT_COLORS[elIdx]}">${data.name}</h3>
            <p>${data.nature}</p>
            <p style="margin-top:4px;font-size:12px;color:var(--text-muted)">${CHEONGAN_YINYANG[ganIdx]}(${ganIdx % 2 === 0 ? 'é™½' : 'é™°'}) Â· ${ELEMENT_NAMES[elIdx]}</p>
        </div>
    `;
}

function renderPillars(yearP, monthP, dayP, hourP) {
    const pillars = [
        { label: 'ì‹œì£¼', hanja: 'æ™‚æŸ±', p: hourP },
        { label: 'ì¼ì£¼', hanja: 'æ—¥æŸ±', p: dayP },
        { label: 'ì›”ì£¼', hanja: 'æœˆæŸ±', p: monthP },
        { label: 'ì—°ì£¼', hanja: 'å¹´æŸ±', p: yearP },
    ];

    let html = '';
    pillars.forEach(({ label, hanja, p }) => {
        if (!p) {
            html += `<div class="pillar" style="opacity:0.4">
                <div class="pillar-label">${label}</div>
                <div class="pillar-hanja">${hanja}</div>
                <div class="pillar-char serif" style="color:var(--text-muted)">?</div>
                <div class="divider"></div>
                <div class="pillar-char serif" style="color:var(--text-muted)">?</div>
                <div class="pillar-name">ì‹œê°„ ë¯¸ì…ë ¥</div>
            </div>`;
            return;
        }
        const ganEl = CHEONGAN_ELEMENT[p.gan];
        const jiEl = JIJI_ELEMENT[p.ji];
        html += `<div class="pillar">
            <div class="pillar-label">${label}</div>
            <div class="pillar-hanja">${hanja}</div>
            <div class="pillar-char serif" style="color:${ELEMENT_COLORS[ganEl]}">${CHEONGAN_HANJA[p.gan]}</div>
            <div class="pillar-name">${CHEONGAN[p.gan]} Â· ${ELEMENT_SHORT[ganEl]}</div>
            <span class="pillar-element ${ELEMENT_CLASSES[ganEl]}">${ELEMENT_NAMES[ganEl]}</span>
            <div class="divider"></div>
            <div class="pillar-char serif" style="color:${ELEMENT_COLORS[jiEl]}">${JIJI_HANJA[p.ji]}</div>
            <div class="pillar-name">${JIJI[p.ji]} Â· ${ELEMENT_SHORT[jiEl]}</div>
            <span class="pillar-element ${ELEMENT_CLASSES[jiEl]}">${ELEMENT_NAMES[jiEl]}</span>
        </div>`;
    });

    document.getElementById('pillarsGrid').innerHTML = html;
}

function renderOhaeng(elements, total) {
    const maxEl = Math.max(...elements);
    let html = '';
    const names = ['ğŸŒ³ ëª©(æœ¨)', 'ğŸ”¥ í™”(ç«)', 'ğŸ”ï¸ í† (åœŸ)', 'âš”ï¸ ê¸ˆ(é‡‘)', 'ğŸ’§ ìˆ˜(æ°´)'];
    elements.forEach((count, i) => {
        const pct = total > 0 ? Math.round(count / total * 100) : 0;
        const width = maxEl > 0 ? Math.max(count / maxEl * 100, 5) : 5;
        html += `<div class="ohaeng-row">
            <div class="ohaeng-label" style="color:${ELEMENT_COLORS[i]}">${names[i]}</div>
            <div class="ohaeng-bar-bg">
                <div class="ohaeng-bar ${BAR_CLASSES[i]}" style="width:${width}%">${pct}%</div>
            </div>
            <div class="ohaeng-count" style="color:${ELEMENT_COLORS[i]}">${count}</div>
        </div>`;
    });
    document.getElementById('ohaengBars').innerHTML = html;
}

function renderPersonality(ganIdx, elements) {
    const data = ILGAN_DATA[ganIdx];
    const maxEl = elements.indexOf(Math.max(...elements));
    const minEl = elements.indexOf(Math.min(...elements));

    let extra = '';
    if (elements[maxEl] >= 3) {
        extra += `<br><br>ì˜¤í–‰ì—ì„œ <strong style="color:${ELEMENT_COLORS[maxEl]}">${ELEMENT_NAMES[maxEl]}</strong>ì´ ê°•í•˜ê²Œ ë‚˜íƒ€ë‚©ë‹ˆë‹¤. `;
        const strongTraits = ['ì„±ì¥ê³¼ ë°œì „ì— ëŒ€í•œ ìš•êµ¬ê°€ í¬ê³  ì¸ìí•œ ì„±í’ˆ', 'ì—´ì •ê³¼ ì˜ˆì˜ê°€ ë„˜ì¹˜ë©° í‘œí˜„ë ¥ì´ ë›°ì–´ë‚¨', 'ì•ˆì •ì„ ì¶”êµ¬í•˜ê³  ì‹ ë¢°ê°ì´ ê°•í•¨', 'ê²°ë‹¨ë ¥ê³¼ ì •ì˜ê°ì´ ë›°ì–´ë‚¨', 'ì§€í˜œë¡­ê³  ìœ ì—°í•œ ì‚¬ê³ ë¥¼ í•©ë‹ˆë‹¤'];
        extra += strongTraits[maxEl] + '.';
    }
    if (elements[minEl] === 0) {
        extra += `<br><br>âš ï¸ <strong style="color:${ELEMENT_COLORS[minEl]}">${ELEMENT_NAMES[minEl]}</strong>ì´ ë¶€ì¡±í•©ë‹ˆë‹¤. `;
        const weakAdvice = ['ì¸ë‚´ì‹¬ì„ ê¸°ë¥´ê³  ìì—°ê³¼ ê°€ê¹Œì´í•˜ë©´ ì¢‹ìŠµë‹ˆë‹¤', 'ì—´ì •ê³¼ í™œë ¥ì„ ë³´ì¶©í•˜ì„¸ìš”. ìš´ë™ì´ ë„ì›€ë©ë‹ˆë‹¤', 'ì•ˆì •ê°ì„ ì°¾ëŠ” ë…¸ë ¥ì´ í•„ìš”í•©ë‹ˆë‹¤', 'ê²°ë‹¨ë ¥ì„ ê¸°ë¥´ê³  ìê¸°ì£¼ì¥ì„ ë¶„ëª…íˆ í•˜ì„¸ìš”', 'ìœ ì—°í•œ ì‚¬ê³ ì™€ ì§€í˜œë¥¼ ê¸°ë¥´ì„¸ìš”'];
        extra += weakAdvice[minEl] + '.';
    }

    document.getElementById('personalityText').innerHTML = data.personality + extra;
}

function renderDetail(ganIdx, yearP, monthP, dayP, hourP, elements, gender) {
    const data = ILGAN_DATA[ganIdx];
    const yinyang = CHEONGAN_YINYANG[ganIdx] === 'ì–‘' ? 'é™½' : 'é™°';

    // ìš©ì‹  (ê°„ì†Œí™”: ê°€ì¥ ì•½í•œ ì˜¤í–‰)
    const minEl = elements.indexOf(Math.min(...elements));

    // 12ìš´ì„± (ì¼ì§€ ê¸°ì¤€ ê°„ì†Œí™”)
    const unsung12 = ['ì ˆ','íƒœ','ì–‘','ì¥ìƒ','ëª©ìš•','ê´€ëŒ€','ê±´ë¡','ì œì™•','ì‡ ','ë³‘','ì‚¬','ë¬˜'];
    const unsungIdx = (dayP.ji - dayP.gan * 12 / 10 + 120) % 12;
    const unsungName = unsung12[Math.floor(unsungIdx) % 12];

    let html = `
        <div class="analysis-item">
            <div class="analysis-item-title">ğŸ’¼ ì í•©í•œ ì§ì—…</div>
            <div class="analysis-item-text">${data.career}</div>
        </div>
        <div class="analysis-item">
            <div class="analysis-item-title">â¤ï¸ ì—°ì•  ì„±í–¥</div>
            <div class="analysis-item-text">${data.love}</div>
        </div>
        <div class="analysis-item">
            <div class="analysis-item-title">ğŸ¥ ê±´ê°• ì£¼ì˜</div>
            <div class="analysis-item-text">${data.health}</div>
        </div>
        <div class="analysis-item">
            <div class="analysis-item-title">ğŸ€ ê¸¸ìš´ ë°©í–¥</div>
            <div class="analysis-item-text">${data.lucky}</div>
        </div>
        <div class="analysis-item">
            <div class="analysis-item-title">âš–ï¸ ìŒì–‘</div>
            <div class="analysis-item-text">${CHEONGAN_YINYANG[ganIdx]}(${yinyang}) â€” ${ganIdx % 2 === 0 ? 'ì ê·¹ì ì´ê³  ì™¸í–¥ì ì¸ ê¸°ìš´' : 'ë‚´ë©´ì ì´ê³  ìˆ˜ìš©ì ì¸ ê¸°ìš´'}</div>
        </div>
        <div class="analysis-item">
            <div class="analysis-item-title">ğŸ¯ ìš©ì‹  (ç”¨ç¥)</div>
            <div class="analysis-item-text" style="color:${ELEMENT_COLORS[minEl]}">
                ${ELEMENT_NAMES[minEl]} â€” ë¶€ì¡±í•œ ì˜¤í–‰ì„ ë³´ì¶©í•˜ë©´ ìš´ì´ ì¢‹ì•„ì§‘ë‹ˆë‹¤
            </div>
        </div>
    `;

    document.getElementById('detailGrid').innerHTML = html;
}

// ===== 2026ë…„ ë³‘ì˜¤(ä¸™åˆ)ë…„ ìš´ì„¸ ë¶„ì„ =====
// 2026ë…„: ì²œê°„ ä¸™(ë³‘í™”/ì–‘í™”), ì§€ì§€ åˆ(ì˜¤í™”/ì–‘í™”) â†’ ë¶ˆì˜ í•´
// ì‹­ì„±(åæ˜Ÿ) ê´€ê³„: ì¼ê°„ê³¼ ì„¸ìš´ ì²œê°„ì˜ ê´€ê³„

function getTenStar(dayGan, targetGan) {
    const dayEl = CHEONGAN_ELEMENT[dayGan];
    const targetEl = CHEONGAN_ELEMENT[targetGan];
    const daySame = dayGan % 2; // 0=ì–‘, 1=ìŒ
    const targetSame = targetGan % 2;
    const samePolarity = daySame === targetSame;

    // ì˜¤í–‰ ìƒìƒìƒê·¹ ê´€ê³„
    // ìƒ(ç”Ÿ): ëª©â†’í™”â†’í† â†’ê¸ˆâ†’ìˆ˜â†’ëª©
    // ê·¹(å…‹): ëª©â†’í† â†’ìˆ˜â†’í™”â†’ê¸ˆâ†’ëª©

    if (dayEl === targetEl) {
        return samePolarity ? { name: 'ë¹„ê²¬(æ¯”è‚©)', desc: 'ê²½ìŸê³¼ ìë¦½ì˜ í•´', type: 'peer' }
                           : { name: 'ê²ì¬(åŠ«è²¡)', desc: 'í˜‘ë ¥ê³¼ ê²½ìŸì˜ í•´', type: 'peer' };
    }

    // ë‚´ê°€ ìƒí•˜ëŠ” ê²ƒ = ì‹ìƒ
    if ((dayEl + 1) % 5 === targetEl) {
        return samePolarity ? { name: 'ì‹ì‹ (é£Ÿç¥)', desc: 'ì°½ì‘ê³¼ í‘œí˜„ì˜ í•´', type: 'output' }
                           : { name: 'ìƒê´€(å‚·å®˜)', desc: 'ë³€í™”ì™€ ë„ì „ì˜ í•´', type: 'output' };
    }

    // ë‚´ê°€ ê·¹í•˜ëŠ” ê²ƒ = ì¬ì„±
    if ((dayEl + 2) % 5 === targetEl) {
        return samePolarity ? { name: 'í¸ì¬(åè²¡)', desc: 'íˆ¬ìì™€ ê¸°íšŒì˜ í•´', type: 'wealth' }
                           : { name: 'ì •ì¬(æ­£è²¡)', desc: 'ì•ˆì •ì  ì¬ë¬¼ì˜ í•´', type: 'wealth' };
    }

    // ë‚˜ë¥¼ ê·¹í•˜ëŠ” ê²ƒ = ê´€ì„±
    if ((dayEl + 3) % 5 === targetEl) {
        return samePolarity ? { name: 'í¸ê´€(åå®˜)', desc: 'ë„ì „ê³¼ ì„±ì·¨ì˜ í•´', type: 'power' }
                           : { name: 'ì •ê´€(æ­£å®˜)', desc: 'ëª…ì˜ˆì™€ ìŠ¹ì§„ì˜ í•´', type: 'power' };
    }

    // ë‚˜ë¥¼ ìƒí•˜ëŠ” ê²ƒ = ì¸ì„±
    if ((dayEl + 4) % 5 === targetEl) {
        return samePolarity ? { name: 'í¸ì¸(åå°)', desc: 'í•™ë¬¸ê³¼ ê¹¨ë‹¬ìŒì˜ í•´', type: 'resource' }
                           : { name: 'ì •ì¸(æ­£å°)', desc: 'ì§€í˜œì™€ ì•ˆì •ì˜ í•´', type: 'resource' };
    }

    return { name: 'ë¹„ê²¬', desc: 'ìë¦½ì˜ í•´', type: 'peer' };
}

function render2026Fortune(dayGan, dayJi, elements, gender) {
    // 2026 ë³‘ì˜¤ë…„: ì²œê°„ ä¸™(2), ì§€ì§€ åˆ(6)
    const yearGan2026 = 2; // ë³‘(ä¸™)
    const yearJi2026 = 6;  // ì˜¤(åˆ)

    const tenStar = getTenStar(dayGan, yearGan2026);
    const dayElIdx = CHEONGAN_ELEMENT[dayGan];

    // ì¼ê°„ê³¼ ì„¸ìš´ì˜ ì˜¤í–‰ ê´€ê³„ë¡œ ì¢…í•© ì ìˆ˜ ê³„ì‚°
    const yearEl = 1; // ë³‘ì˜¤ = í™”(ç«)

    // ìƒìƒ/ìƒê·¹ ê¸°ë°˜ ì ìˆ˜
    let baseScore = 65;
    // ë‚´ê°€ ìƒí•˜ëŠ” ê²ƒ (ì‹ìƒ) â†’ ì—ë„ˆì§€ ì†Œëª¨, í‘œí˜„ë ¥ ì¦ê°€
    if ((dayElIdx + 1) % 5 === yearEl) baseScore = 72;
    // ë‚´ê°€ ê·¹í•˜ëŠ” ê²ƒ (ì¬ì„±) â†’ ì¬ë¬¼ ê¸°íšŒ
    if ((dayElIdx + 2) % 5 === yearEl) baseScore = 78;
    // ë‚˜ë¥¼ ê·¹í•˜ëŠ” ê²ƒ (ê´€ì„±) â†’ ì••ë°•, ì„±ì¥
    if ((dayElIdx + 3) % 5 === yearEl) baseScore = 60;
    // ë‚˜ë¥¼ ìƒí•˜ëŠ” ê²ƒ (ì¸ì„±) â†’ ë„ì›€, ì•ˆì •
    if ((dayElIdx + 4) % 5 === yearEl) baseScore = 80;
    // ê°™ì€ ì˜¤í–‰ (ë¹„ê²) â†’ ê²½ìŸ, ìë¦½
    if (dayElIdx === yearEl) baseScore = 68;

    // ì¼ì§€ì™€ ì„¸ìš´ì§€ì§€ ê´€ê³„ ë³´ì •
    // ì˜¤(åˆ)ì™€ ì¼ì§€ ê´€ê³„
    const jiRelation = getJijiRelation(dayJi, yearJi2026);
    baseScore += jiRelation.scoreAdj;

    // ì‚¬ì£¼ ì˜¤í–‰ ê· í˜• ë³´ì •
    const minEl = Math.min(...elements);
    const maxEl = Math.max(...elements);
    if (elements[yearEl] === 0) baseScore += 5; // ë¶€ì¡±í•œ í™”ë¥¼ ë³´ì¶©
    if (elements[yearEl] >= 3) baseScore -= 5; // ì´ë¯¸ í™”ê°€ ê³¼ë‹¤

    baseScore = Math.max(40, Math.min(95, baseScore));

    // ì„¸ë¶€ ì ìˆ˜
    const scores = calcDetailScores(dayGan, dayJi, elements, tenStar.type, baseScore);

    // ì›”ë³„ ìš´ì„¸
    const monthlyFortune = calcMonthlyFortune(dayGan, dayJi, elements);

    // ë Œë”ë§
    // Header
    document.getElementById('fortuneYearHeader').innerHTML = `
        <div class="fortune-year-char">ğŸ´ ä¸™åˆ</div>
        <div class="fortune-year-info">
            <h3>2026ë…„ ë³‘ì˜¤(ä¸™åˆ)ë…„ â€” ${tenStar.name}</h3>
            <p>${tenStar.desc} Â· ë¶‰ì€ ë§ì˜ í•´ Â· í™”(ç«)ê¸°ìš´ì´ ê°•í•œ í•´</p>
            <p style="margin-top:4px;font-size:12px;color:var(--text-muted)">ì„¸ìš´ ì²œê°„: ä¸™(ë³‘í™”) Â· ì„¸ìš´ ì§€ì§€: åˆ(ì˜¤í™”) Â· ${jiRelation.text}</p>
        </div>
    `;

    // Score
    const scoreColor = baseScore >= 75 ? 'var(--gold)' : baseScore >= 60 ? 'var(--wood)' : baseScore >= 45 ? 'var(--text-secondary)' : 'var(--fire)';
    const scoreGrade = baseScore >= 80 ? 'ëŒ€ê¸¸(å¤§å‰)' : baseScore >= 70 ? 'ê¸¸(å‰)' : baseScore >= 55 ? 'í‰(å¹³)' : baseScore >= 45 ? 'ì†Œí‰(å°å‡¶)' : 'ì£¼ì˜(æ³¨æ„)';

    document.getElementById('fortuneScore').innerHTML = `
        <div class="score-circle" style="border-color:${scoreColor};color:${scoreColor}">
            <div class="score-num">${baseScore}</div>
            <div class="score-label">${scoreGrade}</div>
        </div>
        <div class="score-detail">
            ${renderScoreRow('ğŸ’° ì¬ë¬¼ìš´', scores.wealth, scores.wealth >= 70 ? 'bar-excellent' : scores.wealth >= 55 ? 'bar-good' : 'bar-normal')}
            ${renderScoreRow('ğŸ’¼ ì§ì¥ìš´', scores.career, scores.career >= 70 ? 'bar-excellent' : scores.career >= 55 ? 'bar-good' : 'bar-normal')}
            ${renderScoreRow('â¤ï¸ ì• ì •ìš´', scores.love, scores.love >= 70 ? 'bar-excellent' : scores.love >= 55 ? 'bar-good' : 'bar-normal')}
            ${renderScoreRow('ğŸ¥ ê±´ê°•ìš´', scores.health, scores.health >= 70 ? 'bar-good' : scores.health >= 55 ? 'bar-normal' : 'bar-caution')}
            ${renderScoreRow('ğŸ“ í•™ì—…ìš´', scores.study, scores.study >= 70 ? 'bar-excellent' : scores.study >= 55 ? 'bar-good' : 'bar-normal')}
            ${renderScoreRow('ğŸ¤ ëŒ€ì¸ìš´', scores.social, scores.social >= 70 ? 'bar-excellent' : scores.social >= 55 ? 'bar-good' : 'bar-normal')}
        </div>
    `;

    // Monthly
    const monthIcons = ['â„ï¸','ğŸŒ¸','ğŸŒ¸','ğŸŒ¿','ğŸŒ¿','â˜€ï¸','â˜€ï¸','ğŸ‚','ğŸ‚','ğŸ‚','â„ï¸','â„ï¸'];
    let monthHtml = '<div class="section-title serif" style="font-size:16px;">ğŸ“… 2026ë…„ ì›”ë³„ ìš´ì„¸</div><div class="monthly-grid">';
    monthlyFortune.forEach((m, i) => {
        const luckClass = m.score >= 80 ? 'luck-excellent' : m.score >= 65 ? 'luck-good' : m.score >= 50 ? 'luck-normal' : m.score >= 40 ? 'luck-caution' : 'luck-difficult';
        const luckText = m.score >= 80 ? 'ëŒ€ê¸¸' : m.score >= 65 ? 'ê¸¸' : m.score >= 50 ? 'í‰' : m.score >= 40 ? 'ì†Œí‰' : 'ì£¼ì˜';
        monthHtml += `<div class="month-card">
            <div class="month-num">${i + 1}ì›”</div>
            <div class="month-icon">${monthIcons[i]}</div>
            <div class="month-luck ${luckClass}">${luckText} ${m.score}ì </div>
            <div class="month-desc">${m.desc}</div>
        </div>`;
    });
    monthHtml += '</div>';
    document.getElementById('fortuneMonthly').innerHTML = monthHtml;

    // Advice
    const advice = getFortuneAdvice(dayGan, tenStar.type, elements, baseScore, scores);
    document.getElementById('fortuneAdvice').innerHTML = `
        <div class="fortune-advice-title">ğŸ”® 2026ë…„ ì¢…í•© ì¡°ì–¸</div>
        <div class="fortune-advice-text">${advice}</div>
    `;
}

function renderScoreRow(label, score, barClass) {
    return `<div class="score-row">
        <div class="score-row-label">${label}</div>
        <div class="score-bar-bg"><div class="score-bar ${barClass}" style="width:${score}%"></div></div>
        <div class="score-row-val">${score}</div>
    </div>`;
}

function getJijiRelation(dayJi, yearJi) {
    // ê°„ì†Œí™”ëœ ì§€ì§€ ê´€ê³„ (í•©, ì¶©, í˜•, í•´)
    // åˆ ì¶©: å­(0)
    if (dayJi === 0 && yearJi === 6) return { text: 'ì¼ì§€ å­ì™€ ì„¸ìš´ åˆ â€” ìì˜¤ì¶©(å­åˆæ²–)', scoreAdj: -8 };
    if (dayJi === 6) return { text: 'ì¼ì§€ åˆì™€ ì„¸ìš´ åˆ â€” ìí˜•(è‡ªåˆ‘)', scoreAdj: -3 };
    // åˆ í•©: æœª(7) ìœ¡í•©
    if (dayJi === 7) return { text: 'ì¼ì§€ æœªì™€ ì„¸ìš´ åˆ â€” ì˜¤ë¯¸í•©(åˆæœªåˆ) ê¸¸', scoreAdj: 8 };
    // åˆ ì‚¼í•©: å¯…(2), æˆŒ(10) â€” í™”êµ­
    if (dayJi === 2) return { text: 'ì¼ì§€ å¯…ê³¼ ì„¸ìš´ åˆ â€” ì¸ì˜¤ìˆ  ì‚¼í•©(í™”êµ­)', scoreAdj: 10 };
    if (dayJi === 10) return { text: 'ì¼ì§€ æˆŒê³¼ ì„¸ìš´ åˆ â€” ì¸ì˜¤ìˆ  ì‚¼í•©(í™”êµ­)', scoreAdj: 10 };
    // åˆ í˜•: åˆ(6) ìí˜•
    // åˆ í•´: ä¸‘(1)
    if (dayJi === 1) return { text: 'ì¼ì§€ ä¸‘ê³¼ ì„¸ìš´ åˆ â€” ì¶•ì˜¤í•´(ä¸‘åˆå®³)', scoreAdj: -5 };
    // ë‚˜ë¨¸ì§€
    return { text: 'ì¼ì§€ì™€ ì„¸ìš´ì§€ì§€ â€” íŠ¹ë³„í•œ ì¶©í•© ì—†ìŒ', scoreAdj: 0 };
}

function calcDetailScores(dayGan, dayJi, elements, tenStarType, base) {
    let wealth = base, career = base, love = base, health = base, study = base, social = base;

    // ì‹­ì„± ìœ í˜•ì— ë”°ë¥¸ ë³´ì •
    switch(tenStarType) {
        case 'wealth':
            wealth += 12; career += 5; love += 3; health -= 3; study -= 2; social += 5;
            break;
        case 'power':
            career += 12; wealth += 3; love -= 2; health -= 5; study += 5; social += 3;
            break;
        case 'resource':
            study += 12; health += 5; career += 5; love += 3; wealth += 2; social += 5;
            break;
        case 'output':
            love += 8; study += 5; social += 8; career += 3; wealth -= 3; health -= 3;
            break;
        case 'peer':
            social += 5; career -= 2; wealth -= 3; love += 3; health += 3; study += 2;
            break;
    }

    // í™”(ç«) ê³¼ë‹¤ì‹œ ê±´ê°• ì£¼ì˜ (ì‹¬ì¥, í˜ˆì••)
    if (elements[1] >= 2) health -= 5;
    // í™” ë¶€ì¡±ì‹œ í™œë ¥ ë¶€ì¡±
    if (elements[1] === 0) { career += 5; health += 3; }
    // ìˆ˜(æ°´) ìˆìœ¼ë©´ í™”ë¥¼ ì œì–´ â†’ ê±´ê°• ë³´ì •
    if (elements[4] >= 1) health += 3;

    // ì¼ê°„ë³„ ë¯¸ì„¸ ë³´ì • (í™”ì˜ í•´ì— ê° ì¼ê°„ì˜ ë°˜ì‘)
    const dayEl = CHEONGAN_ELEMENT[dayGan];
    if (dayEl === 0) { career += 3; wealth += 2; } // ëª© â†’ í™”ë¥¼ ìƒí•¨ (ì„¤ê¸°, ì—ë„ˆì§€ ì†Œëª¨)
    if (dayEl === 1) { social += 5; love += 5; }   // í™” â†’ ë¹„ê², ê²½ìŸê³¼ ì—´ì •
    if (dayEl === 2) { wealth += 5; career += 3; }  // í†  â†’ í™”ê°€ ìƒí•´ì¤Œ (ì¸ì„±)
    if (dayEl === 3) { health -= 3; career += 5; }  // ê¸ˆ â†’ í™”ê°€ ê·¹í•¨ (ê´€ì„±, ì••ë°•)
    if (dayEl === 4) { study += 5; wealth += 3; }   // ìˆ˜ â†’ í™”ë¥¼ ê·¹í•¨ (ì¬ì„±, ê¸°íšŒ)

    return {
        wealth: Math.max(30, Math.min(95, Math.round(wealth))),
        career: Math.max(30, Math.min(95, Math.round(career))),
        love: Math.max(30, Math.min(95, Math.round(love))),
        health: Math.max(30, Math.min(95, Math.round(health))),
        study: Math.max(30, Math.min(95, Math.round(study))),
        social: Math.max(30, Math.min(95, Math.round(social)))
    };
}

function calcMonthlyFortune(dayGan, dayJi, elements) {
    // 2026ë…„ ì›”ë³„ ì²œê°„ì§€ì§€
    // 1ì›”(ê²½ì¸), 2ì›”(ì‹ ë¬˜), 3ì›”(ì„ì§„), 4ì›”(ê³„ì‚¬), 5ì›”(ê°‘ì˜¤), 6ì›”(ì„ë¯¸)
    // 7ì›”(ë³‘ì‹ ), 8ì›”(ì •ìœ ), 9ì›”(ë¬´ìˆ ), 10ì›”(ê¸°í•´), 11ì›”(ê²½ì), 12ì›”(ì‹ ì¶•)
    const monthGans = [6,7,8,9,0,1,2,3,4,5,6,7]; // ê²½,ì‹ ,ì„,ê³„,ê°‘,ì„,ë³‘,ì •,ë¬´,ê¸°,ê²½,ì‹ 
    const monthJis = [2,3,4,5,6,7,8,9,10,11,0,1]; // ì¸,ë¬˜,ì§„,ì‚¬,ì˜¤,ë¯¸,ì‹ ,ìœ ,ìˆ ,í•´,ì,ì¶•

    const dayEl = CHEONGAN_ELEMENT[dayGan];
    const descs = [];

    const shortDescs = {
        wealth: ['ì¬ë¬¼ ê¸°íšŒ', 'íˆ¬ì ìœ ë¦¬', 'ìˆ˜ì… ì¦ê°€', 'ì¬ë¬¼ ê¸¸'],
        career: ['ìŠ¹ì§„ ê¸°íšŒ', 'ì§ì¥ ë°œì „', 'ì‚¬ì—… í˜¸ì¡°', 'ì—…ë¬´ ìˆœíƒ„'],
        love: ['ì¸ì—° ì¢‹ìŒ', 'ë§Œë‚¨ ê¸¸', 'ì• ì • ê¹Šì–´ì§', 'ê°ì • í’ë¶€'],
        health: ['ê±´ê°• ì–‘í˜¸', 'í™œë ¥ ì¶©ë§Œ', 'ì²´ë ¥ ì¢‹ìŒ', 'ê¸°ìš´ ì¢‹ìŒ'],
        study: ['í•™ì—… ê¸¸', 'ì‹œí—˜ ìœ ë¦¬', 'ì§‘ì¤‘ë ¥ ìƒìŠ¹', 'ê¹¨ë‹¬ìŒ'],
        social: ['ê·€ì¸ ë§Œë‚¨', 'ì¸ë§¥ í™•ì¥', 'ëŒ€ì¸ ì¢‹ìŒ', 'í˜‘ë ¥ ì¢‹ìŒ'],
        caution: ['ì§€ì¶œ ì£¼ì˜', 'ê±´ê°• ì¡°ì‹¬', 'ê°ˆë“± ì£¼ì˜', 'ê³¼ë¡œ ì£¼ì˜', 'ê°ì • ì¡°ì ˆ', 'ì‹ ì¤‘íˆ']
    };

    for (let m = 0; m < 12; m++) {
        const mGan = monthGans[m];
        const mJi = monthJis[m];
        const mEl = CHEONGAN_ELEMENT[mGan];
        const mJiEl = JIJI_ELEMENT[mJi];

        let score = 65;
        let desc = '';

        // ì›”ê°„ê³¼ ì¼ê°„ ê´€ê³„
        const mTenStar = getTenStar(dayGan, mGan);

        switch(mTenStar.type) {
            case 'wealth': score += 8; desc = shortDescs.wealth[m % 4]; break;
            case 'power': score += 2; desc = shortDescs.career[m % 4]; break;
            case 'resource': score += 10; desc = shortDescs.study[m % 4]; break;
            case 'output': score += 5; desc = shortDescs.love[m % 4]; break;
            case 'peer': score += 0; desc = shortDescs.social[m % 4]; break;
        }

        // ì›”ì§€ì™€ ì¼ì§€ ì¶©í•©
        if ((mJi + 6) % 12 === dayJi) { score -= 10; desc = shortDescs.caution[m % 6]; }
        // ì‚¼í•©
        if ((mJi + dayJi) % 4 === 0 && mJi !== dayJi) score += 3;
        // ìœ¡í•©
        const yukHap = [[0,1],[2,11],[3,10],[4,9],[5,8],[6,7]];
        yukHap.forEach(([a,b]) => { if ((dayJi===a && mJi===b)||(dayJi===b && mJi===a)) score += 5; });

        // ê³„ì ˆ ë³´ì • (ë´„ ëª©, ì—¬ë¦„ í™”, ê°€ì„ ê¸ˆ, ê²¨ìš¸ ìˆ˜)
        if (m >= 0 && m <= 2 && dayEl === 0) score += 3; // ë´„ì— ëª©
        if (m >= 3 && m <= 5 && dayEl === 1) score += 3; // ì—¬ë¦„ì— í™”
        if (m >= 6 && m <= 8 && dayEl === 3) score += 3; // ê°€ì„ì— ê¸ˆ
        if (m >= 9 && m <= 11 && dayEl === 4) score += 3; // ê²¨ìš¸ì— ìˆ˜

        score = Math.max(35, Math.min(95, score));
        descs.push({ score, desc });
    }

    return descs;
}

// ===== í‰ìƒìš´ (ëŒ€ìš´) ê³„ì‚° =====
// ëŒ€ìš´: ì›”ì£¼ë¥¼ ê¸°ë°˜ìœ¼ë¡œ 10ë…„ ë‹¨ìœ„ë¡œ ìˆœí–‰/ì—­í–‰
// ë‚¨ì ì–‘ë…„ìƒ or ì—¬ì ìŒë…„ìƒ â†’ ìˆœí–‰ (ì›”ì£¼ë¶€í„° ë‹¤ìŒ ê°„ì§€ë¡œ)
// ë‚¨ì ìŒë…„ìƒ or ì—¬ì ì–‘ë…„ìƒ â†’ ì—­í–‰

function calcDaeun(yearGan, monthGan, monthJi, gender, birthYear) {
    const yearYinYang = yearGan % 2; // 0=ì–‘, 1=ìŒ
    const isForward = (gender === 'male' && yearYinYang === 0) || (gender === 'female' && yearYinYang === 1);

    // ëŒ€ìš´ ì‹œì‘ ë‚˜ì´ (ê°„ì†Œí™”: ì ˆê¸°ê¹Œì§€ ë‚¨ì€ ì¼ / 3)
    // ì‹¤ì œë¡œëŠ” ìƒì¼ë¶€í„° ë‹¤ìŒ/ì´ì „ ì ˆê¸°ê¹Œì§€ì˜ ì¼ìˆ˜ / 3
    // ê°„ì†Œí™”: í‰ê·  3~4ì„¸ì— ì‹œì‘
    const startAge = 3 + (monthGan % 4); // 3~6ì„¸ ì‚¬ì´

    const daeunList = [];
    for (let i = 0; i < 9; i++) { // 9ê°œ ëŒ€ìš´ (ì•½ 90ì„¸ê¹Œì§€)
        let gan, ji;
        if (isForward) {
            gan = (monthGan + i + 1) % 10;
            ji = (monthJi + i + 1) % 12;
        } else {
            gan = (monthGan - i - 1 + 100) % 10;
            ji = (monthJi - i - 1 + 120) % 12;
        }
        const ageFrom = startAge + i * 10;
        const ageTo = ageFrom + 9;
        const yearFrom = birthYear + ageFrom;
        const yearTo = birthYear + ageTo;

        daeunList.push({
            gan, ji, ageFrom, ageTo, yearFrom, yearTo,
            ganName: CHEONGAN[gan], jiName: JIJI[ji],
            ganHanja: CHEONGAN_HANJA[gan], jiHanja: JIJI_HANJA[ji],
            ganEl: CHEONGAN_ELEMENT[gan], jiEl: JIJI_ELEMENT[ji]
        });
    }
    return { daeunList, startAge, isForward };
}

// ëŒ€ìš´ë³„ ìš´ì„¸ ì ìˆ˜ ê³„ì‚° (ì¬ë¬¼, ê±´ê°•, ì—°ì• , ìì‹, ë°°ìš°ì, ì§ì—…, í•™ì—…)
function calcDaeunScores(dayGan, dayJi, elements, daeun) {
    const dayEl = CHEONGAN_ELEMENT[dayGan];
    const dGan = daeun.gan;
    const dJi = daeun.ji;
    const dGanEl = CHEONGAN_ELEMENT[dGan];
    const dJiEl = JIJI_ELEMENT[dJi];

    const tenStar = getTenStar(dayGan, dGan);
    let base = 62;

    // ì‹­ì„± ê¸°ë°˜ ê¸°ë³¸ ì ìˆ˜
    switch(tenStar.type) {
        case 'wealth': base = 72; break;
        case 'power': base = 66; break;
        case 'resource': base = 75; break;
        case 'output': base = 70; break;
        case 'peer': base = 60; break;
    }

    // ì§€ì§€ ì¶©í•© ë³´ì •
    const jiRel = getJijiRelation(dayJi, dJi);
    base += jiRel.scoreAdj;

    // ì˜¤í–‰ ë³´ì™„ ë³´ì •
    const minElIdx = elements.indexOf(Math.min(...elements));
    if (dGanEl === minElIdx || dJiEl === minElIdx) base += 6; // ë¶€ì¡±í•œ ì˜¤í–‰ ë³´ì¶©

    // ê³¼ë‹¤ ì˜¤í–‰ ë³´ì •
    const maxElIdx = elements.indexOf(Math.max(...elements));
    if (dGanEl === maxElIdx && dJiEl === maxElIdx) base -= 4;

    base = Math.max(35, Math.min(92, base));

    // ====== ì„¸ë¶€ ìš´ì„¸ ê³„ì‚° ======
    let wealth = base, health = base, love = base, children = base, spouse = base, career = base;

    // ì¬ë¬¼ìš´ (ì¬ì„± ê´€ë ¨)
    // ë‚´ê°€ ê·¹í•˜ëŠ” ì˜¤í–‰ì´ ì¬ì„±
    const wealthEl = (dayEl + 2) % 5;
    if (dGanEl === wealthEl || dJiEl === wealthEl) wealth += 12;
    if (tenStar.type === 'wealth') wealth += 8;
    if (tenStar.type === 'output') wealth += 3; // ì‹ìƒìƒì¬
    // ì˜¤í–‰ ê· í˜• ì¢‹ìœ¼ë©´ ì¬ë¬¼ ì•ˆì •
    const elRange = Math.max(...elements) - Math.min(...elements);
    if (elRange <= 2) wealth += 3;

    // ê±´ê°•ìš´ (ì¸ì„±, ë¹„ê² ê´€ë ¨)
    if (tenStar.type === 'resource') health += 8;
    if (tenStar.type === 'peer') health += 3;
    if (tenStar.type === 'power') health -= 5; // ê´€ì„±ì€ ìŠ¤íŠ¸ë ˆìŠ¤
    // ì¼ê°„ ì˜¤í–‰ë³„ ê±´ê°• ì•½ì 
    if (dayEl === 0 && (dGanEl === 3 || dJiEl === 3)) health -= 5; // ê¸ˆê·¹ëª©
    if (dayEl === 1 && (dGanEl === 4 || dJiEl === 4)) health -= 5; // ìˆ˜ê·¹í™”
    if (dayEl === 2 && (dGanEl === 0 || dJiEl === 0)) health -= 5; // ëª©ê·¹í† 
    if (dayEl === 3 && (dGanEl === 1 || dJiEl === 1)) health -= 5; // í™”ê·¹ê¸ˆ
    if (dayEl === 4 && (dGanEl === 2 || dJiEl === 2)) health -= 5; // í† ê·¹ìˆ˜
    if (elements[4] >= 1 && dGanEl !== 1) health += 2; // ìˆ˜ê°€ ìˆìœ¼ë©´ ì•ˆì •

    // ì—°ì• ìš´ (ì‹ìƒ, ì¬ì„± ê´€ë ¨)
    if (tenStar.type === 'output') love += 10;
    if (tenStar.type === 'wealth') love += 6;
    // ì˜¤í™”(åˆ) ë“± í™” ê³„ì—´ì€ ì—´ì •
    if (dGanEl === 1 || dJiEl === 1) love += 3;
    // ì§€ì§€ í•©ì´ë©´ ì¸ì—° ì¢‹ìŒ
    if (jiRel.scoreAdj > 0) love += 5;

    // ë°°ìš°ììš´
    // ë‚¨ì: ì¬ì„±ì´ ë°°ìš°ì, ì—¬ì: ê´€ì„±ì´ ë°°ìš°ì
    // ê°„ì†Œí™”: ì‹ìƒ/ì¬ì„±ì€ ë°°ìš°ì ê¸¸, ê´€ì„±ë„ ë°°ìš°ì ê´€ë ¨
    if (tenStar.type === 'wealth') spouse += 10;
    if (tenStar.type === 'power') spouse += 8;
    if (tenStar.type === 'output') spouse += 5;
    // ì¼ì§€ì™€ ëŒ€ìš´ì§€ì§€ í•©ì´ë©´ ë°°ìš°ì ê¸¸
    if (jiRel.scoreAdj >= 5) spouse += 8;
    if (jiRel.scoreAdj <= -5) spouse -= 6;

    // ìì‹ìš´
    // ì‹ìƒ(é£Ÿå‚·)ì´ ìì‹ â†’ ì‹ìƒ ëŒ€ìš´ì—ì„œ ìì‹ìš´ ìƒìŠ¹
    if (tenStar.type === 'output') children += 12;
    if (tenStar.type === 'resource') children += 5; // ì¸ì„±ì€ í•™ì—…ìœ¼ë¡œ ìì‹ êµìœ¡
    if (tenStar.type === 'peer') children += 3;
    // í™”(ç«)ì˜ ìƒëª…ë ¥
    if (dGanEl === 1 || dJiEl === 1) children += 3;
    if (jiRel.scoreAdj >= 5) children += 4;

    // ì§ì—…ìš´
    if (tenStar.type === 'power') career += 12; // ê´€ì„± = ì§ìœ„
    if (tenStar.type === 'wealth') career += 8;
    if (tenStar.type === 'resource') career += 5;
    if (tenStar.type === 'output') career += 3;

    return {
        total: Math.max(35, Math.min(92, Math.round(base))),
        wealth: Math.max(30, Math.min(95, Math.round(wealth))),
        health: Math.max(30, Math.min(95, Math.round(health))),
        love: Math.max(30, Math.min(95, Math.round(love))),
        children: Math.max(30, Math.min(95, Math.round(children))),
        spouse: Math.max(30, Math.min(95, Math.round(spouse))),
        career: Math.max(30, Math.min(95, Math.round(career))),
        tenStar: tenStar
    };
}

function renderLifetimeFortune(dayGan, dayJi, yearGan, monthGan, monthJi, elements, gender, birthYear) {
    const { daeunList, startAge, isForward } = calcDaeun(yearGan, monthGan, monthJi, gender, birthYear);
    const currentYear = new Date().getFullYear();
    const currentAge = currentYear - birthYear;

    // ê° ëŒ€ìš´ ì ìˆ˜ ê³„ì‚°
    const daeunScores = daeunList.map(d => calcDaeunScores(dayGan, dayJi, elements, d));

    // í˜„ì¬ ëŒ€ìš´ ì°¾ê¸°
    let currentIdx = 0;
    for (let i = 0; i < daeunList.length; i++) {
        if (currentAge >= daeunList[i].ageFrom && currentAge <= daeunList[i].ageTo) {
            currentIdx = i;
            break;
        }
        if (currentAge > daeunList[i].ageTo) currentIdx = i + 1;
    }
    if (currentIdx >= daeunList.length) currentIdx = daeunList.length - 1;

    const curDaeun = daeunList[currentIdx];
    const curScores = daeunScores[currentIdx];

    // === 1. ìƒë‹¨ ìš”ì•½ ì¹´ë“œ ===
    const bestIdx = daeunScores.reduce((best, s, i) => s.total > daeunScores[best].total ? i : best, 0);
    const bestDaeun = daeunList[bestIdx];

    document.getElementById('lifetimeSummary').innerHTML = `
        <div class="lifetime-summary-item">
            <div class="ls-label">í˜„ì¬ ëŒ€ìš´</div>
            <div class="ls-value" style="color:${ELEMENT_COLORS[curDaeun.ganEl]}">
                ${curDaeun.ganHanja}${curDaeun.jiHanja} (${curDaeun.ageFrom}~${curDaeun.ageTo}ì„¸)
            </div>
        </div>
        <div class="lifetime-summary-item">
            <div class="ls-label">ëŒ€ìš´ ë°©í–¥</div>
            <div class="ls-value" style="color:var(--gold)">${isForward ? 'ìˆœí–‰ â–¶' : 'â—€ ì—­í–‰'}</div>
        </div>
        <div class="lifetime-summary-item">
            <div class="ls-label">ìµœê³  ìš´ê¸°</div>
            <div class="ls-value" style="color:var(--gold-light)">
                ${bestDaeun.ageFrom}~${bestDaeun.ageTo}ì„¸
            </div>
        </div>
    `;

    // === 2. ëŒ€ìš´ íƒ€ì„ë¼ì¸ ===
    let timelineHtml = '';
    daeunList.forEach((d, i) => {
        const isCurrent = i === currentIdx;
        const isPast = currentAge > d.ageTo;
        const stateClass = isCurrent ? 'current' : (isPast ? 'past' : '');
        const score = daeunScores[i].total;
        const barColor = score >= 75 ? 'var(--gold)' : score >= 60 ? 'var(--wood)' : score >= 45 ? 'var(--text-secondary)' : 'var(--fire)';

        timelineHtml += `<div class="daeun-item ${stateClass}">
            <div class="daeun-box">
                <div class="daeun-age">${d.ageFrom}~${d.ageTo}ì„¸</div>
                <div class="daeun-chars" style="color:${ELEMENT_COLORS[d.ganEl]}">${d.ganHanja}${d.jiHanja}</div>
                <div class="daeun-name">${d.ganName}${d.jiName}</div>
                <span class="daeun-element-tag ${ELEMENT_CLASSES[d.ganEl]}">${ELEMENT_SHORT[d.ganEl]}</span>
                <span class="daeun-element-tag ${ELEMENT_CLASSES[d.jiEl]}">${ELEMENT_SHORT[d.jiEl]}</span>
                <div class="daeun-score-bar"><div class="daeun-score-fill" style="width:${score}%;background:${barColor}"></div></div>
            </div>
            <div style="font-size:10px;color:var(--text-muted);margin-top:4px">${d.yearFrom}~${d.yearTo}</div>
        </div>`;
    });
    document.getElementById('daeunTimeline').innerHTML = timelineHtml;

    // === 3. í˜„ì¬ ëŒ€ìš´ ìƒì„¸ (ì¬ë¬¼, ê±´ê°•, ì—°ì• , ìì‹, ë°°ìš°ììš´) ===
    function scoreBarHtml(label, icon, score) {
        const barClass = score >= 75 ? 'bar-excellent' : score >= 60 ? 'bar-good' : score >= 45 ? 'bar-normal' : 'bar-caution';
        const grade = score >= 80 ? 'ëŒ€ê¸¸' : score >= 70 ? 'ê¸¸' : score >= 55 ? 'í‰' : score >= 45 ? 'ì†Œí‰' : 'ì£¼ì˜';
        return `<div class="cd-item">
            <div class="cd-item-label">${icon} ${label}</div>
            <div style="display:flex;align-items:center;gap:8px;margin-top:4px">
                <div style="flex:1;height:8px;background:rgba(255,255,255,0.05);border-radius:4px;overflow:hidden">
                    <div class="score-bar ${barClass}" style="width:${score}%;height:100%;border-radius:4px"></div>
                </div>
                <div class="cd-item-value" style="font-size:13px;min-width:60px">${score}ì  ${grade}</div>
            </div>
        </div>`;
    }

    // ëŒ€ìš´ë³„ ì„¸ë¶€ ì¡°ì–¸
    const tenStarName = curScores.tenStar.name;
    const tenStarDesc = curScores.tenStar.desc;

    document.getElementById('currentDaeunDetail').innerHTML = `
        <h4>ğŸ“ í˜„ì¬ ëŒ€ìš´: ${curDaeun.ganHanja}${curDaeun.jiHanja} (${curDaeun.ganName}${curDaeun.jiName}) â€” ${curDaeun.ageFrom}~${curDaeun.ageTo}ì„¸</h4>
        <div style="font-size:13px;color:var(--text-secondary);margin-bottom:12px">
            ëŒ€ìš´ ì‹­ì„±: <strong style="color:var(--gold)">${tenStarName}</strong> Â· ${tenStarDesc} Â· ${curDaeun.yearFrom}~${curDaeun.yearTo}ë…„
        </div>
        <div class="cd-grid">
            ${scoreBarHtml('ì¬ë¬¼ìš´', 'ğŸ’°', curScores.wealth)}
            ${scoreBarHtml('ì§ì—…ìš´', 'ğŸ’¼', curScores.career)}
            ${scoreBarHtml('ê±´ê°•ìš´', 'ğŸ¥', curScores.health)}
            ${scoreBarHtml('ì—°ì• ìš´', 'â¤ï¸', curScores.love)}
            ${scoreBarHtml('ë°°ìš°ììš´', 'ğŸ’‘', curScores.spouse)}
            ${scoreBarHtml('ìì‹ìš´', 'ğŸ‘¶', curScores.children)}
        </div>
    `;

    // === 4. í‰ìƒ ìš´ì„¸ íë¦„ ì°¨íŠ¸ ===
    let flowHtml = '<div class="flow-title">ğŸ“ˆ í‰ìƒ ìš´ì„¸ íë¦„</div>';

    // ì¢…í•© ìš´ì„¸ ë§‰ëŒ€
    flowHtml += '<div style="margin-bottom:12px;font-size:12px;color:var(--text-muted)">â–¶ ì¢…í•© ìš´ê¸°</div><div class="flow-chart">';
    daeunList.forEach((d, i) => {
        const s = daeunScores[i].total;
        const barColor = s >= 75 ? 'var(--gold)' : s >= 60 ? 'var(--wood)' : s >= 45 ? 'var(--text-secondary)' : 'var(--fire)';
        const h = Math.max(8, s * 0.8);
        const isCur = i === currentIdx;
        flowHtml += `<div class="flow-bar-wrap">
            <div class="flow-bar" style="height:${h}%;background:${barColor};${isCur ? 'box-shadow:0 0 6px var(--gold);' : ''}"></div>
            <div class="flow-bar-label" style="${isCur ? 'color:var(--gold);font-weight:700' : ''}">${d.ageFrom}ëŒ€</div>
        </div>`;
    });
    flowHtml += '</div>';

    // ì„¸ë¶€ ìš´ì„¸ íë¦„ (ì¬ë¬¼, ê±´ê°•, ì—°ì• , ë°°ìš°ì, ìì‹)
    const flowItems = [
        { key: 'wealth', label: 'ğŸ’° ì¬ë¬¼ìš´', color: 'var(--gold)' },
        { key: 'health', label: 'ğŸ¥ ê±´ê°•ìš´', color: 'var(--wood)' },
        { key: 'love', label: 'â¤ï¸ ì—°ì• ìš´', color: 'var(--fire)' },
        { key: 'spouse', label: 'ğŸ’‘ ë°°ìš°ììš´', color: '#e879a0' },
        { key: 'children', label: 'ğŸ‘¶ ìì‹ìš´', color: 'var(--water)' }
    ];

    flowItems.forEach(fi => {
        flowHtml += `<div style="margin-top:12px;margin-bottom:4px;font-size:12px;color:var(--text-muted)">â–¶ ${fi.label}</div><div class="flow-chart">`;
        daeunList.forEach((d, i) => {
            const s = daeunScores[i][fi.key];
            const h = Math.max(8, s * 0.8);
            const isCur = i === currentIdx;
            flowHtml += `<div class="flow-bar-wrap">
                <div class="flow-bar" style="height:${h}%;background:${fi.color};opacity:${isCur ? 1 : 0.7};${isCur ? 'box-shadow:0 0 6px ' + fi.color + ';' : ''}"></div>
                <div class="flow-bar-label" style="${isCur ? 'color:var(--gold);font-weight:700' : ''}">${d.ageFrom}ëŒ€</div>
            </div>`;
        });
        flowHtml += '</div>';
    });

    document.getElementById('lifetimeFlow').innerHTML = flowHtml;

    // === 5. í‰ìƒìš´ ì¢…í•© ì¡°ì–¸ ===
    let adviceText = '';

    // ëŒ€ìš´ íë¦„ ë¶„ì„
    adviceText += `ëŒ€ìš´ì€ ${isForward ? '<strong>ìˆœí–‰(é †è¡Œ)</strong>' : '<strong>ì—­í–‰(é€†è¡Œ)</strong>'}ìœ¼ë¡œ ${startAge}ì„¸ë¶€í„° ì‹œì‘í•©ë‹ˆë‹¤. `;
    adviceText += `í˜„ì¬ <strong style="color:${ELEMENT_COLORS[curDaeun.ganEl]}">${curDaeun.ganHanja}${curDaeun.jiHanja} ëŒ€ìš´</strong>(${curDaeun.ageFrom}~${curDaeun.ageTo}ì„¸)ì— ìˆìœ¼ë©°, `;
    adviceText += `${tenStarName}ì˜ ê¸°ìš´ì´ ì‘ìš©í•©ë‹ˆë‹¤.`;

    // í˜„ì¬ ëŒ€ìš´ í•´ì„
    adviceText += '<br><br>';
    switch(curScores.tenStar.type) {
        case 'wealth':
            adviceText += 'ğŸ’° <strong>ì¬ì„± ëŒ€ìš´</strong>ì…ë‹ˆë‹¤. ì¬ë¬¼ê³¼ ê´€ë ¨ëœ ê¸°íšŒê°€ ë§ì€ ì‹œê¸°ì…ë‹ˆë‹¤. íˆ¬ì, ì‚¬ì—…, ì¬í…Œí¬ì— ìœ ë¦¬í•˜ë©°, í˜„ì‹¤ì ì¸ ëª©í‘œë¥¼ ì„¸ìš°ê³  ê¾¸ì¤€íˆ ë…¸ë ¥í•˜ë©´ ì¢‹ì€ ì„±ê³¼ë¥¼ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¤ë§Œ ê³¼ìš•ì€ ê¸ˆë¬¼ì´ë©° ì•ˆì •ì ì¸ ìì‚° ê´€ë¦¬ê°€ ì¤‘ìš”í•©ë‹ˆë‹¤.';
            break;
        case 'power':
            adviceText += 'ğŸ’¼ <strong>ê´€ì„± ëŒ€ìš´</strong>ì…ë‹ˆë‹¤. ì§ì¥ì´ë‚˜ ì‚¬íšŒì  ì§€ìœ„ì— ë³€í™”ê°€ ìˆëŠ” ì‹œê¸°ì…ë‹ˆë‹¤. ìŠ¹ì§„, ëª…ì˜ˆ, ì±…ì„ê°ì´ ì»¤ì§€ë©°, ì¡°ì§ ë‚´ì—ì„œ ì¸ì •ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¤ë§Œ ìŠ¤íŠ¸ë ˆìŠ¤ì™€ ì••ë°•ê°ë„ ìˆìœ¼ë¯€ë¡œ ê±´ê°• ê´€ë¦¬ì— ì‹ ê²½ ì“°ì„¸ìš”.';
            break;
        case 'resource':
            adviceText += 'ğŸ“ <strong>ì¸ì„± ëŒ€ìš´</strong>ì…ë‹ˆë‹¤. í•™ì—…, ìê¸°ê³„ë°œ, ë‚´ë©´ì˜ ì„±ì¥ì— ìœ ë¦¬í•œ ì‹œê¸°ì…ë‹ˆë‹¤. ê·€ì¸ì˜ ë„ì›€ì„ ë°›ê¸° ì‰¬ìš°ë©°, ìƒˆë¡œìš´ ì§€ì‹ê³¼ ì§€í˜œë¥¼ ìŒ“ê¸° ì¢‹ìŠµë‹ˆë‹¤. ì •ì‹ ì  ì•ˆì •ê³¼ í‰í™”ë¥¼ ëŠë¼ëŠ” ì‹œê¸°ì…ë‹ˆë‹¤.';
            break;
        case 'output':
            adviceText += 'ğŸ¨ <strong>ì‹ìƒ ëŒ€ìš´</strong>ì…ë‹ˆë‹¤. ì°½ì˜ë ¥, í‘œí˜„ë ¥ì´ ê·¹ëŒ€í™”ë˜ëŠ” ì‹œê¸°ì…ë‹ˆë‹¤. ì˜ˆìˆ , ì°½ì‘, ììœ ë¡œìš´ í™œë™ì— ìœ ë¦¬í•©ë‹ˆë‹¤. ìì‹ìš´ë„ ì¢‹ìœ¼ë©°, ìƒˆë¡œìš´ ê²ƒì„ íƒ„ìƒì‹œí‚¤ëŠ” ê¸°ìš´ì´ ìˆìŠµë‹ˆë‹¤. ë‹¤ë§Œ ì²´ë ¥ ì†Œëª¨ì— ì£¼ì˜í•˜ì„¸ìš”.';
            break;
        case 'peer':
            adviceText += 'ğŸ¤ <strong>ë¹„ê² ëŒ€ìš´</strong>ì…ë‹ˆë‹¤. ë…ë¦½ì‹¬ì´ ê°•í•´ì§€ê³  ìê¸° ì£¼ë„ì ì¸ ì‚¶ì„ ì‚´ê²Œ ë˜ëŠ” ì‹œê¸°ì…ë‹ˆë‹¤. ê²½ìŸì´ ìˆì§€ë§Œ ìë¦½ì˜ ê¸°íšŒì´ê¸°ë„ í•©ë‹ˆë‹¤. ì¸ê°„ê´€ê³„ì—ì„œ ì£¼ë„ê¶Œì„ ì¥ê²Œ ë˜ë©°, ìƒˆë¡œìš´ ì‹œì‘ì— ìœ ë¦¬í•©ë‹ˆë‹¤.';
            break;
    }

    // ì¬ë¬¼ìš´ íŠ¹ë³„ ì¡°ì–¸
    adviceText += '<br><br>ğŸ’° <strong>ì¬ë¬¼ìš´ í¬ì¸íŠ¸:</strong> ';
    const wealthPeak = daeunScores.reduce((best, s, i) => s.wealth > daeunScores[best].wealth ? i : best, 0);
    adviceText += `ì¬ë¬¼ìš´ì´ ê°€ì¥ ì¢‹ì€ ì‹œê¸°ëŠ” <strong>${daeunList[wealthPeak].ageFrom}~${daeunList[wealthPeak].ageTo}ì„¸</strong>(${daeunList[wealthPeak].yearFrom}~${daeunList[wealthPeak].yearTo}ë…„)ì…ë‹ˆë‹¤. `;
    if (curScores.wealth >= 70) adviceText += 'í˜„ì¬ ì¬ë¬¼ìš´ì´ ì¢‹ìœ¼ë‹ˆ ì ê·¹ì ì¸ ì¬í…Œí¬ë¥¼ ì¶”ì²œí•©ë‹ˆë‹¤.';
    else if (curScores.wealth >= 55) adviceText += 'í˜„ì¬ ì¬ë¬¼ìš´ì€ ë³´í†µì´ë©°, ì•ˆì •ì ì¸ ì €ì¶•ê³¼ íˆ¬ìë¥¼ ê¶Œí•©ë‹ˆë‹¤.';
    else adviceText += 'í˜„ì¬ ì¬ë¬¼ìš´ì€ ë‹¤ì†Œ ë‚®ìœ¼ë‹ˆ í° íˆ¬ìë³´ë‹¤ëŠ” ì ˆì•½ê³¼ ì•ˆì •ì„ ì¶”êµ¬í•˜ì„¸ìš”.';

    // ê±´ê°•ìš´ íŠ¹ë³„ ì¡°ì–¸
    adviceText += '<br><br>ğŸ¥ <strong>ê±´ê°•ìš´ í¬ì¸íŠ¸:</strong> ';
    const healthLow = daeunScores.reduce((worst, s, i) => s.health < daeunScores[worst].health ? i : worst, 0);
    adviceText += `ê±´ê°•ì— íŠ¹íˆ ì£¼ì˜í•´ì•¼ í•  ì‹œê¸°ëŠ” <strong>${daeunList[healthLow].ageFrom}~${daeunList[healthLow].ageTo}ì„¸</strong>ì…ë‹ˆë‹¤. `;
    const dayElForHealth = CHEONGAN_ELEMENT[dayGan];
    const healthParts = ['ê°„/ë‹´(è‚è†½)', 'ì‹¬ì¥/ì†Œì¥(å¿ƒå°è…¸)', 'ìœ„/ë¹„ì¥(èƒƒè„¾)', 'í/ëŒ€ì¥(è‚ºå¤§è…¸)', 'ì‹ ì¥/ë°©ê´‘(è…è†€èƒ±)'];
    adviceText += `ì¼ê°„ ê¸°ì¤€ ${healthParts[dayElForHealth]} ê±´ê°•ì— í‰ìƒ ìœ ì˜í•˜ì„¸ìš”.`;

    // ì—°ì• /ë°°ìš°ììš´ ì¡°ì–¸
    adviceText += '<br><br>â¤ï¸ <strong>ì—°ì• Â·ë°°ìš°ììš´ í¬ì¸íŠ¸:</strong> ';
    const lovePeak = daeunScores.reduce((best, s, i) => s.love > daeunScores[best].love ? i : best, 0);
    const spousePeak = daeunScores.reduce((best, s, i) => s.spouse > daeunScores[best].spouse ? i : best, 0);
    adviceText += `ì—°ì• ìš´ì´ ê°€ì¥ ì¢‹ì€ ì‹œê¸°ëŠ” <strong>${daeunList[lovePeak].ageFrom}~${daeunList[lovePeak].ageTo}ì„¸</strong>ì´ë©°, `;
    adviceText += `ë°°ìš°ììš´ì´ ê°€ì¥ ì¢‹ì€ ì‹œê¸°ëŠ” <strong>${daeunList[spousePeak].ageFrom}~${daeunList[spousePeak].ageTo}ì„¸</strong>ì…ë‹ˆë‹¤. `;
    if (curScores.spouse >= 70) adviceText += 'í˜„ì¬ ë°°ìš°ìì™€ì˜ ê´€ê³„ê°€ ëˆë…í•´ì§€ëŠ” ì‹œê¸°ì…ë‹ˆë‹¤.';
    else if (curScores.love >= 70) adviceText += 'í˜„ì¬ ìƒˆë¡œìš´ ì¸ì—°ì„ ë§Œë‚˜ê¸° ì¢‹ì€ ì‹œê¸°ì…ë‹ˆë‹¤.';

    // ìì‹ìš´ ì¡°ì–¸
    adviceText += '<br><br>ğŸ‘¶ <strong>ìì‹ìš´ í¬ì¸íŠ¸:</strong> ';
    const childPeak = daeunScores.reduce((best, s, i) => s.children > daeunScores[best].children ? i : best, 0);
    adviceText += `ìì‹ìš´ì´ ê°€ì¥ ì¢‹ì€ ì‹œê¸°ëŠ” <strong>${daeunList[childPeak].ageFrom}~${daeunList[childPeak].ageTo}ì„¸</strong>ì…ë‹ˆë‹¤. `;
    if (curScores.children >= 70) adviceText += 'í˜„ì¬ ìë…€ì™€ì˜ ê´€ê³„ê°€ ì¢‹ê±°ë‚˜, ìë…€ì—ê²Œ ê²½ì‚¬ê°€ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.';
    else adviceText += 'ìë…€ êµìœ¡ì´ë‚˜ ê´€ê³„ì— ìˆì–´ ê¾¸ì¤€í•œ ì†Œí†µì´ ì¤‘ìš”í•©ë‹ˆë‹¤.';

    // ì¸ìƒ ìµœê³  ìš´ê¸°
    adviceText += `<br><br>â­ <strong>ì¸ìƒ ìµœê³  ìš´ê¸°:</strong> <strong style="color:var(--gold)">${bestDaeun.ageFrom}~${bestDaeun.ageTo}ì„¸</strong>(${bestDaeun.yearFrom}~${bestDaeun.yearTo}ë…„)ì— ì¢…í•© ìš´ê¸°ê°€ ê°€ì¥ ë†’ìŠµë‹ˆë‹¤. ì´ ì‹œê¸°ë¥¼ ì˜ í™œìš©í•˜ì„¸ìš”!`;

    document.getElementById('lifetimeAdvice').innerHTML = `
        <div class="lifetime-advice-title">ğŸ”® í‰ìƒìš´ ì¢…í•© í•´ì„</div>
        <div class="lifetime-advice-text">${adviceText}</div>
    `;
}

function getFortuneAdvice(dayGan, tenStarType, elements, totalScore, scores) {
    const dayEl = CHEONGAN_ELEMENT[dayGan];
    const elNames = ['ëª©(æœ¨)', 'í™”(ç«)', 'í† (åœŸ)', 'ê¸ˆ(é‡‘)', 'ìˆ˜(æ°´)'];
    let advice = '';

    // ì „ì²´ ìš´ì„¸ ê¸°ì¡°
    advice += `2026ë…„ ë³‘ì˜¤(ä¸™åˆ)ë…„ì€ <strong style="color:var(--fire)">í™”(ç«)ì˜ ê¸°ìš´</strong>ì´ ì²œê°„ê³¼ ì§€ì§€ ëª¨ë‘ì—ì„œ ê°•í•˜ê²Œ ì‘ìš©í•˜ëŠ” í•´ì…ë‹ˆë‹¤. `;

    // ì‹­ì„± ê¸°ë°˜ ì¡°ì–¸
    switch(tenStarType) {
        case 'wealth':
            advice += 'ë‹¹ì‹ ì—ê²ŒëŠ” <strong style="color:var(--gold)">ì¬ì„±(è²¡æ˜Ÿ)ì˜ í•´</strong>ë¡œ, ì¬ë¬¼ê³¼ ê´€ë ¨ëœ ê¸°íšŒê°€ ì°¾ì•„ì˜µë‹ˆë‹¤. íˆ¬ìë‚˜ ì‚¬ì—… í™•ì¥ì— ìœ ë¦¬í•˜ë‚˜, ê³¼ìš•ì€ ê¸ˆë¬¼ì…ë‹ˆë‹¤. ';
            break;
        case 'power':
            advice += 'ë‹¹ì‹ ì—ê²ŒëŠ” <strong style="color:var(--fire)">ê´€ì„±(å®˜æ˜Ÿ)ì˜ í•´</strong>ë¡œ, ì§ì¥ì´ë‚˜ ì‚¬íšŒì  ì§€ìœ„ì— ë³€í™”ê°€ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìŠ¹ì§„ì´ë‚˜ ì±…ì„ì˜ ì¦ê°€ê°€ ì˜ˆìƒë©ë‹ˆë‹¤. ì••ë°•ê°ì„ ì§€í˜œë¡œ ê·¹ë³µí•˜ì„¸ìš”. ';
            break;
        case 'resource':
            advice += 'ë‹¹ì‹ ì—ê²ŒëŠ” <strong style="color:var(--water)">ì¸ì„±(å°æ˜Ÿ)ì˜ í•´</strong>ë¡œ, í•™ì—…ì´ë‚˜ ìê¸°ê³„ë°œì— ë§¤ìš° ìœ ë¦¬í•©ë‹ˆë‹¤. ê·€ì¸ì˜ ë„ì›€ì´ ìˆìœ¼ë©° ë‚´ë©´ì˜ ì„±ì¥ì´ í¬ê²Œ ì´ë£¨ì–´ì§‘ë‹ˆë‹¤. ';
            break;
        case 'output':
            advice += 'ë‹¹ì‹ ì—ê²ŒëŠ” <strong style="color:var(--wood)">ì‹ìƒ(é£Ÿå‚·)ì˜ í•´</strong>ë¡œ, ì°½ì˜ë ¥ê³¼ í‘œí˜„ë ¥ì´ ê·¹ëŒ€í™”ë©ë‹ˆë‹¤. ì˜ˆìˆ , ì°½ì‘, ì†Œí†µ ë¶„ì•¼ì—ì„œ ë¹›ì„ ë°œí•©ë‹ˆë‹¤. ë‹¤ë§Œ ì²´ë ¥ ê´€ë¦¬ì— ì‹ ê²½ ì“°ì„¸ìš”. ';
            break;
        case 'peer':
            advice += 'ë‹¹ì‹ ì—ê²ŒëŠ” <strong style="color:var(--metal)">ë¹„ê²(æ¯”åŠ«)ì˜ í•´</strong>ë¡œ, ê²½ìŸê³¼ í˜‘ë ¥ì´ ê³µì¡´í•˜ëŠ” í•œ í•´ì…ë‹ˆë‹¤. ë…ë¦½ì‹¬ì´ ê°•í•´ì§€ë©°, ì¸ê°„ê´€ê³„ì—ì„œ ì£¼ë„ì  ì—­í• ì„ í•˜ê²Œ ë©ë‹ˆë‹¤. ';
            break;
    }

    // ì˜¤í–‰ ê· í˜• ì¡°ì–¸
    if (elements[1] === 0) {
        advice += '<br><br>ğŸ“Œ <strong>íŠ¹ë³„ ê¸¸ìš´:</strong> ì‚¬ì£¼ì— ë¶€ì¡±í•œ í™”(ç«)ë¥¼ 2026ë…„ ì„¸ìš´ì´ ì±„ì›Œì¤ë‹ˆë‹¤. í™œë ¥ê³¼ ì—´ì •ì´ ë˜ì‚´ì•„ë‚˜ëŠ” í•œ í•´ê°€ ë  ê²ƒì…ë‹ˆë‹¤. ì ê·¹ì ìœ¼ë¡œ í–‰ë™í•˜ì„¸ìš”.';
    } else if (elements[1] >= 3) {
        advice += '<br><br>âš ï¸ <strong>ì£¼ì˜:</strong> ì‚¬ì£¼ì— ì´ë¯¸ í™”(ç«)ê°€ ë§ì€ë° ë³‘ì˜¤ë…„ì˜ ê°•í•œ í™” ê¸°ìš´ì´ ë”í•´ì ¸ ê³¼ì—´ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì‹¬ì¥, í˜ˆì••, ìŠ¤íŠ¸ë ˆìŠ¤ ê´€ë¦¬ì— ê°ë³„íˆ ì£¼ì˜í•˜ê³ , ìˆ˜(æ°´) ê¸°ìš´ì„ ë³´ì¶©í•˜ì„¸ìš”(ìˆ˜ì˜, ëª…ìƒ, ì°¨ë¶„í•œ í™œë™).';
    }

    // ê±´ê°• ì£¼ì˜
    if (scores.health < 55) {
        advice += '<br><br>ğŸ¥ <strong>ê±´ê°• ê´€ë¦¬:</strong> í™” ê¸°ìš´ì´ ê°•í•œ í•´ì´ë¯€ë¡œ ì‹¬ì¥, í˜ˆì••, ëˆˆ ê±´ê°•ì— ì£¼ì˜í•˜ì„¸ìš”. ì¶©ë¶„í•œ ìˆ˜ë¶„ ì„­ì·¨ì™€ ê·œì¹™ì ì¸ íœ´ì‹ì´ ì¤‘ìš”í•©ë‹ˆë‹¤.';
    }

    // í–‰ìš´ì˜ ë°©í–¥
    const luckyDirections = ['ë™ìª½', 'ë‚¨ìª½', 'ì¤‘ì•™', 'ì„œìª½', 'ë¶ìª½'];
    const luckyColors = ['ì´ˆë¡ìƒ‰', 'ë¹¨ê°„ìƒ‰', 'ë…¸ë€ìƒ‰', 'í°ìƒ‰', 'ê²€ì€ìƒ‰/íŒŒë€ìƒ‰'];
    const luckyNums = ['3, 8', '2, 7', '5, 10', '4, 9', '1, 6'];
    const needEl = elements.indexOf(Math.min(...elements));

    advice += `<br><br>ğŸ€ <strong>2026ë…„ í–‰ìš´ì˜ í‚¤ì›Œë“œ</strong><br>`;
    advice += `â€¢ í–‰ìš´ì˜ ë°©í–¥: <strong>${luckyDirections[needEl]}</strong><br>`;
    advice += `â€¢ í–‰ìš´ì˜ ìƒ‰ìƒ: <strong>${luckyColors[needEl]}</strong><br>`;
    advice += `â€¢ í–‰ìš´ì˜ ìˆ«ì: <strong>${luckyNums[needEl]}</strong>`;

    return advice;
}

// ===== ì„±ëª…í•™ (å§“åå­¸) =====
const HANGUL_STROKES = {
    'ã„±':2,'ã„²':4,'ã„´':2,'ã„·':3,'ã„¸':6,'ã„¹':5,'ã…':4,'ã…‚':4,'ã…ƒ':8,'ã……':2,'ã…†':4,'ã…‡':1,'ã…ˆ':3,'ã…‰':6,'ã…Š':4,'ã…‹':3,'ã…Œ':4,'ã…':4,'ã…':3,
    'ã…':2,'ã…':3,'ã…‘':3,'ã…’':4,'ã…“':2,'ã…”':3,'ã…•':3,'ã…–':4,'ã…—':2,'ã…˜':4,'ã…™':5,'ã…š':3,'ã…›':3,'ã…œ':2,'ã…':4,'ã…':5,'ã…Ÿ':3,'ã… ':3,'ã…¡':1,'ã…¢':2,'ã…£':1,
    '':0
};
const JONGSUNG_STROKES = [0,2,4,5,2,4,7,3,4,6,7,6,7,4,2,4,3,4,4,3,1,0];
function getHangulStrokes(ch) {
    const code = ch.charCodeAt(0);
    if (code < 0xAC00 || code > 0xD7A3) return 0;
    const offset = code - 0xAC00;
    const cho = Math.floor(offset / (21 * 28));
    const jung = Math.floor((offset % (21 * 28)) / 28);
    const jong = offset % 28;
    const CHO_LIST = ['ã„±','ã„²','ã„´','ã„·','ã„¸','ã„¹','ã…','ã…‚','ã…ƒ','ã……','ã…†','ã…‡','ã…ˆ','ã…‰','ã…Š','ã…‹','ã…Œ','ã…','ã…'];
    const JUNG_LIST = ['ã…','ã…','ã…‘','ã…’','ã…“','ã…”','ã…•','ã…–','ã…—','ã…˜','ã…™','ã…š','ã…›','ã…œ','ã…','ã…','ã…Ÿ','ã… ','ã…¡','ã…¢','ã…£'];
    return (HANGUL_STROKES[CHO_LIST[cho]] || 0) + (HANGUL_STROKES[JUNG_LIST[jung]] || 0) + JONGSUNG_STROKES[jong];
}
function getNameStrokes(name) {
    return [...name].map(ch => getHangulStrokes(ch));
}

const SURI_81 = [
    '',
    'ëŒ€ê¸¸ â€” ë§Œë¬¼ì˜ ì‹œì‘, ë¶€ê·€ì˜í™”ì˜ ìˆ˜',
    'í‰ â€” ë¶„ë¦¬ê³ ë…, ë¯¸ì™„ì„±ì˜ ìˆ˜',
    'ê¸¸ â€” ë³µë¡í’ì„±, ì§€í˜œì™€ ë°œì „ì˜ ìˆ˜',
    'í‰ â€” ê³ ë‚œë¶ˆì•ˆ, íŒŒë©¸ì˜ ìˆ˜',
    'ê¸¸ â€” ê±´ê°•ì¥ìˆ˜, ë³µë•ì˜ ìˆ˜',
    'ê¸¸ â€” ì²œë•ì„ ë°›ì•„ ì•ˆì •ë˜ëŠ” ìˆ˜',
    'ê¸¸ â€” ë…ë¦½ë…í–‰, ê°•ê±´í•œ ì˜ì§€ì˜ ìˆ˜',
    'ê¸¸ â€” ì¸ë‚´ì™€ ë…¸ë ¥ìœ¼ë¡œ ì„±ê³µí•˜ëŠ” ìˆ˜',
    'í‰ â€” ê³ ë…ë¹ˆê³¤, ì—­ê²½ì˜ ìˆ˜',
    'í‰ â€” ê³µí—ˆí—ˆë§, ë‹¨ëª…ì˜ ìˆ˜',
    'ê¸¸ â€” ë§Œë³´ê°±ì‹ , ìˆœì¡°ë¡œìš´ ë°œì „ì˜ ìˆ˜',
    'í‰ â€” ê³ ë…ë°•ëª…, ê°€ì •ë¶ˆí™”ì˜ ìˆ˜',
    'ê¸¸ â€” ì§€ëª¨ì¶œì¤‘, í•™ì˜ˆì„±ì·¨ì˜ ìˆ˜',
    'í‰ â€” ì´ë³„ê³ ë…, íŒŒì¬ì˜ ìˆ˜',
    'ê¸¸ â€” ë³µìˆ˜ê²¸ì „, ëª…ë§ì˜ ìˆ˜',
    'ê¸¸ â€” ë•ë§ë†’ì€ ì§€ë„ìì˜ ìˆ˜',
    'ê¸¸ â€” ê¶Œìœ„ê°•ê±´, ëŒíŒŒë§Œë‚œì˜ ìˆ˜',
    'ê¸¸ â€” ìœ ì§€ë°œì „, ë‚´ì‹¤ë‹¤ë³µì˜ ìˆ˜',
    'í‰ â€” í’íŒŒì¥í•´, ê³ ë‚œì˜ ìˆ˜',
    'í‰ â€” í—ˆë¬´ê³µë§, ë‹¨ëª…ì˜ ìˆ˜',
    'ê¸¸ â€” ë…ë¦½ê¶Œìœ„, ë‘ë ¹ì˜ ìˆ˜',
    'í‰ â€” ì¤‘ë„ì¢Œì ˆ, ê°€ì„ ì„œë¦¬ì˜ ìˆ˜',
    'ê¸¸ â€” ê³µëª…ë¶€ê·€, ì„±ê³µë°œë‹¬ì˜ ìˆ˜',
    'ê¸¸ â€” ì¶œì„¸ì„±ê³µ, ì¬ë¬¼í’ë¶€ì˜ ìˆ˜',
    'ê¸¸ â€” ì˜ì›…í˜¸ê±¸, ê¸°ë¹„ìƒë°˜ì˜ ìˆ˜',
    'í‰ â€” ì˜ì›…ë°•ëª…, í’íŒŒì˜ ìˆ˜',
    'í‰ â€” ì´ë³„ì¬ë‚œ, ê³ ë…ì˜ ìˆ˜',
    'í‰ â€” ë³€í™”ë¶ˆì•ˆ, íŒŒë€ì˜ ìˆ˜',
    'ê¸¸ â€” ì§€í˜œì´ëª…, ìˆœí’ì— ë›ë‹¨ ìˆ˜',
    'í‰ â€” ë¶€ì¹¨ë¶ˆì •, ê¸¸í‰ìƒë°˜ì˜ ìˆ˜',
    'ê¸¸ â€” ìˆœí’ë§Œë²”, ì²œí–‰ëŒ€í†µì˜ ìˆ˜',
    'ê¸¸ â€” ìš”í–‰ë§Œì‚¬, ê·€ì¸ì˜ ë„ì›€ì„ ë°›ëŠ” ìˆ˜',
    'ê¸¸ â€” ìœµì°½ë²ˆì˜, ëª…ì˜ˆì˜ ìˆ˜',
    'í‰ â€” íŒŒë©¸ì¬ì•™, ê°€ì •ë¶ˆí–‰ì˜ ìˆ˜',
    'ê¸¸ â€” ì˜¨í™”í‰ìˆœ, ë¬¸ë¬´ê²¸ë¹„ì˜ ìˆ˜',
    'í‰ â€” í’íŒŒê³ ìƒ, ì˜í˜‘ì‹¬ì˜ ìˆ˜',
    'ê¸¸ â€” ì¸ë•ê²¸ë¹„, ë¬¸ì˜ˆë°œë‹¬ì˜ ìˆ˜',
    'í‰ â€” ë°•ì•½ë¬´ë ¥, ê³ ë…ì˜ ìˆ˜',
    'ê¸¸ â€” ë¶€ê·€ì¥ìˆ˜, ì˜í™”ì˜ ìˆ˜',
    'í‰ â€” ë³€í™”ë¬´ìƒ, ë¶€ì¹¨ì˜ ìˆ˜',
    'ê¸¸ â€” ë•ë§ë†’ì€ ì²œë¶€ì˜ ìˆ˜',
    'í‰ â€” ì‚°ë€ì´ë³„, ê³ ë…ì˜ ìˆ˜',
    'í‰ â€” ì‚°ì¬ë°•ëª…, ë‚­ë¹„ì˜ ìˆ˜',
    'í‰ â€” ì•”í‘íŒŒê´´, ë³€ì‚¬ì˜ ìˆ˜',
    'ê¸¸ â€” ìˆœí’ë§Œë²”, ì˜ë‹¬ì˜ ìˆ˜',
    'í‰ â€” íŒŒì‚°ì‹¤íŒ¨, ê³ ë…ì˜ ìˆ˜',
    'ê¸¸ â€” ê³ ê³ ë…ë¦½, ë•ë§ê°€ì˜ ìˆ˜',
    'ê¸¸ â€” ìœ ë•ê²¸ë¹„, ê°€ì •í™”ëª©ì˜ ìˆ˜',
    'í‰ â€” ì¼ì„±ì¼íŒ¨, ê¸¸í‰ë°˜ë°˜ì˜ ìˆ˜',
    'í‰ â€” í˜¼ëˆë¯¸ê°œ, ë¶€ì¹¨ì˜ ìˆ˜',
    'ê¸¸ â€” ì„±ëŒ€ìš´ê¸°, ì¥ë˜ìœ ë§ì˜ ìˆ˜',
    'ê¸¸ â€” ë§Œì‚¬í˜•í†µ, ì„ ê²¬ì§€ëª…ì˜ ìˆ˜',
    'í‰ â€” ë‚´ìš°ì™¸í™˜, ì¥ì• ì˜ ìˆ˜',
    'í‰ â€” ë‹¤ì¬ë‹¤ë‚œ, ë¶ˆí–‰ì˜ ìˆ˜',
    'í‰ â€” ë¶ˆì•ˆì¬í•´, ì¢Œì ˆì˜ ìˆ˜',
    'í‰ â€” ë§Œì„±ì§„í‡´, ì €ì¡°ì˜ ìˆ˜',
    'ê¸¸ â€” ì „í›„í¥íŒ¨, ë§ë…„í–‰ë³µì˜ ìˆ˜',
    'í‰ â€” ê³ ë…ì•”ì˜, ì¬ë‚œì˜ ìˆ˜',
    'í‰ â€” ë¶ˆìš°í•œ ìˆ˜',
    'í‰ â€” ë¬´ê¸°ë ¥, ì˜ì§€ë¶€ì¡±ì˜ ìˆ˜',
    'ê¸¸ â€” ë¶€ê·€ì˜í™”, ë§Œì‚¬í˜•í†µì˜ ìˆ˜',
    'í‰ â€” ì‡ í‡´ì‚°ë€, ë¶ˆì•ˆì˜ ìˆ˜',
    'ê¸¸ â€” ë§Œì‚¬í•­í†µ, êµì œì›ë§Œì˜ ìˆ˜',
    'í‰ â€” ê³ ë‚œì—­ê²½, ë¶ˆì•ˆì˜ ìˆ˜',
    'ê¸¸ â€” ìœ ìˆœí‰í™”, ë§Œì‚¬ì™„ì„±ì˜ ìˆ˜',
    'í‰ â€” ì§„í‡´ë¶ˆê²°, ë‚´ì™¸ë¶ˆí™”ì˜ ìˆ˜',
    'ê¸¸ â€” ìˆœë°œë‹¬ì„±, ë²ˆì˜ì˜ ìˆ˜',
    'ê¸¸ â€” ì§€í˜œëª…ì„, ë°œëª…ì˜ ìˆ˜',
    'í‰ â€” ê³µí—ˆë¬´ì‹¤, ê³ í†µì˜ ìˆ˜',
    'í‰ â€” ìµœê·¹ì‡ ìš´, ì•”í‘ì˜ ìˆ˜',
    'ê¸¸ â€” ì„ ê¸¸í›„í‰, ê²½ì†”ì˜ ìˆ˜',
    'í‰ â€” í¬ë¹„ìŒê´€, ë¬´ë ¥ì˜ ìˆ˜',
    'í‰ â€” ë¬´ë ¥ê³ ë…, í‰ì¬ì˜ ìˆ˜',
    'í‰ â€” í›„ë³µì „í‰, ë³€í™”ì˜ ìˆ˜',
    'í‰ â€” ë°˜ê¸¸ë°˜í‰, ê´€ì¬ì˜ ìˆ˜',
    'í‰ â€” ì „í‰í›„ê¸¸, ë§Œë…„í–‰ë³µì˜ ìˆ˜',
    'ê¸¸ â€” ë¯¸ìš°ê²¸ë¹„, ì‚¬ì—…ì„±ê³µì˜ ìˆ˜',
    'í‰ â€” ì¢…êµ­ë¹„ì• , ê³¤ë€ì˜ ìˆ˜',
    'í‰ â€” ì§„í‡´ë¬´ì‚¬, ê·€ì¸ë¶€ì¬ì˜ ìˆ˜',
    'ê¸¸ â€” ìˆœí’ëŒ€ê¸¸, ë§Œì‚¬í˜•í†µì˜ ìˆ˜'
];

function renderNameAnalysis(name, dayGanIdx, elements) {
    const section = document.getElementById('nameContent');
    if (!name || name.length < 2) {
        section.innerHTML = `<div style="text-align:center;color:var(--text-muted);padding:30px;">ì´ë¦„ì„ ì…ë ¥í•˜ë©´ ì„±ëª…í•™ ë¶„ì„ì´ í‘œì‹œë©ë‹ˆë‹¤.</div>`;
        return;
    }
    const strokes = getNameStrokes(name);
    const totalStrokes = strokes.reduce((a, b) => a + b, 0);

    // ì›í˜•ì´ì • (ì²œê²©, ì¸ê²©, ì§€ê²©, ì™¸ê²©, ì´ê²©) ê³„ì‚°
    let cheonGyeok, inGyeok, jiGyeok, oeGyeok, chongGyeok;
    if (name.length === 2) {
        cheonGyeok = strokes[0] + 1;
        inGyeok = strokes[0] + strokes[1];
        jiGyeok = strokes[1] + 1;
        oeGyeok = 2;
        chongGyeok = totalStrokes;
    } else if (name.length === 3) {
        cheonGyeok = strokes[0] + strokes[1];
        inGyeok = strokes[1] + strokes[2];
        jiGyeok = strokes[2] + 1;
        oeGyeok = strokes[0] + 1;
        chongGyeok = totalStrokes;
    } else {
        cheonGyeok = strokes[0] + strokes[1];
        inGyeok = strokes[1] + strokes[2];
        jiGyeok = strokes[2] + (strokes[3] || 0);
        oeGyeok = strokes[0] + (strokes[3] || 0);
        chongGyeok = totalStrokes;
    }

    const NAME_FIVE = ['ëª©(æœ¨)','í™”(ç«)','í† (åœŸ)','ê¸ˆ(é‡‘)','ìˆ˜(æ°´)'];
    const nameElFn = (n) => { const m = n % 10; if (m === 1 || m === 2) return 0; if (m === 3 || m === 4) return 1; if (m === 5 || m === 6) return 2; if (m === 7 || m === 8) return 3; return 4; };

    const cheonEl = nameElFn(cheonGyeok);
    const inEl = nameElFn(inGyeok);
    const jiEl = nameElFn(jiGyeok);
    const oeEl = nameElFn(oeGyeok);
    const chongEl = nameElFn(chongGyeok);

    const suriIdx81 = (n) => { let v = n % 81; return v === 0 ? 81 : v; };
    const getSuriResult = (n) => {
        const idx = suriIdx81(n);
        return SURI_81[idx] || 'í‰ â€” ë³´í†µ';
    };
    const isGil = (n) => getSuriResult(n).startsWith('ê¸¸') || getSuriResult(n).startsWith('ëŒ€ê¸¸');

    // ìƒìƒ/ìƒê·¹ ê´€ê³„
    const SANG_SAENG = [[0,1],[1,2],[2,3],[3,4],[4,0]]; // ëª©â†’í™”, í™”â†’í† , í† â†’ê¸ˆ, ê¸ˆâ†’ìˆ˜, ìˆ˜â†’ëª©
    const isRelGood = (a, b) => {
        if (a === b) return true;
        return SANG_SAENG.some(([x, y]) => (x === a && y === b) || (x === b && y === a));
    };

    const inJiRel = isRelGood(inEl, jiEl);
    const cheonInRel = isRelGood(cheonEl, inEl);
    const overallGil = [isGil(cheonGyeok), isGil(inGyeok), isGil(jiGyeok), isGil(chongGyeok)].filter(Boolean).length;

    // ì¼ê°„ ì˜¤í–‰ê³¼ ì´ë¦„ì˜ ì¡°í™”
    const dayEl = CHEONGAN_ELEMENT[dayGanIdx];
    const nameMatchDay = isRelGood(inEl, dayEl);

    let gradeEmoji, gradeText;
    if (overallGil >= 4 && inJiRel && nameMatchDay) { gradeEmoji = 'ğŸŒŸ'; gradeText = 'ëŒ€ê¸¸ (å¤§å‰)'; }
    else if (overallGil >= 3 && inJiRel) { gradeEmoji = 'âœ¨'; gradeText = 'ê¸¸ (å‰)'; }
    else if (overallGil >= 2) { gradeEmoji = 'ğŸ”¸'; gradeText = 'í‰ê¸¸ (å¹³å‰)'; }
    else if (overallGil >= 1) { gradeEmoji = 'ğŸ”¹'; gradeText = 'í‰ (å¹³)'; }
    else { gradeEmoji = 'âš ï¸'; gradeText = 'í‰ (å‡¶)'; }

    let html = `<div style="text-align:center;margin-bottom:20px;">
        <div style="font-size:32px;font-family:'Noto Serif KR',serif;color:var(--gold);letter-spacing:8px;margin-bottom:8px;">${name}</div>
        <div style="font-size:14px;color:var(--text-muted);">ì´ íšìˆ˜: ${totalStrokes}íš (${strokes.map((s,i) => name[i]+':'+s+'íš').join(', ')})</div>
        <div style="font-size:20px;margin-top:12px;">${gradeEmoji} <strong style="color:var(--gold)">${gradeText}</strong></div>
    </div>`;

    // ì˜¤ê²© í‘œì‹œ
    html += `<div class="analysis-grid" style="grid-template-columns:1fr 1fr 1fr;gap:12px;margin-bottom:20px;">`;
    const gyeoks = [
        { name: 'ì²œê²©(å¤©æ ¼)', val: cheonGyeok, el: cheonEl, desc: 'ì„ ì²œìš´Â·ì¡°ìƒìš´' },
        { name: 'ì¸ê²©(äººæ ¼)', val: inGyeok, el: inEl, desc: 'ì£¼ìš´Â·ì„±ê²©Â·ì¤‘ë…„ìš´' },
        { name: 'ì§€ê²©(åœ°æ ¼)', val: jiGyeok, el: jiEl, desc: 'ì´ˆë…„ìš´Â·ê¸°ì´ˆìš´' },
        { name: 'ì™¸ê²©(å¤–æ ¼)', val: oeGyeok, el: oeEl, desc: 'ëŒ€ì¸ìš´Â·ì‚¬íšŒìš´' },
        { name: 'ì´ê²©(ç¸½æ ¼)', val: chongGyeok, el: chongEl, desc: 'ì´ìš´Â·í›„ë°˜ìƒ' },
    ];
    gyeoks.forEach(g => {
        const suri = getSuriResult(g.val);
        const gilClass = suri.startsWith('ê¸¸') || suri.startsWith('ëŒ€ê¸¸') ? 'color:var(--wood)' : suri.startsWith('í‰') ? 'color:var(--fire)' : 'color:var(--text-secondary)';
        html += `<div style="background:var(--bg-card);border:1px solid var(--border);border-radius:10px;padding:14px;text-align:center;">
            <div style="font-size:12px;color:var(--text-muted)">${g.name}</div>
            <div style="font-size:24px;font-weight:700;color:var(--gold);margin:4px 0;">${g.val}</div>
            <div style="font-size:11px;color:${ELEMENT_COLORS[g.el]};margin-bottom:4px;">${NAME_FIVE[g.el]}</div>
            <div style="font-size:11px;${gilClass}">${suri.split('â€”')[0].trim()}</div>
            <div style="font-size:10px;color:var(--text-muted);margin-top:4px;">${g.desc}</div>
        </div>`;
    });
    html += `</div>`;

    // ì˜¤í–‰ ì¡°í™” ë¶„ì„
    html += `<div style="background:var(--bg-card);border:1px solid var(--border);border-radius:10px;padding:16px;margin-bottom:12px;">
        <div style="font-weight:600;color:var(--gold);margin-bottom:8px;">ğŸ”„ ì¸ê²©-ì§€ê²© ê´€ê³„</div>
        <div style="font-size:14px;color:var(--text-secondary);">${NAME_FIVE[inEl]} â†’ ${NAME_FIVE[jiEl]}: ${inJiRel ? '<span style="color:var(--wood)">ìƒìƒ ê´€ê³„ (ì¡°í™”ë¡œì›€)</span>' : '<span style="color:var(--fire)">ìƒê·¹ ê´€ê³„ (ê°ˆë“± ì£¼ì˜)</span>'}</div>
    </div>`;
    html += `<div style="background:var(--bg-card);border:1px solid var(--border);border-radius:10px;padding:16px;">
        <div style="font-weight:600;color:var(--gold);margin-bottom:8px;">â˜¯ï¸ ì´ë¦„ê³¼ ì‚¬ì£¼ì˜ ì¡°í™”</div>
        <div style="font-size:14px;color:var(--text-secondary);">ì¼ê°„ ì˜¤í–‰(${ELEMENT_NAMES[dayEl]})ê³¼ ì¸ê²© ì˜¤í–‰(${NAME_FIVE[inEl]}): ${nameMatchDay ? '<span style="color:var(--wood)">ì¡°í™”ë¡œìš´ ê´€ê³„ â€” ì´ë¦„ì´ ì‚¬ì£¼ë¥¼ ë³´ì™„í•©ë‹ˆë‹¤</span>' : '<span style="color:var(--fire)">ë¶ˆì¡°í™” â€” ì´ë¦„ì´ ì‚¬ì£¼ì™€ ì¶©ëŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤</span>'}</div>
    </div>`;

    section.innerHTML = html;
}

// ===== ìˆ˜ë¦¬í•™ (æ•¸ç†å­¸ / Numerology) =====
function renderNumerology(year, month, day, dayGanIdx, elements) {
    const section = document.getElementById('numerologyContent');

    // ìƒëª…ìˆ˜ (Life Path Number) ê³„ì‚°
    const sumDigits = (n) => { let s = 0; while (n > 0) { s += n % 10; n = Math.floor(n / 10); } return s; };
    const reduceToSingle = (n) => { while (n > 9 && n !== 11 && n !== 22 && n !== 33) { n = sumDigits(n); } return n; };
    const lifePathRaw = sumDigits(year) + sumDigits(month) + sumDigits(day);
    const lifePath = reduceToSingle(lifePathRaw);

    // íƒ„ìƒìˆ˜ (Birthday Number)
    const birthdayNum = reduceToSingle(day);

    // íƒœì–‘ìˆ˜ (Year Number)
    const yearNum = reduceToSingle(sumDigits(year));

    // ìš´ëª…ìˆ˜ (Destiny Number) - year+month+day ê°ê° í™˜ì› í›„ í•©ì‚°
    const destinyRaw = reduceToSingle(sumDigits(year)) + reduceToSingle(month) + reduceToSingle(day);
    const destinyNum = reduceToSingle(destinyRaw);

    // ì„±ìˆ™ìˆ˜ (Maturity Number) - lifePath + destiny
    const maturityNum = reduceToSingle(lifePath + destinyNum);

    // 2026 ê°œì¸ë…„ìˆ˜
    const personalYear = reduceToSingle(reduceToSingle(month) + reduceToSingle(day) + reduceToSingle(sumDigits(2026)));

    const NUM_MEANINGS = {
        1: { title: 'ë¦¬ë” / ê°œì²™ì', trait: 'ë…ë¦½ì ì´ê³  ì°½ì˜ì ì¸ ë¦¬ë”ì‹­ì„ ì§€ë‹™ë‹ˆë‹¤. ìƒˆë¡œìš´ ê²ƒì„ ì‹œì‘í•˜ëŠ” í˜ì´ ê°•í•©ë‹ˆë‹¤.', career: 'ê¸°ì—…ê°€, CEO, ë°œëª…ê°€', element: 'í™”(ç«)', color: 'ğŸ”´ ë¹¨ê°•' },
        2: { title: 'ì¡°í™”ì / ì¤‘ì¬ì¸', trait: 'í˜‘ë ¥ê³¼ ì¡°í™”ë¥¼ ì¤‘ì‹œí•˜ë©° ê°ìˆ˜ì„±ì´ ë›°ì–´ë‚©ë‹ˆë‹¤. ì™¸êµì  ëŠ¥ë ¥ì´ ìˆìŠµë‹ˆë‹¤.', career: 'ìƒë‹´ì‚¬, ì™¸êµê´€, ì˜ˆìˆ ê°€', element: 'ìˆ˜(æ°´)', color: 'ğŸŸ  ì£¼í™©' },
        3: { title: 'í‘œí˜„ì / ì†Œí†µê°€', trait: 'ìê¸°í‘œí˜„ì— ë›°ì–´ë‚˜ë©° ì‚¬êµì ì…ë‹ˆë‹¤. ì˜ˆìˆ ì  ì¬ëŠ¥ì´ ìˆìŠµë‹ˆë‹¤.', career: 'ì‘ê°€, ë°°ìš°, ë””ìì´ë„ˆ', element: 'ëª©(æœ¨)', color: 'ğŸŸ¡ ë…¸ë‘' },
        4: { title: 'ê±´ì„¤ì / ì‹¤ì²œê°€', trait: 'ì•ˆì •ê³¼ ì§ˆì„œë¥¼ ì¶”êµ¬í•˜ë©° ì‹¤ìš©ì ì…ë‹ˆë‹¤. ì²´ê³„ì ì¸ ì‚¬ê³ ë¥¼ í•©ë‹ˆë‹¤.', career: 'ê±´ì¶•ê°€, ì—”ì§€ë‹ˆì–´, ê´€ë¦¬ì', element: 'í† (åœŸ)', color: 'ğŸŸ¢ ì´ˆë¡' },
        5: { title: 'ëª¨í—˜ê°€ / ììœ ì¸', trait: 'ë³€í™”ì™€ ëª¨í—˜ì„ ì¦ê¸°ë©° ë‹¤ì¬ë‹¤ëŠ¥í•©ë‹ˆë‹¤. ì—¬í–‰ê³¼ ê²½í—˜ì„ ì¶”êµ¬í•©ë‹ˆë‹¤.', career: 'ì—¬í–‰ê°€, ë§ˆì¼€í„°, ì €ë„ë¦¬ìŠ¤íŠ¸', element: 'ê¸ˆ(é‡‘)', color: 'ğŸ”µ íŒŒë‘' },
        6: { title: 'ë´‰ì‚¬ì / ë³´í˜¸ì', trait: 'ê°€ì •ê³¼ ê³µë™ì²´ë¥¼ ì¤‘ì‹œí•©ë‹ˆë‹¤. ì±…ì„ê°ì´ ê°•í•˜ê³  í—Œì‹ ì ì…ë‹ˆë‹¤.', career: 'ì˜ì‚¬, êµì‚¬, ì‚¬íšŒë³µì§€ì‚¬', element: 'í† (åœŸ)', color: 'ğŸ’œ ë‚¨ìƒ‰' },
        7: { title: 'íƒêµ¬ì / ë¶„ì„ê°€', trait: 'ê¹Šì€ ì‚¬ìƒ‰ê³¼ ë¶„ì„ì„ ì¦ê¹ë‹ˆë‹¤. ì˜ì Â·ì§€ì  íƒêµ¬ì‹¬ì´ ê°•í•©ë‹ˆë‹¤.', career: 'ì—°êµ¬ì›, ì² í•™ì, í”„ë¡œê·¸ë˜ë¨¸', element: 'ìˆ˜(æ°´)', color: 'ğŸŸ£ ë³´ë¼' },
        8: { title: 'ê²½ì˜ì / ì„±ì·¨ê°€', trait: 'ë¬¼ì§ˆì  ì„±ê³µê³¼ ê¶Œë ¥ì— ê°•í•©ë‹ˆë‹¤. ì‚¬ì—… ìˆ˜ì™„ì´ ë›°ì–´ë‚©ë‹ˆë‹¤.', career: 'ì‚¬ì—…ê°€, ê¸ˆìœµì¸, ë³€í˜¸ì‚¬', element: 'ê¸ˆ(é‡‘)', color: 'ğŸ©· ë¶„í™' },
        9: { title: 'ì¸ë„ì£¼ì˜ì / ì™„ì„±ì', trait: 'ë°•ì• ì™€ ì´ìƒì„ ì¶”êµ¬í•©ë‹ˆë‹¤. ë„“ì€ ì‹œì•¼ì™€ ë†’ì€ ì´ìƒì´ ìˆìŠµë‹ˆë‹¤.', career: 'ì˜ˆìˆ ê°€, NGOí™œë™ê°€, ì¹˜ë£Œì‚¬', element: 'í™”(ç«)', color: 'ğŸ¤ í°ìƒ‰' },
        11: { title: 'ì˜ê°ì˜ ë§ˆìŠ¤í„°', trait: 'ì§ê´€ë ¥ê³¼ ì˜ì  ê°ìˆ˜ì„±ì´ íŠ¹ë³„í•©ë‹ˆë‹¤. ë§ˆìŠ¤í„° ë„˜ë²„ë¡œ ë†’ì€ ì ì¬ë ¥ì„ ê°€ì§‘ë‹ˆë‹¤.', career: 'ì˜ì  ì§€ë„ì, ì˜ˆìˆ ê°€, ë°œëª…ê°€', element: 'ìˆ˜(æ°´)', color: 'âœ¨ ì€ìƒ‰' },
        22: { title: 'ê±´ì¶•ì˜ ë§ˆìŠ¤í„°', trait: 'í° ê¿ˆì„ í˜„ì‹¤ë¡œ ë§Œë“œëŠ” ëŠ¥ë ¥ì´ ìˆìŠµë‹ˆë‹¤. ë§ˆìŠ¤í„° ë„˜ë²„ë¡œ ëŒ€ê·œëª¨ í”„ë¡œì íŠ¸ì— ì í•©í•©ë‹ˆë‹¤.', career: 'ëŒ€ê¸°ì—… ê²½ì˜, êµ­ì œê¸°êµ¬, ê±´ì¶•ê°€', element: 'í† (åœŸ)', color: 'ğŸ¥‡ ê¸ˆìƒ‰' },
        33: { title: 'ì¹˜ìœ ì˜ ë§ˆìŠ¤í„°', trait: 'ìµœê³  ìˆ˜ì¤€ì˜ ë§ˆìŠ¤í„° ë„˜ë²„ì…ë‹ˆë‹¤. ì¸ë¥˜ë¥¼ ìœ„í•œ ë´‰ì‚¬ì™€ ì¹˜ìœ ì˜ ì‚¬ëª…ì´ ìˆìŠµë‹ˆë‹¤.', career: 'ì¹˜ìœ ì‚¬, ì¢…êµ ì§€ë„ì, êµìœ¡ì', element: 'ëª©(æœ¨)', color: 'ğŸ’ ë‹¤ì´ì•„ëª¬ë“œ' },
    };

    const PY_MEANINGS = {
        1: 'ìƒˆë¡œìš´ ì‹œì‘ì˜ í•´ â€” ìƒˆ í”„ë¡œì íŠ¸, ìƒˆ ê´€ê³„ê°€ ì—´ë¦¬ëŠ” ì‹œê¸°ì…ë‹ˆë‹¤.',
        2: 'ì¸ë‚´ì™€ í˜‘ë ¥ì˜ í•´ â€” ê´€ê³„ë¥¼ ë‹¤ì§€ê³  ê¸°ë‹¤ë¦¼ì´ í•„ìš”í•œ ì‹œê¸°ì…ë‹ˆë‹¤.',
        3: 'ìê¸°í‘œí˜„ì˜ í•´ â€” ì°½ì˜ì„±ì´ í­ë°œí•˜ê³  ì‚¬êµê°€ í™œë°œí•´ì§‘ë‹ˆë‹¤.',
        4: 'ê¸°ë°˜ ë‹¤ì§€ê¸°ì˜ í•´ â€” ë…¸ë ¥ê³¼ ì ˆì œë¡œ í† ëŒ€ë¥¼ ë§Œë“œëŠ” ì‹œê¸°ì…ë‹ˆë‹¤.',
        5: 'ë³€í™”ì™€ ì „í™˜ì˜ í•´ â€” ì—¬í–‰, ì´ì‚¬, ì „í™˜ì ì´ ì°¾ì•„ì˜µë‹ˆë‹¤.',
        6: 'ê°€ì •ê³¼ ì±…ì„ì˜ í•´ â€” ê°€ì¡±, ê²°í˜¼, ë¶€ë™ì‚°ì— ë³€í™”ê°€ ìˆìŠµë‹ˆë‹¤.',
        7: 'ì„±ì°°ê³¼ íƒêµ¬ì˜ í•´ â€” ë‚´ë©´ì„ ëŒì•„ë³´ê³  ê³µë¶€ì— ì¢‹ì€ ì‹œê¸°ì…ë‹ˆë‹¤.',
        8: 'ì„±ì·¨ì™€ ìˆ˜í™•ì˜ í•´ â€” ê·¸ë™ì•ˆì˜ ë…¸ë ¥ì´ ê²°ì‹¤ì„ ë§ºìŠµë‹ˆë‹¤.',
        9: 'ì™„ì„±ê³¼ ì •ë¦¬ì˜ í•´ â€” í•œ ì£¼ê¸°ê°€ ë§ˆë¬´ë¦¬ë˜ë©° ë¹„ì›€ì´ í•„ìš”í•©ë‹ˆë‹¤.',
        11: 'ì˜ê°ì˜ í•´ â€” ì§ê´€ì´ ê°•í•´ì§€ê³  ì˜ì  ì„±ì¥ì´ ì¼ì–´ë‚©ë‹ˆë‹¤.',
        22: 'ëŒ€ì„±ì·¨ì˜ í•´ â€” í° í”„ë¡œì íŠ¸ê°€ í˜„ì‹¤í™”ë©ë‹ˆë‹¤.',
        33: 'ë´‰ì‚¬ì˜ í•´ â€” íƒ€ì¸ì„ ìœ„í•œ í—Œì‹ ì´ ë¹›ë‚˜ëŠ” ì‹œê¸°ì…ë‹ˆë‹¤.',
    };

    const lpData = NUM_MEANINGS[lifePath] || NUM_MEANINGS[lifePath > 9 ? sumDigits(lifePath) : lifePath] || NUM_MEANINGS[1];
    const pyData = PY_MEANINGS[personalYear] || PY_MEANINGS[personalYear > 9 ? sumDigits(personalYear) : personalYear] || PY_MEANINGS[1];

    let html = `<div style="text-align:center;margin-bottom:20px;">
        <div style="font-size:48px;font-weight:900;color:var(--gold);font-family:'Noto Serif KR',serif;">${lifePath}</div>
        <div style="font-size:14px;color:var(--text-muted);">ë‹¹ì‹ ì˜ ìƒëª…ìˆ˜ (Life Path Number)</div>
        <div style="font-size:18px;color:var(--gold-light);margin-top:6px;font-weight:600;">${lpData.title}</div>
    </div>`;

    html += `<div style="background:var(--bg-card);border:1px solid var(--border);border-radius:10px;padding:16px;margin-bottom:16px;">
        <div style="font-size:14px;color:var(--text-secondary);line-height:1.7;">${lpData.trait}</div>
        <div style="margin-top:10px;font-size:13px;">
            <span style="color:var(--text-muted)">ì í•© ì§ì—…:</span> <span style="color:var(--text-secondary)">${lpData.career}</span><br>
            <span style="color:var(--text-muted)">ëŒ€ì‘ ì˜¤í–‰:</span> <span style="color:var(--text-secondary)">${lpData.element}</span> Â·
            <span style="color:var(--text-muted)">í–‰ìš´ ìƒ‰ìƒ:</span> <span style="color:var(--text-secondary)">${lpData.color}</span>
        </div>
    </div>`;

    // í•µì‹¬ ìˆ˜ë¦¬ í…Œì´ë¸”
    html += `<div class="analysis-grid" style="grid-template-columns:1fr 1fr 1fr;gap:10px;margin-bottom:16px;">`;
    const nums = [
        { label: 'íƒ„ìƒìˆ˜', val: birthdayNum, desc: 'ê¸°ë³¸ ì„±í–¥' },
        { label: 'ìš´ëª…ìˆ˜', val: destinyNum, desc: 'ì¸ìƒ ëª©í‘œ' },
        { label: 'ì„±ìˆ™ìˆ˜', val: maturityNum, desc: 'í›„ë°˜ê¸° ìš´' },
    ];
    nums.forEach(n => {
        const nd = NUM_MEANINGS[n.val] || NUM_MEANINGS[n.val > 9 ? sumDigits(n.val) : n.val] || NUM_MEANINGS[1];
        html += `<div style="background:var(--bg-card);border:1px solid var(--border);border-radius:10px;padding:14px;text-align:center;">
            <div style="font-size:11px;color:var(--text-muted)">${n.label}</div>
            <div style="font-size:28px;font-weight:700;color:var(--gold);margin:4px 0;">${n.val}</div>
            <div style="font-size:12px;color:var(--text-secondary)">${nd.title}</div>
            <div style="font-size:10px;color:var(--text-muted);margin-top:2px;">${n.desc}</div>
        </div>`;
    });
    html += `</div>`;

    // 2026 ê°œì¸ë…„ìˆ˜
    html += `<div style="background:var(--bg-card);border:1px solid var(--border);border-radius:10px;padding:16px;">
        <div style="font-weight:600;color:var(--gold);margin-bottom:8px;">ğŸ“… 2026ë…„ ê°œì¸ë…„ìˆ˜: <span style="font-size:22px;">${personalYear}</span></div>
        <div style="font-size:14px;color:var(--text-secondary);line-height:1.6;">${pyData}</div>
    </div>`;

    section.innerHTML = html;
}

// ===== ì ì„±í•™ (å æ˜Ÿå­¸ / Western Astrology) =====
function renderAstrology(month, day, year, gender, dayGanIdx, elements) {
    const section = document.getElementById('astrologyContent');

    // ë³„ìë¦¬ ê³„ì‚°
    const ZODIAC = [
        { name: 'ë¬¼ë³‘ìë¦¬', symbol: 'â™’', hanja: 'å¯¶ç”å®®', start: [1,20], end: [2,18], element: 'ë°”ëŒ', ruling: 'ì²œì™•ì„±(Uranus)', trait: 'ë…ì°½ì ì´ê³  ì¸ë„ì£¼ì˜ì ì´ë©° ì§„ë³´ì ì¸ ì‚¬ê³ ë¥¼ ê°€ì§‘ë‹ˆë‹¤. ììœ ë¥¼ ì‚¬ë‘í•˜ê³  ë…ë¦½ì‹¬ì´ ê°•í•©ë‹ˆë‹¤.', love: 'ì§€ì  êµê°ì„ ì¤‘ì‹œí•˜ë©° ììœ ë¡œìš´ ê´€ê³„ë¥¼ ì›í•©ë‹ˆë‹¤.', career: 'ê³¼í•™, IT, ë°œëª…, ì‚¬íšŒìš´ë™', lucky: 'í† ìš”ì¼', color: 'íŒŒë‘', num: '4, 7, 11' },
        { name: 'ë¬¼ê³ ê¸°ìë¦¬', symbol: 'â™“', hanja: 'é›™é­šå®®', start: [2,19], end: [3,20], element: 'ë¬¼', ruling: 'í•´ì™•ì„±(Neptune)', trait: 'ì§ê´€ì ì´ê³  ê°ì„±ì´ í’ë¶€í•˜ë©° ì˜ˆìˆ ì  ì¬ëŠ¥ì´ ë›°ì–´ë‚©ë‹ˆë‹¤. ê³µê° ëŠ¥ë ¥ì´ ë†’ìŠµë‹ˆë‹¤.', love: 'ë¡œë§¨í‹±í•˜ê³  í—Œì‹ ì ì´ë©° ìƒëŒ€ë¥¼ ê¹Šì´ ì´í•´í•©ë‹ˆë‹¤.', career: 'ì˜ˆìˆ , ìŒì•…, ì‹¬ë¦¬í•™, ì¢…êµ', lucky: 'ëª©ìš”ì¼', color: 'ë°”ë‹¤ìƒ‰', num: '3, 9, 12' },
        { name: 'ì–‘ìë¦¬', symbol: 'â™ˆ', hanja: 'ç™½ç¾Šå®®', start: [3,21], end: [4,19], element: 'ë¶ˆ', ruling: 'í™”ì„±(Mars)', trait: 'ìš©ê°í•˜ê³  ì—´ì •ì ì´ë©° ê°œì²™ì •ì‹ ì´ ê°•í•©ë‹ˆë‹¤. ë¦¬ë”ì‹­ì´ ìˆê³  ê²°ë‹¨ë ¥ì´ ë›°ì–´ë‚©ë‹ˆë‹¤.', love: 'ì—´ì •ì ì´ê³  ì§ì§„í˜•ì´ë©° ì ê·¹ì ìœ¼ë¡œ ì‚¬ë‘ì„ í‘œí˜„í•©ë‹ˆë‹¤.', career: 'êµ°ì¸, ìš´ë™ì„ ìˆ˜, ê¸°ì—…ê°€, ì™¸ê³¼ì˜', lucky: 'í™”ìš”ì¼', color: 'ë¹¨ê°•', num: '1, 8, 17' },
        { name: 'í™©ì†Œìë¦¬', symbol: 'â™‰', hanja: 'é‡‘ç‰›å®®', start: [4,20], end: [5,20], element: 'ë•…', ruling: 'ê¸ˆì„±(Venus)', trait: 'ì•ˆì •ì ì´ê³  ì‹ ë¢°í•  ìˆ˜ ìˆìœ¼ë©° ì¸ë‚´ì‹¬ì´ ê°•í•©ë‹ˆë‹¤. ê°ê°ì  ì¦ê±°ì›€ì„ ì¶”êµ¬í•©ë‹ˆë‹¤.', love: 'í•œë²ˆ ì‚¬ë‘í•˜ë©´ ê¹Šê³  ì˜¤ë˜ê°€ë©° ì¶©ì„±ìŠ¤ëŸ½ìŠµë‹ˆë‹¤.', career: 'ê¸ˆìœµ, ìš”ë¦¬ì‚¬, ê±´ì¶•, ë†ì—…', lucky: 'ê¸ˆìš”ì¼', color: 'ì´ˆë¡', num: '2, 6, 9' },
        { name: 'ìŒë‘¥ì´ìë¦¬', symbol: 'â™Š', hanja: 'é›™å­å®®', start: [5,21], end: [6,21], element: 'ë°”ëŒ', ruling: 'ìˆ˜ì„±(Mercury)', trait: 'í˜¸ê¸°ì‹¬ì´ ì™•ì„±í•˜ê³  ì†Œí†µ ëŠ¥ë ¥ì´ ë›°ì–´ë‚©ë‹ˆë‹¤. ë‹¤ì¬ë‹¤ëŠ¥í•˜ê³  ì ì‘ë ¥ì´ ê°•í•©ë‹ˆë‹¤.', love: 'ëŒ€í™”ê°€ ì˜ í†µí•˜ëŠ” ìƒëŒ€ë¥¼ ì›í•˜ë©° ì§€ì  ìê·¹ì„ ì¶”êµ¬í•©ë‹ˆë‹¤.', career: 'ì‘ê°€, ê¸°ì, í†µì—­, ë§ˆì¼€íŒ…', lucky: 'ìˆ˜ìš”ì¼', color: 'ë…¸ë‘', num: '5, 7, 14' },
        { name: 'ê²Œìë¦¬', symbol: 'â™‹', hanja: 'å·¨èŸ¹å®®', start: [6,22], end: [7,22], element: 'ë¬¼', ruling: 'ë‹¬(Moon)', trait: 'ê°ìˆ˜ì„±ì´ í’ë¶€í•˜ê³  ê°€ì •ì ì´ë©° ë³´í˜¸ë³¸ëŠ¥ì´ ê°•í•©ë‹ˆë‹¤. ì§ê°ë ¥ì´ ë›°ì–´ë‚©ë‹ˆë‹¤.', love: 'í—Œì‹ ì ì´ê³  ê°€ì •ì„ ì†Œì¤‘íˆ ì—¬ê¸°ë©° ê¹Šì€ ì •ì„ ì¤ë‹ˆë‹¤.', career: 'ìš”ë¦¬, ê°„í˜¸, ë¶€ë™ì‚°, ì—­ì‚¬í•™', lucky: 'ì›”ìš”ì¼', color: 'ì€ìƒ‰', num: '2, 7, 11' },
        { name: 'ì‚¬ììë¦¬', symbol: 'â™Œ', hanja: 'ç…å­å®®', start: [7,23], end: [8,22], element: 'ë¶ˆ', ruling: 'íƒœì–‘(Sun)', trait: 'ìì‹ ê°ì´ ë„˜ì¹˜ê³  ì¹´ë¦¬ìŠ¤ë§ˆê°€ ìˆìœ¼ë©° ê´€ëŒ€í•©ë‹ˆë‹¤. ë¬´ëŒ€ ìœ„ì—ì„œ ë¹›ë‚˜ëŠ” íƒ€ì…ì…ë‹ˆë‹¤.', love: 'í™”ë ¤í•˜ê³  ë“œë¼ë§ˆí‹±í•œ ì‚¬ë‘ì„ ì¶”êµ¬í•˜ë©° ì¶©ì„±ìŠ¤ëŸ½ìŠµë‹ˆë‹¤.', career: 'ì—°ì˜ˆì¸, CEO, ì •ì¹˜ì¸, ë””ìì´ë„ˆ', lucky: 'ì¼ìš”ì¼', color: 'ê¸ˆìƒ‰', num: '1, 3, 10' },
        { name: 'ì²˜ë…€ìë¦¬', symbol: 'â™', hanja: 'è™•å¥³å®®', start: [8,23], end: [9,22], element: 'ë•…', ruling: 'ìˆ˜ì„±(Mercury)', trait: 'ë¶„ì„ì ì´ê³  ê¼¼ê¼¼í•˜ë©° ì™„ë²½ì£¼ì˜ì ì…ë‹ˆë‹¤. ì‹¤ìš©ì ì´ê³  ë´‰ì‚¬ì •ì‹ ì´ ìˆìŠµë‹ˆë‹¤.', love: 'ì‹ ì¤‘í•˜ê³  ì„¸ì‹¬í•˜ê²Œ ì‚¬ë‘ì„ í‘œí˜„í•˜ë©° ì§„ì‹¤ëœ ê´€ê³„ë¥¼ ì¶”êµ¬í•©ë‹ˆë‹¤.', career: 'ì˜ì‚¬, íšŒê³„ì‚¬, í¸ì§‘ì, ì—°êµ¬ì›', lucky: 'ìˆ˜ìš”ì¼', color: 'ë² ì´ì§€', num: '5, 14, 23' },
        { name: 'ì²œì¹­ìë¦¬', symbol: 'â™', hanja: 'å¤©ç§¤å®®', start: [9,23], end: [10,23], element: 'ë°”ëŒ', ruling: 'ê¸ˆì„±(Venus)', trait: 'ì¡°í™”ì™€ ê· í˜•ì„ ì¶”êµ¬í•˜ë©° ì‹¬ë¯¸ì•ˆì´ ë›°ì–´ë‚©ë‹ˆë‹¤. ê³µì •í•˜ê³  ì‚¬êµì ì…ë‹ˆë‹¤.', love: 'íŒŒíŠ¸ë„ˆì‹­ì„ ì¤‘ì‹œí•˜ë©° ì•„ë¦„ë‹¤ìš´ ê´€ê³„ë¥¼ ë§Œë“¤ì–´ê°‘ë‹ˆë‹¤.', career: 'ë²•ë¥ , ë””ìì¸, ì™¸êµ, ì˜ˆìˆ ', lucky: 'ê¸ˆìš”ì¼', color: 'ë¶„í™', num: '4, 6, 13' },
        { name: 'ì „ê°ˆìë¦¬', symbol: 'â™', hanja: 'å¤©èå®®', start: [10,24], end: [11,22], element: 'ë¬¼', ruling: 'ëª…ì™•ì„±(Pluto)', trait: 'ê¹Šì€ í†µì°°ë ¥ê³¼ ê°•í•œ ì˜ì§€ë¥¼ ê°€ì¡ŒìŠµë‹ˆë‹¤. ë¹„ë°€ìŠ¤ëŸ½ê³  ë³€í˜ì ì…ë‹ˆë‹¤.', love: 'ê°•ë ¬í•˜ê³  ê¹Šì€ ì‚¬ë‘ì„ í•˜ë©° ì§ˆíˆ¬ì‹¬ë„ ê°•í•©ë‹ˆë‹¤.', career: 'ì‹¬ë¦¬í•™, ìˆ˜ì‚¬ê´€, ì™¸ê³¼ì˜, ì—°êµ¬ì', lucky: 'í™”ìš”ì¼', color: 'ê²€ì •/ì§„í™', num: '8, 11, 18' },
        { name: 'ì‚¬ìˆ˜ìë¦¬', symbol: 'â™', hanja: 'å°„æ‰‹å®®', start: [11,23], end: [12,21], element: 'ë¶ˆ', ruling: 'ëª©ì„±(Jupiter)', trait: 'ë‚™ê´€ì ì´ê³  ëª¨í—˜ì‹¬ì´ ê°•í•˜ë©° ì² í•™ì ì…ë‹ˆë‹¤. ììœ ë¥¼ ì‚¬ë‘í•˜ê³  íƒêµ¬ì‹¬ì´ ì™•ì„±í•©ë‹ˆë‹¤.', love: 'ììœ ë¡œìš´ ê´€ê³„ë¥¼ ì›í•˜ë©° ì •ì‹ ì  êµê°ì„ ì¤‘ì‹œí•©ë‹ˆë‹¤.', career: 'êµìˆ˜, ì—¬í–‰ê°€, ì¶œíŒ, ì¢…êµì¸', lucky: 'ëª©ìš”ì¼', color: 'ë³´ë¼', num: '3, 7, 9' },
        { name: 'ì—¼ì†Œìë¦¬', symbol: 'â™‘', hanja: 'ç£¨ç¾¯å®®', start: [12,22], end: [1,19], element: 'ë•…', ruling: 'í† ì„±(Saturn)', trait: 'ì•¼ì‹¬ì°¨ê³  ê·¼ë©´í•˜ë©° í˜„ì‹¤ì ì…ë‹ˆë‹¤. ëª©í‘œë¥¼ í–¥í•´ ê¾¸ì¤€íˆ ë‚˜ì•„ê°‘ë‹ˆë‹¤.', love: 'ì§„ì§€í•˜ê³  ì‹ ì¤‘í•œ ì—°ì• ë¥¼ í•˜ë©° ê²°í˜¼ì„ ëª©í‘œë¡œ í•©ë‹ˆë‹¤.', career: 'ê²½ì˜ì, ê³µë¬´ì›, ê±´ì¶•ê°€, ì •ì¹˜ì¸', lucky: 'í† ìš”ì¼', color: 'ê°ˆìƒ‰/ê²€ì •', num: '1, 4, 8' },
    ];

    let zodiac = null;
    for (const z of ZODIAC) {
        const [sm, sd] = z.start;
        const [em, ed] = z.end;
        if (sm <= em) {
            if ((month === sm && day >= sd) || (month === em && day <= ed) || (month > sm && month < em)) { zodiac = z; break; }
        } else {
            if ((month === sm && day >= sd) || (month === em && day <= ed) || month > sm || month < em) { zodiac = z; break; }
        }
    }
    if (!zodiac) zodiac = ZODIAC[0];

    // ì‚¬ì£¼ ì˜¤í–‰ê³¼ ì ì„± ì›ì†Œ ë§¤í•‘
    const ASTRO_ELEMENT_MAP = { 'ë¶ˆ': 'í™”(ç«)', 'ë•…': 'í† (åœŸ)', 'ë°”ëŒ': 'ëª©(æœ¨)', 'ë¬¼': 'ìˆ˜(æ°´)' };
    const sajuMatch = ASTRO_ELEMENT_MAP[zodiac.element];

    // í–‰ì„± ìœ„ì¹˜ (ê°„ë‹¨ ê³„ì‚° - ì¶œìƒë…„ë„ ê¸°ë°˜ ê·¼ì‚¬)
    const planets = [
        { name: 'ëª©ì„±', symbol: 'â™ƒ', cycle: 11.86, desc: 'í™•ì¥Â·í–‰ìš´' },
        { name: 'í† ì„±', symbol: 'â™„', cycle: 29.46, desc: 'ì‹œë ¨Â·ì„±ìˆ™' },
    ];
    const getApproxSign = (year, cycle) => {
        const base = 2000;
        const offset = ((year - base) / cycle) % 12;
        const idx = Math.floor(((offset % 12) + 12) % 12);
        return ZODIAC[idx].name;
    };

    let html = `<div style="text-align:center;margin-bottom:20px;">
        <div style="font-size:56px;margin-bottom:4px;">${zodiac.symbol}</div>
        <div style="font-size:24px;font-weight:700;color:var(--gold);font-family:'Noto Serif KR',serif;">${zodiac.name}</div>
        <div style="font-size:13px;color:var(--text-muted);margin-top:4px;">${zodiac.hanja} Â· ${zodiac.element} ì›ì†Œ Â· ${zodiac.ruling}</div>
    </div>`;

    html += `<div style="background:var(--bg-card);border:1px solid var(--border);border-radius:10px;padding:16px;margin-bottom:12px;">
        <div style="font-weight:600;color:var(--gold);margin-bottom:8px;">ğŸŒŸ í•µì‹¬ ì„±ê²©</div>
        <div style="font-size:14px;color:var(--text-secondary);line-height:1.7;">${zodiac.trait}</div>
    </div>`;

    html += `<div class="analysis-grid" style="gap:12px;margin-bottom:12px;">
        <div style="background:var(--bg-card);border:1px solid var(--border);border-radius:10px;padding:14px;">
            <div style="font-weight:600;color:var(--gold);margin-bottom:6px;">â¤ï¸ ì—°ì•  ì„±í–¥</div>
            <div style="font-size:13px;color:var(--text-secondary);line-height:1.6;">${zodiac.love}</div>
        </div>
        <div style="background:var(--bg-card);border:1px solid var(--border);border-radius:10px;padding:14px;">
            <div style="font-weight:600;color:var(--gold);margin-bottom:6px;">ğŸ’¼ ì í•© ì§ì—…</div>
            <div style="font-size:13px;color:var(--text-secondary);line-height:1.6;">${zodiac.career}</div>
        </div>
    </div>`;

    html += `<div class="analysis-grid" style="grid-template-columns:1fr 1fr 1fr;gap:10px;margin-bottom:16px;">
        <div style="background:var(--bg-card);border:1px solid var(--border);border-radius:10px;padding:12px;text-align:center;">
            <div style="font-size:11px;color:var(--text-muted)">í–‰ìš´ì˜ ìš”ì¼</div>
            <div style="font-size:16px;color:var(--gold);margin-top:4px;">${zodiac.lucky}</div>
        </div>
        <div style="background:var(--bg-card);border:1px solid var(--border);border-radius:10px;padding:12px;text-align:center;">
            <div style="font-size:11px;color:var(--text-muted)">í–‰ìš´ì˜ ìƒ‰ìƒ</div>
            <div style="font-size:16px;color:var(--gold);margin-top:4px;">${zodiac.color}</div>
        </div>
        <div style="background:var(--bg-card);border:1px solid var(--border);border-radius:10px;padding:12px;text-align:center;">
            <div style="font-size:11px;color:var(--text-muted)">í–‰ìš´ì˜ ìˆ«ì</div>
            <div style="font-size:16px;color:var(--gold);margin-top:4px;">${zodiac.num}</div>
        </div>
    </div>`;

    // ì‚¬ì£¼-ì ì„± ìœµí•© ë¶„ì„
    html += `<div style="background:var(--bg-card);border:1px solid var(--border);border-radius:10px;padding:16px;">
        <div style="font-weight:600;color:var(--gold);margin-bottom:8px;">â˜¯ï¸ ì‚¬ì£¼-ì ì„± ìœµí•© ë¶„ì„</div>
        <div style="font-size:13px;color:var(--text-secondary);line-height:1.7;">
            ì ì„±í•™ ì›ì†Œ <strong>${zodiac.element}</strong>(${sajuMatch})ê³¼ ì¼ê°„ ì˜¤í–‰ <strong>${ELEMENT_NAMES[CHEONGAN_ELEMENT[dayGanIdx]]}</strong>ì˜ ê´€ê³„ë¥¼ í†µí•´ ë³´ë©´,
            ${sajuMatch === ELEMENT_NAMES[CHEONGAN_ELEMENT[dayGanIdx]] ? 'ë™ì¼í•œ ì›ì†Œë¡œ í•´ë‹¹ ê¸°ì§ˆì´ ë§¤ìš° ê°•í•˜ê²Œ ë‚˜íƒ€ë‚©ë‹ˆë‹¤. ê·¸ ì—ë„ˆì§€ê°€ ê³¼í•  ìˆ˜ ìˆìœ¼ë‹ˆ ë°˜ëŒ€ ì›ì†Œë¡œ ê· í˜•ì„ ë§ì¶”ì„¸ìš”.' : 'ì„œë¡œ ë‹¤ë¥¸ ì›ì†Œê°€ ë§Œë‚˜ ë‹¤ì–‘í•œ ë©´ëª¨ë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤. ë™ì„œì–‘ ìš´ëª…í•™ ëª¨ë‘ì—ì„œ ë‹¤ì±„ë¡œìš´ ê°€ëŠ¥ì„±ì„ ì§€ë‹Œ ê²ƒìœ¼ë¡œ í•´ì„ë©ë‹ˆë‹¤.'}
        </div>
    </div>`;

    section.innerHTML = html;
}

// ===== ìë¯¸ë‘ìˆ˜ (ç´«å¾®æ–—æ•¸) =====
function renderZiWei(yearP, monthP, dayP, hourP, gender, elements, birthYear) {
    const section = document.getElementById('ziWeiContent');

    // ìë¯¸ë‘ìˆ˜ ì£¼ì„±(ä¸»æ˜Ÿ) 14ê°œ
    const ZI_WEI_STARS = [
        { name: 'ìë¯¸ì„±', hanja: 'ç´«å¾®', desc: 'ì œì™•ì˜ ë³„ â€” ë¦¬ë”ì‹­, ì¡´ì—„, í†µì†”ë ¥', trait: 'ê³ ê·€í•œ ê¸°í’ˆê³¼ í†µì†”ë ¥ì„ ê°€ì§€ë©° íƒ€ì¸ì„ ì´ë„ëŠ” ëŠ¥ë ¥ì´ ìˆìŠµë‹ˆë‹¤.' },
        { name: 'ì²œê¸°ì„±', hanja: 'å¤©æ©Ÿ', desc: 'ì§€í˜œì˜ ë³„ â€” ì´ëª…, ê¸°íš, ë³€í†µ', trait: 'ë¨¸ë¦¬ê°€ ë›°ì–´ë‚˜ê³  ê¸°íšë ¥ì´ ì¢‹ìœ¼ë‚˜ ìš°ìœ ë¶€ë‹¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.' },
        { name: 'íƒœì–‘ì„±', hanja: 'å¤ªé™½', desc: 'ê´‘ëª…ì˜ ë³„ â€” ëª…ì˜ˆ, ë°•ì• , ë´‰ì‚¬', trait: 'ë°ê³  í™œë°œí•˜ë©° íƒ€ì¸ì„ ìœ„í•´ í¬ìƒí•˜ëŠ” ë§ˆìŒì´ í½ë‹ˆë‹¤.' },
        { name: 'ë¬´ê³¡ì„±', hanja: 'æ­¦æ›²', desc: 'ì¬ë¬¼ì˜ ë³„ â€” ê²°ë‹¨, ì¬ë¬¼, ë¬´ìš©', trait: 'ê²°ë‹¨ë ¥ì´ ìˆê³  ì¬ë¬¼ ê´€ë¦¬ì— ë›°ì–´ë‚˜ë©° ê°•ì¸í•œ ì˜ì§€ê°€ ìˆìŠµë‹ˆë‹¤.' },
        { name: 'ì²œë™ì„±', hanja: 'å¤©åŒ', desc: 'ë³µë•ì˜ ë³„ â€” ì˜¨í™”, ë‚™ì²œ, ë³µë¡', trait: 'ì„±ê²©ì´ ì˜¨í™”í•˜ê³  ë³µì´ ìˆìœ¼ë‚˜ ê²Œìœ¼ë¥¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.' },
        { name: 'ì—¼ì •ì„±', hanja: 'å»‰è²', desc: 'ê°ì •ì˜ ë³„ â€” ì˜ˆìˆ , ê°ì •, ë³µì¡', trait: 'ì˜ˆìˆ ì  ê°ê°ì´ ë›°ì–´ë‚˜ê³  ê°ì •ì´ í’ë¶€í•˜ì§€ë§Œ ê°ì • ê¸°ë³µì´ í´ ìˆ˜ ìˆìŠµë‹ˆë‹¤.' },
        { name: 'ì²œë¶€ì„±', hanja: 'å¤©åºœ', desc: 'ì¬ê³ ì˜ ë³„ â€” ì•ˆì •, ì¬ë¬¼, ë³´ìˆ˜', trait: 'ì•ˆì •ì„ ì¶”êµ¬í•˜ê³  ì¬ë¬¼ì„ ì˜ ë³´ê´€í•˜ë©° ì‹ ë¢°ë°›ëŠ” ì‚¬ëŒì…ë‹ˆë‹¤.' },
        { name: 'íƒœìŒì„±', hanja: 'å¤ªé™°', desc: 'ë‹¬ì˜ ë³„ â€” ìš°ì•„, ì„¬ì„¸, ì¬ë¬¼', trait: 'ì„¬ì„¸í•˜ê³  ìš°ì•„í•˜ë©° ì¬ë¬¼ìš´ì´ ì¢‹ê³  ë¶€ë™ì‚°ê³¼ ì¸ì—°ì´ ìˆìŠµë‹ˆë‹¤.' },
        { name: 'íƒë‘ì„±', hanja: 'è²ªç‹¼', desc: 'ìš•ë§ì˜ ë³„ â€” ë‹¤ì¬, ë§¤ë ¥, ìš•ì‹¬', trait: 'ë‹¤ì¬ë‹¤ëŠ¥í•˜ê³  ë§¤ë ¥ì ì´ì§€ë§Œ ìš•ì‹¬ì´ ê³¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.' },
        { name: 'ê±°ë¬¸ì„±', hanja: 'å·¨é–€', desc: 'êµ¬ì„¤ì˜ ë³„ â€” ë¶„ì„, ë…¼ìŸ, íƒêµ¬', trait: 'ë¶„ì„ë ¥ì´ ë›°ì–´ë‚˜ê³  ë§ì„ ì˜í•˜ì§€ë§Œ ë…¼ìŸì„ ì¼ìœ¼í‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.' },
        { name: 'ì²œìƒì„±', hanja: 'å¤©ç›¸', desc: 'ì¸ìˆ˜ì˜ ë³„ â€” ë³´ì¢Œ, ê³µì •, êµì œ', trait: 'ê³µì •í•˜ê³  ì‚¬êµì ì´ë©° ë³´ì¢Œ ëŠ¥ë ¥ì´ ë›°ì–´ë‚©ë‹ˆë‹¤.' },
        { name: 'ì²œëŸ‰ì„±', hanja: 'å¤©æ¢', desc: 'ìŒë•ì˜ ë³„ â€” ë³´í˜¸, ì¥ìˆ˜, í•´ê²°', trait: 'ì–´ë ¤ì›€ì„ í•´ê²°í•˜ëŠ” ëŠ¥ë ¥ì´ ìˆê³  ì¥ìˆ˜ì™€ ìŒë•ì˜ ë³µì´ ìˆìŠµë‹ˆë‹¤.' },
        { name: 'ì¹ ì‚´ì„±', hanja: 'ä¸ƒæ®º', desc: 'ì¥êµ°ì˜ ë³„ â€” ê¶Œìœ„, ê²°ë‹¨, ê³ ë…', trait: 'ìœ„ì—„ê³¼ ê²°ë‹¨ë ¥ì´ ìˆìœ¼ë‚˜ ê³ ë…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. êµ°ì¸ì´ë‚˜ ê²½ì°°ì— ì í•©í•©ë‹ˆë‹¤.' },
        { name: 'íŒŒêµ°ì„±', hanja: 'ç ´è»', desc: 'íŒŒê´´ì™€ ì¬ê±´ì˜ ë³„ â€” ë³€í˜, ëª¨í—˜, íŒŒê´´', trait: 'ê¸°ì¡´ì˜ ê²ƒì„ ë¶€ìˆ˜ê³  ìƒˆê²ƒì„ ë§Œë“œëŠ” í˜ì´ ê°•í•©ë‹ˆë‹¤. í˜ëª…ê°€ ê¸°ì§ˆì´ ìˆìŠµë‹ˆë‹¤.' },
    ];

    // ìë¯¸ë‘ìˆ˜ 12ê¶ (Twelve Palaces)
    const TWELVE_PALACES = [
        { name: 'ëª…ê¶', hanja: 'å‘½å®®', desc: 'ë³¸ì¸ì˜ ì„±ê²©ê³¼ ì™¸ëª¨, ì¸ìƒ ì „ë°˜ì˜ ë°©í–¥' },
        { name: 'í˜•ì œê¶', hanja: 'å…„å¼Ÿå®®', desc: 'í˜•ì œìë§¤ ë° ê°€ê¹Œìš´ ì¹œêµ¬ì™€ì˜ ê´€ê³„' },
        { name: 'ë¶€ì²˜ê¶', hanja: 'å¤«å¦»å®®', desc: 'ë°°ìš°ì, ì—°ì¸ê³¼ì˜ ê´€ê³„ ë° ê²°í˜¼ìš´' },
        { name: 'ìë…€ê¶', hanja: 'å­å¥³å®®', desc: 'ìë…€ì™€ì˜ ê´€ê³„ ë° ìë…€ìš´' },
        { name: 'ì¬ë°±ê¶', hanja: 'è²¡å¸›å®®', desc: 'ì¬ë¬¼ ìƒíƒœì™€ ëˆì„ ë²„ëŠ” ë°©ì‹' },
        { name: 'ì§ˆì•¡ê¶', hanja: 'ç–¾å„å®®', desc: 'ê±´ê°• ìƒíƒœì™€ ì£¼ì˜í•´ì•¼ í•  ì§ˆë³‘' },
        { name: 'ì²œì´ê¶', hanja: 'é·ç§»å®®', desc: 'ì´ë™, ì—¬í–‰, ì™¸ë¶€ í™˜ê²½ê³¼ì˜ ê´€ê³„' },
        { name: 'êµìš°ê¶', hanja: 'äº¤å‹å®®', desc: 'ì¹œêµ¬, ë™ë£Œ, ë¶€í•˜ì§ì›ê³¼ì˜ ê´€ê³„' },
        { name: 'ê´€ë¡ê¶', hanja: 'å®˜ç¥¿å®®', desc: 'ì§ì—…, ì‚¬ì—…, í•™ì—… ê´€ë ¨ ìš´ì„¸' },
        { name: 'ì „íƒê¶', hanja: 'ç”°å®…å®®', desc: 'ë¶€ë™ì‚°, ì£¼ê±°í™˜ê²½, ê°€ì • ë¶„ìœ„ê¸°' },
        { name: 'ë³µë•ê¶', hanja: 'ç¦å¾·å®®', desc: 'ì •ì‹ ì  í–‰ë³µ, ì·¨ë¯¸, ì „ìƒì˜ ë³µ' },
        { name: 'ë¶€ëª¨ê¶', hanja: 'çˆ¶æ¯å®®', desc: 'ë¶€ëª¨ì™€ì˜ ê´€ê³„, ìœ—ì‚¬ëŒê³¼ì˜ ê´€ê³„' },
    ];

    // ê°„ë‹¨ ê³„ì‚°: ì¶œìƒ ë°ì´í„°ë¡œ ì£¼ì„± ë°°ì¹˜ ê²°ì •
    const dayGanIdx = dayP.gan;
    const dayJiIdx = dayP.ji;
    const monthGanIdx = monthP.gan;
    const yearJiIdx = yearP.ji;
    const hourIdx = hourP ? hourP.ji : 6;

    // ëª…ê¶ ìœ„ì¹˜ ê²°ì • (ê°„ì†Œí™”: ì›”ì§€+ì‹œì§€ ê¸°ë°˜)
    const mingGongIdx = (monthP.ji + hourIdx) % 12;

    // ìë¯¸ì„± ìœ„ì¹˜ ê²°ì • (ê°„ì†Œí™”: ì¼ê°„ ê¸°ë°˜)
    const ziWeiPos = (dayGanIdx + dayJiIdx) % 12;

    // ê° ê¶ì— ì£¼ì„± ë°°ì¹˜ (ê°„ì†Œí™”ëœ ì•Œê³ ë¦¬ì¦˜)
    const palaceStars = TWELVE_PALACES.map((palace, i) => {
        const palaceIdx = (mingGongIdx + i) % 12;
        const starIdx1 = (ziWeiPos + palaceIdx) % 14;
        const starIdx2 = (ziWeiPos + palaceIdx + 7) % 14;
        const mainStar = ZI_WEI_STARS[starIdx1];
        const subStar = starIdx1 !== starIdx2 ? ZI_WEI_STARS[starIdx2] : null;

        // ê¶ì˜ ê¸¸í‰ íŒë‹¨ (ê°„ì†Œí™”)
        const elMatch = CHEONGAN_ELEMENT[dayGanIdx];
        const palaceEl = palaceIdx % 5;
        const SANG_SAENG_ARR = [[0,1],[1,2],[2,3],[3,4],[4,0]];
        const isSaeng = SANG_SAENG_ARR.some(([a,b]) => (a === elMatch && b === palaceEl) || (a === palaceEl && b === elMatch));
        const score = isSaeng ? Math.floor(Math.random() * 20) + 70 : (elMatch === palaceEl ? Math.floor(Math.random() * 15) + 75 : Math.floor(Math.random() * 25) + 50);

        return { ...palace, mainStar, subStar, score, palaceIdx };
    });

    // ëª…ê¶ ì£¼ì„±
    const mingStar = palaceStars[0].mainStar;

    let html = `<div style="text-align:center;margin-bottom:24px;">
        <div style="font-size:14px;color:var(--text-muted);margin-bottom:4px;">ëª…ê¶(å‘½å®®) ì£¼ì„±</div>
        <div style="font-size:28px;font-weight:700;color:var(--gold);font-family:'Noto Serif KR',serif;">${mingStar.hanja} Â· ${mingStar.name}</div>
        <div style="font-size:13px;color:var(--text-muted);margin-top:6px;">${mingStar.desc}</div>
        <div style="font-size:14px;color:var(--text-secondary);margin-top:10px;line-height:1.6;">${mingStar.trait}</div>
    </div>`;

    // 12ê¶ ê²©ì
    html += `<div style="display:grid;grid-template-columns:repeat(4,1fr);gap:8px;margin-bottom:20px;">`;
    // ìë¯¸ë‘ìˆ˜ ì°¨íŠ¸ë¥¼ 4x3 ê²©ìë¡œ í‘œí˜„ (ì „í†µì  ë°°ì¹˜ ê·¼ì‚¬)
    const gridOrder = [11, 0, 1, 2, 10, -1, -1, 3, 9, -1, -1, 4, 8, 7, 6, 5];
    gridOrder.forEach(idx => {
        if (idx === -1) {
            html += `<div style="background:var(--bg-card);border:1px solid var(--border);border-radius:8px;padding:10px;text-align:center;opacity:0.3;">
                <div style="font-size:20px;color:var(--gold);font-family:'Noto Serif KR',serif;">å‘½ç›¤</div>
            </div>`;
            return;
        }
        const p = palaceStars[idx];
        const scoreColor = p.score >= 75 ? 'var(--wood)' : p.score >= 60 ? 'var(--gold)' : 'var(--fire)';
        const isMain = idx === 0;
        html += `<div style="background:${isMain ? 'var(--bg-card-light)' : 'var(--bg-card)'};border:1px solid ${isMain ? 'var(--gold-dark)' : 'var(--border)'};border-radius:8px;padding:10px;text-align:center;${isMain ? 'box-shadow:0 0 8px rgba(212,165,67,0.3);' : ''}">
            <div style="font-size:10px;color:var(--text-muted)">${p.hanja}</div>
            <div style="font-size:12px;font-weight:600;color:${isMain ? 'var(--gold)' : 'var(--text)'};margin:2px 0;">${p.name}</div>
            <div style="font-size:11px;color:var(--gold-light);margin-bottom:3px;">${p.mainStar.hanja}</div>
            ${p.subStar ? `<div style="font-size:10px;color:var(--text-muted)">${p.subStar.hanja}</div>` : ''}
            <div style="font-size:11px;color:${scoreColor};margin-top:4px;font-weight:600;">${p.score}ì </div>
        </div>`;
    });
    html += `</div>`;

    // ì£¼ìš” ê¶ ìƒì„¸
    const keyPalaces = [0, 2, 4, 8]; // ëª…ê¶, ë¶€ì²˜ê¶, ì¬ë°±ê¶, ê´€ë¡ê¶
    html += `<div style="display:flex;flex-direction:column;gap:10px;">`;
    keyPalaces.forEach(idx => {
        const p = palaceStars[idx];
        const grade = p.score >= 80 ? 'ëŒ€ê¸¸(å¤§å‰)' : p.score >= 70 ? 'ê¸¸(å‰)' : p.score >= 55 ? 'í‰(å¹³)' : 'ì£¼ì˜(æ³¨æ„)';
        const gradeColor = p.score >= 80 ? 'var(--wood)' : p.score >= 70 ? 'var(--gold)' : p.score >= 55 ? 'var(--text-secondary)' : 'var(--fire)';
        html += `<div style="background:var(--bg-card);border:1px solid var(--border);border-radius:10px;padding:14px;">
            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:6px;">
                <div style="font-weight:600;color:var(--gold);">${p.hanja} ${p.name}</div>
                <div style="font-size:13px;color:${gradeColor};font-weight:600;">${grade} (${p.score}ì )</div>
            </div>
            <div style="font-size:13px;color:var(--text-secondary);margin-bottom:4px;">${p.desc}</div>
            <div style="font-size:12px;color:var(--text-muted);">ì£¼ì„±: <span style="color:var(--gold-light)">${p.mainStar.hanja} ${p.mainStar.name}</span> â€” ${p.mainStar.trait.substring(0, 40)}...</div>
        </div>`;
    });
    html += `</div>`;

    section.innerHTML = html;
}

// ===== ì‹ ì  ìŠ¤íƒ€ì¼ ë¶„ì„ (ç¥å ) =====
function renderShamanFortune(dayGanIdx, dayJiIdx, yearP, monthP, hourP, elements, gender, birthYear, birthMonth, birthDay) {
    const section = document.getElementById('shamanContent');
    const elIdx = CHEONGAN_ELEMENT[dayGanIdx];
    const genderKo = gender === 'male' ? 'ë„ë ¨ë‹˜' : 'ì•„ê°€ì”¨';
    const maxEl = elements.indexOf(Math.max(...elements));
    const minEl = elements.indexOf(Math.min(...elements));
    const minVal = Math.min(...elements);
    const totalEl = elements.reduce((a,b)=>a+b,0);

    // ì‹­ì„± (ì—°ì£¼ ê¸°ì¤€)
    const yearTenStar = getTenStar(dayGanIdx, yearP.gan);

    // 12ìš´ì„± ê°„ëµ
    const UN_SEONG_NAMES = ['ì ˆ','íƒœ','ì–‘','ì¥ìƒ','ëª©ìš•','ê´€ëŒ€','ê±´ë¡','ì œì™•','ì‡ ','ë³‘','ì‚¬','ë¬˜'];
    const dayUnIdx = (dayGanIdx * 3 + dayJiIdx) % 12;
    const dayUnSeong = UN_SEONG_NAMES[dayUnIdx];

    // ========== ì „ìƒ ë¶„ì„ ==========
    const JEONGSAENG = [
        { life: 'ê³ ê´€ëŒ€ì‘(é«˜å®˜å¤§çˆµ)', desc: 'ì „ìƒì— ë†’ì€ ë²¼ìŠ¬ì„ í•˜ê³  ë°±ì„±ì„ ë‹¤ìŠ¤ë¦¬ë˜ ë¶„ì´ì…¨ìŠµë‹ˆë‹¤. ê·¸ë˜ì„œ ì´ìƒì—ì„œë„ ë¦¬ë”ì‹­ì´ ê°•í•˜ê³  ë‚¨ ìœ„ì— ì„œë ¤ëŠ” ê¸°ì§ˆì´ ìˆì–´ìš”.', karma: 'ê¶Œë ¥ì„ ë‚¨ìš©í•œ ì—…ì´ ìˆì–´, ì´ìƒì—ì„œëŠ” ê²¸ì†ì„ ë°°ì›Œì•¼ í•©ë‹ˆë‹¤.', cure: 'ì ˆì— ê°€ì„œ ì²œë„ì¬ë¥¼ ì˜¬ë¦¬ì‹œê³ , ì–´ë ¤ìš´ ì´ì›ƒì„ ë„ìš°ë©´ ì „ìƒì˜ ì—…ì´ í’€ë¦½ë‹ˆë‹¤.' },
        { life: 'í•™ì(å­¸è€…)', desc: 'ì „ìƒì— ê¸€ì„ ì½ê³  í•™ë¬¸ì„ ë‹¦ë˜ ì„ ë¹„ì˜€ìŠµë‹ˆë‹¤. ì´ìƒì—ì„œ ë¨¸ë¦¬ê°€ ì¢‹ê³  ë°°ì›€ì— ëŒ€í•œ ê°ˆì¦ì´ ìˆëŠ” ê²ƒì´ ê·¸ ë•Œë¬¸ì´ì—ìš”.', karma: 'ì§€ì‹ìœ¼ë¡œ ë‚¨ì„ ê¹”ë³¸ ì—…ì´ ìˆì–´, ì´ìƒì—ì„œëŠ” ì§€ì‹ì„ ë‚˜ëˆ ì•¼ í•©ë‹ˆë‹¤.', cure: 'ê³µë¶€í•˜ëŠ” ì´ì—ê²Œ ì±…ì„ ì‚¬ì£¼ê±°ë‚˜ ê°€ë¥´ì¹¨ì„ ë² í’€ë©´ ë³µì´ ì˜µë‹ˆë‹¤.' },
        { life: 'ì¥êµ°(å°‡è»)', desc: 'ì „ìƒì— ì „ìŸí„°ë¥¼ ëˆ„ë¹„ë˜ ë¬´ì¸ì´ì…¨ìŠµë‹ˆë‹¤. ê·¸ë˜ì„œ ì´ìƒì—ì„œë„ ìŠ¹ë¶€ìš•ì´ ê°•í•˜ê³  ë¶ˆì˜ë¥¼ ì°¸ì§€ ëª»í•´ìš”.', karma: 'ì „ì¥ì—ì„œ ë§ì€ ì‚´ìƒì„ í•œ ì—…ì´ ìˆì–´, ì´ìƒì—ì„œ ê±´ê°• ë¬¸ì œë¡œ ë‚˜íƒ€ë‚  ìˆ˜ ìˆìŠµë‹ˆë‹¤.', cure: 'ë°©ìƒ(æ”¾ç”Ÿ)ì„ í•˜ì‹œê³ , ì‚´ì•„ìˆëŠ” ê²ƒì„ í•¨ë¶€ë¡œ í•˜ì§€ ë§ˆì„¸ìš”. ì‚°ì‚¬ì—ì„œ ê¸°ë„í•˜ë©´ ì¢‹ìŠµë‹ˆë‹¤.' },
        { life: 'ìƒì¸(å•†äºº)', desc: 'ì „ìƒì— í° ì¥ì‚¬ë¥¼ í•˜ë˜ ê±°ìƒì´ì…¨ìŠµë‹ˆë‹¤. ì´ìƒì—ì„œë„ ëˆì— ëŒ€í•œ ê°ê°ì´ ë›°ì–´ë‚˜ê³  ì‚¬ì—… ìˆ˜ì™„ì´ ì¢‹ì•„ìš”.', karma: 'ì´ìµì„ ìœ„í•´ ë‚¨ì„ ì†ì¸ ì—…ì´ ìˆì–´, ì´ìƒì—ì„œ ë°°ì‹ ì„ ë‹¹í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.', cure: 'ì •ì§í•˜ê²Œ ì‚´ê³ , ë²ˆ ëˆì˜ ì¼ë¶€ë¥¼ ì–´ë ¤ìš´ ì´ì—ê²Œ ë² í’€ë©´ ì—…ì´ í’€ë¦½ë‹ˆë‹¤.' },
        { life: 'ìŠ¹ë ¤(åƒ§ä¾¶)', desc: 'ì „ìƒì— ì‚°ì†ì—ì„œ ë„ë¥¼ ë‹¦ë˜ ìˆ˜í–‰ìì˜€ìŠµë‹ˆë‹¤. ì´ìƒì—ì„œë„ ì˜ì  ê°ìˆ˜ì„±ì´ ë†’ê³  ì„¸ì†ì ì¸ ê²ƒì— ì´ˆì—°í•œ ë©´ì´ ìˆì–´ìš”.', karma: 'ìˆ˜í–‰ ì¤‘ êµë§Œí•´ì§„ ì—…ì´ ìˆì–´, ì´ìƒì—ì„œ ì™¸ë¡œì›€ì„ ê²ªì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.', cure: 'ë§ˆìŒì„ ë¹„ìš°ëŠ” ëª…ìƒì„ í•˜ê³ , ì‚¬ëŒë“¤ê³¼ ì–´ìš¸ë¦¬ëŠ” ì—°ìŠµì„ í•˜ì„¸ìš”.' },
        { life: 'ì˜ˆì¸(è—äºº)', desc: 'ì „ìƒì— ë…¸ë˜ì™€ ì¶¤ìœ¼ë¡œ ì‚¬ëŒë“¤ì„ ì¦ê²ê²Œ í•˜ë˜ ì˜ˆì¸ì´ì…¨ìŠµë‹ˆë‹¤. ì´ìƒì—ì„œë„ ì˜ˆìˆ ì  ê°ê°ì´ ë›°ì–´ë‚˜ìš”.', karma: 'í™”ë ¤í•¨ì— ë¹ ì ¸ ë³¸ì§ˆì„ ìƒì€ ì—…ì´ ìˆì–´, ì´ìƒì—ì„œ ë‚´ë©´ì„ ì±„ì›Œì•¼ í•©ë‹ˆë‹¤.', cure: 'ë§ˆìŒì„ ë‹¤ìŠ¤ë¦¬ëŠ” ìˆ˜í–‰ì„ í•˜ê³ , ì˜ˆìˆ ë¡œ ë‚¨ì„ ê°ë™ì‹œí‚¤ë©´ ë³µì´ ìŒ“ì…ë‹ˆë‹¤.' },
        { life: 'ë†ë¶€(è¾²å¤«)', desc: 'ì „ìƒì— ë•…ì„ ì¼êµ¬ë©° ì„±ì‹¤í•˜ê²Œ ì‚´ë˜ ë¶„ì´ì…¨ìŠµë‹ˆë‹¤. ì´ìƒì—ì„œë„ ê·¼ë©´í•˜ê³  ì°©ì‹¤í•œ ì„±í’ˆì´ ìˆì–´ìš”.', karma: 'ë‚¨ì˜ ê²ƒì„ íƒë‚¸ ì—…ì´ ì•½ê°„ ìˆì–´, ì´ìƒì—ì„œ ì¬ë¬¼ ì‹œë¹„ë¥¼ ì¡°ì‹¬í•´ì•¼ í•©ë‹ˆë‹¤.', cure: 'íƒìš•ì„ ë²„ë¦¬ê³  ìê¸° ê²ƒì— ë§Œì¡±í•˜ë©´, ì˜¤íˆë ¤ ë” í° ë³µì´ ì˜µë‹ˆë‹¤.' },
        { life: 'ì™•ì¡±(ç‹æ—)', desc: 'ì „ìƒì— ì™•ì‹¤ì—ì„œ ê·€í•˜ê²Œ íƒœì–´ë‚œ ë¶„ì´ì…¨ìŠµë‹ˆë‹¤. ì´ìƒì—ì„œë„ ê¸°í’ˆì´ ìˆê³  ê³ ìƒí•œ ì·¨í–¥ì„ ê°€ì§€ê³  ìˆì–´ìš”.', karma: 'ë°±ì„±ì˜ ê³ í†µì„ ì™¸ë©´í•œ ì—…ì´ ìˆì–´, ì´ìƒì—ì„œ ê³µê° ëŠ¥ë ¥ì„ í‚¤ì›Œì•¼ í•©ë‹ˆë‹¤.', cure: 'ë´‰ì‚¬í™œë™ì„ ê¾¸ì¤€íˆ í•˜ê³ , ì•½ìë¥¼ ëŒë³´ë©´ í° ë³µì„ ë°›ìŠµë‹ˆë‹¤.' },
        { life: 'ì˜ì›(é†«å“¡)', desc: 'ì „ìƒì— ì•„í”ˆ ì‚¬ëŒì„ ì¹˜ë£Œí•˜ë˜ ì˜ì›ì´ì…¨ìŠµë‹ˆë‹¤. ì´ìƒì—ì„œë„ ë‚¨ì„ ëŒë³´ë ¤ëŠ” ë§ˆìŒì´ í¬ê³  ì¹˜ìœ  ëŠ¥ë ¥ì´ ìˆì–´ìš”.', karma: 'ì¹˜ë£Œë¹„ë¥¼ ê³¼í•˜ê²Œ ë°›ì€ ì—…ì´ ìˆì–´, ì´ìƒì—ì„œ ë² í’‚ì´ í•„ìš”í•©ë‹ˆë‹¤.', cure: 'ì•„í”ˆ ì‚¬ëŒì„ ë„ì™€ì£¼ê³ , ì•½ì„ ë‚˜ëˆ ì£¼ë©´ ê±´ê°•ìš´ì´ ì¢‹ì•„ì§‘ë‹ˆë‹¤.' },
        { life: 'í’ë¥˜ê°(é¢¨æµå®¢)', desc: 'ì „ìƒì— ììœ ë¡­ê²Œ ì²œí•˜ë¥¼ ë– ëŒë©° ì‹œë¥¼ ì§“ë˜ í’ë¥˜ê°ì´ì…¨ìŠµë‹ˆë‹¤. ì´ìƒì—ì„œë„ ììœ ë¥¼ ì‚¬ë‘í•˜ê³  êµ¬ì†ì„ ì‹«ì–´í•´ìš”.', karma: 'ì±…ì„ì„ íšŒí”¼í•œ ì—…ì´ ìˆì–´, ì´ìƒì—ì„œ ì±…ì„ê°ì„ ë°°ì›Œì•¼ í•©ë‹ˆë‹¤.', cure: 'í•œ ê³³ì— ì •ì°©í•˜ì—¬ ë¿Œë¦¬ë¥¼ ë‚´ë¦¬ê³ , ê°€ì •ì„ ì†Œì¤‘íˆ í•˜ë©´ ì•ˆì •ë©ë‹ˆë‹¤.' },
    ];
    const jeongsaengIdx = (dayGanIdx + dayJiIdx + yearP.ji) % JEONGSAENG.length;
    const js = JEONGSAENG[jeongsaengIdx];

    // ========== ìˆ˜í˜¸ì‹  ==========
    const SUHOSIN = [
        { name: 'ì‚°ì‹ ë ¹(å±±ç¥éˆ)', emoji: 'ğŸ”ï¸', desc: 'ì‚°ì„ ê´€ì¥í•˜ëŠ” ì‚°ì‹ ë ¹ë‹˜ì´ ë‹¹ì‹ ì„ ì§€ì¼œë³´ê³  ê³„ì‹­ë‹ˆë‹¤. ì‚°ê³¼ ìì—°ì—ì„œ ê¸°ìš´ì„ ë°›ìœ¼ë©´ ì¢‹ìŠµë‹ˆë‹¤.', where: 'ê°€ê¹Œìš´ ì‚°ì˜ ì‚°ì‹ ê°ì—ì„œ ê¸°ë„í•˜ì„¸ìš”.' },
        { name: 'ìš©ì™•ë‹˜(é¾ç‹)', emoji: 'ğŸ²', desc: 'ë°”ë‹¤ì™€ ë¬¼ì„ ê´€ì¥í•˜ëŠ” ìš©ì™•ë‹˜ì˜ ë³´í˜¸ë¥¼ ë°›ê³  ìˆìŠµë‹ˆë‹¤. ë¬¼ ê·¼ì²˜ì—ì„œ ê¸°ìš´ì´ ê°•í•´ì§‘ë‹ˆë‹¤.', where: 'ë°”ë‹¤ë‚˜ ê°•ê°€ì—ì„œ ì†Œì›ì„ ë¹Œë©´ ì´ë¤„ì§‘ë‹ˆë‹¤.' },
        { name: 'ì¹ ì„±ë‹˜(ä¸ƒæ˜Ÿ)', emoji: 'â­', desc: 'ë¶ë‘ì¹ ì„±ì˜ ê¸°ìš´ì„ ë°›ê³  ìˆìŠµë‹ˆë‹¤. ë°¤í•˜ëŠ˜ì˜ ë³„ì„ ë³´ë©° ê¸°ë„í•˜ë©´ ì†Œì›ì´ ì´ë¤„ì§‘ë‹ˆë‹¤.', where: 'ì¹ ì„±ê°ì´ë‚˜ ë°¤í•˜ëŠ˜ ì•„ë˜ì„œ ê¸°ë„í•˜ì„¸ìš”.' },
        { name: 'ê´€ìŒë³´ì‚´(è§€éŸ³)', emoji: 'ğŸ™', desc: 'ìë¹„ì˜ ê´€ìŒë³´ì‚´ë‹˜ì´ ë‹¹ì‹ ì„ ê°ì‹¸ê³  ê³„ì‹­ë‹ˆë‹¤. ì–´ë ¤ìš¸ ë•Œ ê´€ì„¸ìŒë³´ì‚´ì„ ë¶€ë¥´ë©´ ë„ì›€ì´ ì˜µë‹ˆë‹¤.', where: 'ì ˆì—ì„œ ê´€ìŒì „ì— ê¸°ë„ë¥¼ ì˜¬ë¦¬ì„¸ìš”.' },
        { name: 'ëŒ€ê°ë‹˜(å¤§ç›£)', emoji: 'ğŸ©', desc: 'ì¬ë¬¼ì„ ê´€ì¥í•˜ëŠ” ëŒ€ê°ë‹˜ì´ ë¶™ì–´ ê³„ì‹­ë‹ˆë‹¤. ì‚¬ì—…ê³¼ ì¬ë¬¼ì— ë„ì›€ì„ ì£¼ì‹œëŠ” ë¶„ì…ë‹ˆë‹¤.', where: 'ëŒ€ê°ë‹˜ê»˜ ì •í™”ìˆ˜ë¥¼ ì˜¬ë¦¬ê³  ë¹„ì†í•˜ì„¸ìš”.' },
        { name: 'ì¥êµ°ë‹˜(å°‡è»)', emoji: 'âš”ï¸', desc: 'ì¥êµ°ì‹ ì´ ë‹¹ì‹ ì„ í˜¸ìœ„í•˜ê³  ê³„ì‹­ë‹ˆë‹¤. ê°•í•œ ê¸°ìš´ìœ¼ë¡œ ë‚˜ìœ ê²ƒì„ ë§‰ì•„ì¤ë‹ˆë‹¤.', where: 'ì¥êµ°ë‹¹ì´ë‚˜ ì„±í™©ë‹¹ì—ì„œ ê¸°ë„í•˜ì„¸ìš”.' },
        { name: 'ì‚¼ì‹ í• ë¨¸ë‹ˆ(ä¸‰ç¥)', emoji: 'ğŸ‘µ', desc: 'ì‚¼ì‹ í• ë¨¸ë‹ˆê°€ ë‹¹ì‹ ì˜ ê±´ê°•ê³¼ ìì†ì„ ì§€ì¼œë³´ê³  ê³„ì‹­ë‹ˆë‹¤. ê°€ì •ì˜ í‰ì•ˆì„ ì£¼ì‹œëŠ” ë¶„ì…ë‹ˆë‹¤.', where: 'ì •í™”ìˆ˜ë¥¼ ë– ë†“ê³  ì‚¼ì‹ í• ë¨¸ë‹ˆê»˜ ë¹Œë©´ ì¢‹ìŠµë‹ˆë‹¤.' },
        { name: 'ì„ ë…€ë‹˜(ä»™å¥³)', emoji: 'ğŸ§š', desc: 'í•˜ëŠ˜ì˜ ì„ ë…€ë‹˜ì´ ë‹¹ì‹ ê³¼ í•¨ê»˜ í•˜ì‹­ë‹ˆë‹¤. ì˜ˆìˆ ì  ì˜ê°ê³¼ ì•„ë¦„ë‹¤ìš´ ì¸ì—°ì„ ê°€ì ¸ë‹¤ì¤ë‹ˆë‹¤.', where: 'ê¹¨ë—í•œ ë§ˆìŒìœ¼ë¡œ ì •ì„±ì„ ë“œë¦¬ì„¸ìš”.' },
        { name: 'ì¡°ìƒë‹˜(ç¥–ä¸Š)', emoji: 'ğŸ›ï¸', desc: 'ëŒì•„ê°€ì‹  ì¡°ìƒë‹˜ì´ ê°•í•˜ê²Œ ë‹¹ì‹ ì„ ë³´í˜¸í•˜ê³  ê³„ì‹­ë‹ˆë‹¤. ì¡°ìƒì˜ ìŒë•ì´ ë§¤ìš° í½ë‹ˆë‹¤.', where: 'ì œì‚¬ì™€ ì°¨ë¡€ë¥¼ ì •ì„±ê» ëª¨ì‹œì„¸ìš”. ì„±ë¬˜ë¥¼ ìì£¼ í•˜ì‹œë©´ ì¢‹ìŠµë‹ˆë‹¤.' },
        { name: 'í† ì§€ì‹ (åœŸåœ°ç¥)', emoji: 'ğŸŒ¾', desc: 'ì´ ë•…ì˜ í† ì§€ì‹ ì´ ë‹¹ì‹ ì„ ëŒë³´ê³  ê³„ì‹­ë‹ˆë‹¤. ì‚´ê³  ìˆëŠ” í„°ì˜ ê¸°ìš´ì´ ì¤‘ìš”í•©ë‹ˆë‹¤.', where: 'ì´ì‚¬í•˜ë©´ í„°ì£¼ê³ ì‚¬ë¥¼ ì§€ë‚´ê³ , ì§‘ ì£¼ë³€ì„ ê¹¨ë—ì´ í•˜ì„¸ìš”.' },
    ];
    const suhoIdx = (dayGanIdx * 2 + dayJiIdx + birthMonth) % SUHOSIN.length;
    const suho = SUHOSIN[suhoIdx];

    // ========== ì‚´(ç…) ë¶„ì„ ==========
    const SSAL_LIST = [
        { name: 'ì—­ë§ˆì‚´(é©›é¦¬ç…)', cond: (e) => e[0] >= 2 && e[1] >= 2, desc: 'ì´ ì‚¬ëŒ ê°€ë§Œíˆ ëª» ì•‰ì•„ ìˆì–´ìš”! ì—­ë§ˆì‚´ì´ ë¼ì–´ì„œ ìê¾¸ ëŒì•„ë‹¤ë‹ˆê³  ì‹¶ê³  í•œ ê³³ì— ì •ì°©ì„ ëª» í•´ìš”.', cure: 'ì˜¤íˆë ¤ ì—¬í–‰ì´ë‚˜ í•´ì™¸ ê´€ë ¨ ì¼ì„ í•˜ë©´ ì‚´ì´ í’€ë ¤ì„œ ëŒ€ë°•ì´ ë‚©ë‹ˆë‹¤!', icon: 'ğŸ' },
        { name: 'ë„í™”ì‚´(æ¡ƒèŠ±ç…)', cond: (e) => dayJiIdx === 3 || dayJiIdx === 6 || dayJiIdx === 9 || dayJiIdx === 0, desc: 'ì´ ì‚¬ëŒ ì´ì„±ì—ê²Œ ì¸ê¸°ê°€ ì—„ì²­ ë§ì•„ìš”! ë„í™”ì‚´ì´ ìˆì–´ì„œ ëˆˆì´ ë°˜ì§ë°˜ì§í•˜ê³  ë§¤ë ¥ì´ ì² ì²  ë„˜ì³ìš”.', cure: 'ë°”ëŒê¸° ì¡°ì‹¬í•˜ì‹œê³ , í•œ ì‚¬ëŒì—ê²Œ ì§‘ì¤‘í•˜ë©´ ì˜¤íˆë ¤ í° ë³µì´ ë©ë‹ˆë‹¤!', icon: 'ğŸŒ¸' },
        { name: 'í™”ê°œì‚´(è¯è“‹ç…)', cond: (e) => dayJiIdx === 4 || dayJiIdx === 8 || dayJiIdx === 1, desc: 'ì˜ì ì¸ ê°ìˆ˜ì„±ì´ ë³´í†µì´ ì•„ë‹ˆì—ìš”! í™”ê°œì‚´ì´ ìˆì–´ì„œ ì¢…êµ, ì² í•™, ì˜ˆìˆ  ìª½ìœ¼ë¡œ ì¬ëŠ¥ì´ ìˆì–´ìš”.', cure: 'ëª…ìƒì´ë‚˜ ê¸°ë„ë¥¼ í•˜ë©´ ë§ˆìŒì´ í¸í•´ì§€ê³ , ì˜ˆìˆ  í™œë™ì´ í° ë„ì›€ì´ ë©ë‹ˆë‹¤.', icon: 'ğŸ”®' },
        { name: 'ê²ì‚´(åŠ«ç…)', cond: (e) => e[3] >= 3, desc: 'ê°€ë” ëœ»ë°–ì˜ ì‚¬ê³ ë‚˜ ì†ì¬ìˆ˜ê°€ ìˆì„ ìˆ˜ ìˆì–´ìš”. íŠ¹íˆ ê¸ˆì „ ê±°ë˜ì—ì„œ ì¡°ì‹¬í•˜ì…”ì•¼ í•´ìš”!', cure: 'í°ëˆ ê±°ë˜ëŠ” ì‹ ì¤‘íˆ í•˜ì‹œê³ , ë³´ì¦ì€ ì ˆëŒ€ ì„œì§€ ë§ˆì„¸ìš”! ë¶€ì ì„ ì§€ë‹ˆë©´ ì¢‹ìŠµë‹ˆë‹¤.', icon: 'âš¡' },
        { name: 'ë°±í˜¸ì‚´(ç™½è™ç…)', cond: (e) => e[3] >= 2 && e[1] >= 2, desc: 'êµí†µì‚¬ê³ ë‚˜ ìˆ˜ìˆ ìˆ˜ê°€ ë³´ì—¬ìš”! ì¹¼ì„ ì“°ëŠ” ì¼ì— ì£¼ì˜í•˜ì‹œê³ , ìš´ì „í•  ë•Œ ê°ë³„íˆ ì¡°ì‹¬í•˜ì„¸ìš”!', cure: 'í—Œí˜ˆì„ í•˜ë©´ í”¼ë¥¼ ë³´ëŠ” ì‚´ì´ í’€ë¦½ë‹ˆë‹¤. ë§¤ë…„ ê±´ê°•ê²€ì§„ ê¼­ ë°›ìœ¼ì„¸ìš”!', icon: 'ğŸ¯' },
        { name: 'ê´€ì¬ì‚´(å®˜ç½ç…)', cond: (e) => elements[CHEONGAN_ELEMENT[(dayGanIdx+6)%10]] >= 2, desc: 'ê³µë¬¸ì„œ, ì†Œì†¡, ë²Œê¸ˆ ê´€ë ¨í•´ì„œ ì£¼ì˜ê°€ í•„ìš”í•´ìš”! ê´€ì¬ìˆ˜ê°€ ë³´ì…ë‹ˆë‹¤.', cure: 'ì„œë¥˜ëŠ” ê¼¼ê¼¼íˆ í™•ì¸í•˜ì‹œê³ , ë²•ì  ë‹¤íˆ¼ì€ í”¼í•˜ì„¸ìš”. í•©ì˜ê°€ ìƒì±…ì…ë‹ˆë‹¤!', icon: 'âš–ï¸' },
        { name: 'ê³ ë…ì‚´(å­¤ç¨ç…)', cond: (e) => minVal === 0, desc: 'ë§ˆìŒì†ì— ì™¸ë¡œì›€ì´ ê¹Šì–´ìš”. ì‚¬ëŒì´ ë§ì•„ë„ í˜¼ìë¼ëŠ” ëŠë‚Œì´ ë“¤ ë•Œê°€ ìˆì£ ...', cure: 'ë´‰ì‚¬í™œë™ì„ í•˜ê±°ë‚˜ ë°˜ë ¤ë™ë¬¼ì„ í‚¤ìš°ë©´ ì™¸ë¡œì›€ì´ í’€ë¦¬ê³  ë³µì´ ë“¤ì–´ì˜µë‹ˆë‹¤.', icon: 'ğŸŒ™' },
        { name: 'ì›ì§„ì‚´(æ€¨å—”ç…)', cond: (e) => (dayJiIdx + 6) % 12 === yearP.ji, desc: 'ê°€ê¹Œìš´ ì‚¬ëŒê³¼ ë¯¸ì›Œí•˜ë©´ì„œë„ ë–¨ì–´ì§ˆ ìˆ˜ ì—†ëŠ” ê´€ê³„ê°€ ìˆì–´ìš”. ì• ì¦ì˜ ê´€ê³„ê°€ ìˆìŠµë‹ˆë‹¤.', cure: 'ìƒëŒ€ë¥¼ ë¯¸ì›Œí•˜ì§€ ë§ê³  ì´í•´í•˜ë ¤ê³  ë…¸ë ¥í•˜ì„¸ìš”. ìš©ì„œê°€ í•´ë²•ì…ë‹ˆë‹¤.', icon: 'ğŸ’”' },
    ];

    const activeSsal = SSAL_LIST.filter(s => s.cond(elements));
    if (activeSsal.length === 0) {
        activeSsal.push({ name: 'ë¬´ì‚´(ç„¡ç…)', desc: 'íŠ¹ë³„íˆ ê°•í•œ ì‚´ì´ ì—†ìŠµë‹ˆë‹¤. í‰ì˜¨í•œ ì‚¬ì£¼ì´ë‹ˆ ì•ˆì‹¬í•˜ì„¸ìš”!', cure: 'í‰ì•ˆí•œ ë§ˆìŒì„ ìœ ì§€í•˜ê³  ê°ì‚¬í•˜ë©° ì‚´ë©´ ë©ë‹ˆë‹¤.', icon: 'â˜€ï¸' });
    }

    // ========== ì‹ ìˆ˜(ç¥æ•¸) ì ìˆ˜ ==========
    const AREAS = ['ì¬ë¬¼ìš´', 'ê±´ê°•ìš´', 'ì• ì •ìš´', 'ì§ì¥ìš´', 'ê°€ì •ìš´', 'ê·€ì¸ìš´'];
    const AREA_EMOJIS = ['ğŸ’°', 'ğŸ¥', 'â¤ï¸', 'ğŸ’¼', 'ğŸ ', 'ğŸ¤'];
    const areaScores = AREAS.map((_, i) => {
        let base = 55 + (dayGanIdx * 7 + dayJiIdx * 3 + i * 11) % 35;
        if (i === 0 && maxEl === 3) base += 8;
        if (i === 1 && minEl === 4) base -= 10;
        if (i === 2 && (dayJiIdx === 3 || dayJiIdx === 6)) base += 10;
        if (i === 3 && yearTenStar === 'ì •ê´€') base += 12;
        if (i === 4 && elements[2] >= 2) base += 7;
        if (i === 5 && yearTenStar === 'ì •ì¸') base += 10;
        return Math.min(98, Math.max(30, base));
    });
    const totalScore = Math.round(areaScores.reduce((a,b)=>a+b,0) / areaScores.length);

    // ========== ì‹ ì  ë§íˆ¬ ìƒì„± ==========
    const EL_SHAMAN = ['ë‚˜ë¬´','ë¶ˆ','í™','ì‡ ','ë¬¼'];
    const dayElName = EL_SHAMAN[elIdx];

    // ê°œìš´ë²•(é–‹é‹æ³•)
    const GAEUN = [
        { el: 0, text: 'ë™ìª½ìœ¼ë¡œ ë‚˜ë¬´ê°€ ë§ì€ ê³³ì—ì„œ ì‚°ì±…í•˜ì„¸ìš”. ì´ˆë¡ìƒ‰ ì˜·ì„ ìì£¼ ì…ê³ , ìƒˆë²½ ì‹œê°„ì— ê¸°ë„í•˜ë©´ ì¢‹ìŠµë‹ˆë‹¤. ì†Œë‚˜ë¬´ ì•„ë˜ì„œ ì‹¬í˜¸í¡í•˜ë©´ ê¸°ìš´ì´ ì‚´ì•„ë‚©ë‹ˆë‹¤.' },
        { el: 1, text: 'ë‚¨ìª½ ë°©í–¥ì˜ ë°ì€ ê³³ì´ ì¢‹ìŠµë‹ˆë‹¤. ë¹¨ê°„ìƒ‰ ì†Œí’ˆì„ ê°€ê¹Œì´ ë‘ì‹œê³ , ì´›ë¶ˆì„ ì¼œë†“ê³  ëª…ìƒí•˜ë©´ ê¸°ìš´ì´ ê°•í•´ì§‘ë‹ˆë‹¤. í•´ ëœ° ë•Œ ê¸°ë„í•˜ì„¸ìš”.' },
        { el: 2, text: 'ì¤‘ì•™ì— ë¨¸ë¬´ë¥´ê³  ë…¸ë€ìƒ‰, ê°ˆìƒ‰ ê³„ì—´ì„ ê°€ê¹Œì´ í•˜ì„¸ìš”. í™ì„ ë§Œì§€ëŠ” í™œë™(í…ƒë°­ ê°€ê¾¸ê¸°, ë„ìê¸°)ì´ ì¢‹ìŠµë‹ˆë‹¤. ì‚°ì— ê°€ì„œ í™ì„ ë°Ÿìœ¼ì„¸ìš”.' },
        { el: 3, text: 'ì„œìª½ ë°©í–¥ì´ ê¸¸í•©ë‹ˆë‹¤. í°ìƒ‰, ì€ìƒ‰ ê¸ˆì† ì•¡ì„¸ì„œë¦¬ë¥¼ ì°©ìš©í•˜ì‹œê³ , í’ê²½ ì†Œë¦¬ë¥¼ ì§‘ì— ê±¸ì–´ë‘ë©´ ë‚˜ìœ ê¸°ìš´ì´ ë¬¼ëŸ¬ê°‘ë‹ˆë‹¤. ê°€ì„ì— ê¸°ë„í•˜ë©´ íš¨í—˜ì´ ìˆìŠµë‹ˆë‹¤.' },
        { el: 4, text: 'ë¶ìª½ ë°©í–¥ì´ ì¢‹ê³  ê²€ì •ìƒ‰, ë‚¨ìƒ‰ ê³„ì—´ì„ ê°€ê¹Œì´ í•˜ì„¸ìš”. ë¬¼ì„ ìì£¼ ë§ˆì‹œê³  ìˆ˜ì˜ì¥ì´ë‚˜ ê³„ê³¡ì„ ì°¾ìœ¼ì„¸ìš”. ë¹„ ì˜¤ëŠ” ë‚  ì •í™”ìˆ˜ë¥¼ ë– ë†“ê³  ë¹„ì„¸ìš”.' },
    ];
    const needGaeun = GAEUN[minEl];

    // ì˜¬í•´(2026) ì‹ ì  ìš´ì„¸
    const yearFortunes = [
        'ì˜¬í•´ëŠ” ìƒˆ ë¬¸ì´ ì—´ë¦¬ëŠ” í•´ì…ë‹ˆë‹¤! ê·¸ë™ì•ˆ ë§‰í˜€ìˆë˜ ì¼ì´ ìˆ ìˆ  í’€ë¦¬ê¸° ì‹œì‘í•´ìš”.',
        'ì˜¬í•´ëŠ” ì°¸ê³  ê¸°ë‹¤ë¦¬ëŠ” í•´ì…ë‹ˆë‹¤. ì¡°ê¸‰í•˜ë©´ ì¼ì„ ê·¸ë¥´ì¹˜ë‹ˆ, ë•Œë¥¼ ê¸°ë‹¤ë¦¬ì„¸ìš”.',
        'ì˜¬í•´ëŠ” ê·€ì¸ì´ ë‚˜íƒ€ë‚˜ëŠ” í•´ì…ë‹ˆë‹¤! ìƒˆë¡œìš´ ì‚¬ëŒì„ ë§Œë‚˜ë©´ í•¨ë¶€ë¡œ ê±°ì ˆí•˜ì§€ ë§ˆì„¸ìš”.',
        'ì˜¬í•´ëŠ” ë³€í™”ì˜ í•´ì…ë‹ˆë‹¤. ì´ì‚¬, ì´ì§, ì „í™˜ì ì´ ì°¾ì•„ì˜¤ë‹ˆ ë‘ë ¤ì›Œí•˜ì§€ ë§ˆì„¸ìš”.',
        'ì˜¬í•´ëŠ” ì—´ë§¤ë¥¼ ê±°ë‘ëŠ” í•´ì…ë‹ˆë‹¤! ê·¸ë™ì•ˆì˜ ë…¸ë ¥ì´ ê²°ì‹¤ì„ ë§ºìœ¼ë‹ˆ ê¸°ëŒ€í•˜ì…”ë„ ë©ë‹ˆë‹¤.',
        'ì˜¬í•´ëŠ” ê±´ê°•ì„ ì±™ê²¨ì•¼ í•˜ëŠ” í•´ì…ë‹ˆë‹¤. ë¬´ë¦¬í•˜ì§€ ë§ê³ , ëª¸ì´ ë³´ë‚´ëŠ” ì‹ í˜¸ì— ê·€ ê¸°ìš¸ì´ì„¸ìš”.',
        'ì˜¬í•´ëŠ” ì¬ë¬¼ì´ ë“¤ì–´ì˜¤ëŠ” í•´ì…ë‹ˆë‹¤! í•˜ì§€ë§Œ ë‚˜ê°€ëŠ” ê²ƒë„ ë§ìœ¼ë‹ˆ ì•„ë¼ê³  ëª¨ì•„ì•¼ í•©ë‹ˆë‹¤.',
        'ì˜¬í•´ëŠ” í•™ì—…ê³¼ ìê¸° ë°œì „ì˜ í•´ì…ë‹ˆë‹¤. ê³µë¶€í•˜ê³  ìê²©ì¦ ë”°ë©´ í¬ê²Œ ë¹›ì„ ë´…ë‹ˆë‹¤.',
        'ì˜¬í•´ëŠ” ê°€ì •ì— ê²½ì‚¬ê°€ ìˆëŠ” í•´ì…ë‹ˆë‹¤! ê²°í˜¼, ì¶œì‚°, ì´ì‚¬ ë“± ì¢‹ì€ ì¼ì´ ìƒê²¨ìš”.',
        'ì˜¬í•´ëŠ” ì‹œí—˜ê³¼ ë„ì „ì˜ í•´ì…ë‹ˆë‹¤. í˜ë“¤ì§€ë§Œ ì´ê²¨ë‚´ë©´ ë‚´ë…„ì— í° ë³µì´ ì˜µë‹ˆë‹¤.',
    ];
    const yearFortuneIdx = (dayGanIdx + dayJiIdx + 2026) % yearFortunes.length;

    // ========== HTML ì¡°ë¦½ ==========
    let html = '';

    // 1. ë„ì… (ë¬´ì†ì¸ ë§íˆ¬)
    html += `<div style="background:linear-gradient(135deg, #1a0a2e 0%, #2d1b4e 50%, #1a0a2e 100%);border:2px solid #8b5cf6;border-radius:16px;padding:28px;margin-bottom:20px;position:relative;overflow:hidden;">
        <div style="position:absolute;top:0;left:0;right:0;bottom:0;background:radial-gradient(circle at 30% 20%, rgba(139,92,246,0.15) 0%, transparent 50%), radial-gradient(circle at 70% 80%, rgba(236,72,153,0.1) 0%, transparent 50%);pointer-events:none;"></div>
        <div style="position:relative;z-index:1;">
            <div style="text-align:center;font-size:28px;margin-bottom:12px;">ğŸ”®âœ¨ğŸŒ™</div>
            <div style="text-align:center;font-size:18px;font-weight:700;color:#c4b5fd;font-family:'Noto Serif KR',serif;margin-bottom:16px;line-height:1.6;">
                "ì–´í—ˆ~ ${genderKo}, ì´ë¦¬ ê°€ê¹Œì´ ì™€ë³´ì„¸ìš”.<br>ë‹¹ì‹ ì˜ ì‚¬ì£¼ë¥¼ í•œë²ˆ ë“¤ì—¬ë‹¤ë´…ì‹œë‹¤..."
            </div>
            <div style="font-size:14px;color:#d8b4fe;line-height:2;text-align:center;">
                ${genderKo}ì˜ íƒ€ê³ ë‚œ ê¸°ìš´ì€ <strong style="color:#fbbf24">${dayElName}</strong>ì˜ ê¸°ìš´ì´ì—ìš”.<br>
                ${elIdx === 0 ? 'ë‚˜ë¬´ì²˜ëŸ¼ ê³§ê³  ì‘¥ì‘¥ ìë¼ëŠ” ê¸°ìš´ì„ íƒ€ê³  ë‚¬ì–´ìš”.' :
                  elIdx === 1 ? 'ë¶ˆì²˜ëŸ¼ ëœ¨ê²ê³  ì—´ì •ì ì¸ ê¸°ìš´ì„ íƒ€ê³  ë‚¬ì–´ìš”.' :
                  elIdx === 2 ? 'í™ì²˜ëŸ¼ ë“¬ì§í•˜ê³  ë§Œë¬¼ì„ í’ˆëŠ” ê¸°ìš´ì„ íƒ€ê³  ë‚¬ì–´ìš”.' :
                  elIdx === 3 ? 'ì‡ ì²˜ëŸ¼ ë‹¨ë‹¨í•˜ê³  ë‚ ì¹´ë¡œìš´ ê¸°ìš´ì„ íƒ€ê³  ë‚¬ì–´ìš”.' :
                  'ë¬¼ì²˜ëŸ¼ ìœ ì—°í•˜ê³  ê¹Šì€ ì§€í˜œì˜ ê¸°ìš´ì„ íƒ€ê³  ë‚¬ì–´ìš”.'}
                <br>
                ${maxEl === minEl ? 'ì˜¤í–‰ì´ ê³ ë¥´ê²Œ ì¡í˜€ìˆì–´ ê· í˜• ì¡íŒ íŒ”ìì˜ˆìš”!' :
                  `<strong style="color:${ELEMENT_COLORS[maxEl]}">${EL_SHAMAN[maxEl]}</strong> ê¸°ìš´ì´ ê°•í•˜ê³  <strong style="color:${ELEMENT_COLORS[minEl]}">${EL_SHAMAN[minEl]}</strong> ê¸°ìš´ì´ ì•½í•˜ë‹ˆ, ë³´ì¶©ì´ í•„ìš”í•´ìš”!`}
            </div>
        </div>
    </div>`;

    // 2. ì „ìƒ ë¶„ì„
    html += `<div style="background:#1c1917;border:1px solid #78716c;border-radius:14px;padding:22px;margin-bottom:16px;">
        <div style="font-size:16px;font-weight:700;color:#fbbf24;margin-bottom:12px;">ğŸ•¯ï¸ ì „ìƒ(å‰ç”Ÿ) â€” ë‹¹ì‹ ì˜ ì „ìƒì€...</div>
        <div style="background:#292524;border-radius:10px;padding:16px;margin-bottom:12px;">
            <div style="font-size:20px;font-weight:700;color:#fcd34d;margin-bottom:8px;font-family:'Noto Serif KR',serif;">"ë‹¹ì‹ ì€ ì „ìƒì— ${js.life}ì´ì…¨ìŠµë‹ˆë‹¤"</div>
            <div style="font-size:14px;color:#d6d3d1;line-height:1.8;">${js.desc}</div>
        </div>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;">
            <div style="background:#292524;border-radius:10px;padding:14px;">
                <div style="font-size:12px;color:#a8a29e;margin-bottom:4px;">âš–ï¸ ì „ìƒì˜ ì—…(æ¥­)</div>
                <div style="font-size:13px;color:#fca5a5;line-height:1.7;">${js.karma}</div>
            </div>
            <div style="background:#292524;border-radius:10px;padding:14px;">
                <div style="font-size:12px;color:#a8a29e;margin-bottom:4px;">ğŸ’« í•´ì†Œë²•</div>
                <div style="font-size:13px;color:#86efac;line-height:1.7;">${js.cure}</div>
            </div>
        </div>
    </div>`;

    // 3. ìˆ˜í˜¸ì‹ 
    html += `<div style="background:#1c1917;border:1px solid #78716c;border-radius:14px;padding:22px;margin-bottom:16px;">
        <div style="font-size:16px;font-weight:700;color:#fbbf24;margin-bottom:12px;">ğŸ›¡ï¸ ë‹¹ì‹ ì˜ ìˆ˜í˜¸ì‹ (å®ˆè­·ç¥)</div>
        <div style="background:#292524;border-radius:10px;padding:20px;text-align:center;">
            <div style="font-size:42px;margin-bottom:8px;">${suho.emoji}</div>
            <div style="font-size:22px;font-weight:700;color:#c4b5fd;font-family:'Noto Serif KR',serif;margin-bottom:10px;">${suho.name}</div>
            <div style="font-size:14px;color:#d6d3d1;line-height:1.7;margin-bottom:12px;">${suho.desc}</div>
            <div style="font-size:13px;color:#86efac;background:#1a2e1a;border-radius:8px;padding:10px;display:inline-block;">ğŸ“ ${suho.where}</div>
        </div>
    </div>`;

    // 4. ì‚´(ç…) ë¶„ì„
    html += `<div style="background:#1c1917;border:1px solid #78716c;border-radius:14px;padding:22px;margin-bottom:16px;">
        <div style="font-size:16px;font-weight:700;color:#fbbf24;margin-bottom:12px;">âš¡ ì‚´(ç…) ë¶„ì„ â€” ì¡°ì‹¬í•´ì•¼ í•  ê¸°ìš´</div>`;
    activeSsal.forEach(s => {
        html += `<div style="background:#292524;border:1px solid #44403c;border-radius:10px;padding:16px;margin-bottom:10px;">
            <div style="font-size:15px;font-weight:600;color:#fcd34d;margin-bottom:8px;">${s.icon} ${s.name}</div>
            <div style="font-size:13px;color:#d6d3d1;line-height:1.7;margin-bottom:8px;">${s.desc}</div>
            <div style="font-size:13px;color:#86efac;line-height:1.7;">ğŸ’¡ <strong>í•´ê²°ë²•:</strong> ${s.cure}</div>
        </div>`;
    });
    html += `</div>`;

    // 5. ì‹ ìˆ˜ ì ìˆ˜
    html += `<div style="background:#1c1917;border:1px solid #78716c;border-radius:14px;padding:22px;margin-bottom:16px;">
        <div style="font-size:16px;font-weight:700;color:#fbbf24;margin-bottom:4px;">ğŸ“Š ì‹ ìˆ˜(ç¥æ•¸) â€” ìš´ì„¸ ì ìˆ˜</div>
        <div style="text-align:center;margin:16px 0;">
            <div style="display:inline-block;width:90px;height:90px;border-radius:50%;border:3px solid ${totalScore >= 75 ? '#22c55e' : totalScore >= 60 ? '#eab308' : '#ef4444'};display:flex;align-items:center;justify-content:center;flex-direction:column;">
                <div style="font-size:32px;font-weight:900;color:${totalScore >= 75 ? '#22c55e' : totalScore >= 60 ? '#eab308' : '#ef4444'}">${totalScore}</div>
                <div style="font-size:10px;color:#a8a29e">${totalScore >= 85 ? 'ëŒ€í†µ' : totalScore >= 75 ? 'ìƒê¸¸' : totalScore >= 65 ? 'ì¤‘ê¸¸' : totalScore >= 55 ? 'ì†Œê¸¸' : 'ì£¼ì˜'}</div>
            </div>
        </div>`;
    areaScores.forEach((score, i) => {
        const pct = score;
        const color = score >= 80 ? '#22c55e' : score >= 65 ? '#eab308' : '#ef4444';
        html += `<div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
            <div style="width:70px;font-size:13px;color:#d6d3d1;flex-shrink:0;">${AREA_EMOJIS[i]} ${AREAS[i]}</div>
            <div style="flex:1;background:#292524;border-radius:6px;height:18px;overflow:hidden;">
                <div style="width:${pct}%;height:100%;background:${color};border-radius:6px;transition:width 0.5s;"></div>
            </div>
            <div style="width:30px;font-size:13px;color:${color};font-weight:600;text-align:right;">${score}</div>
        </div>`;
    });
    html += `</div>`;

    // 6. ì˜¬í•´ ìš´ì„¸ (ì‹ ì  ë§íˆ¬)
    html += `<div style="background:linear-gradient(135deg, #1a0a2e 0%, #2d1b4e 50%, #1a0a2e 100%);border:2px solid #8b5cf6;border-radius:14px;padding:22px;margin-bottom:16px;position:relative;overflow:hidden;">
        <div style="position:absolute;top:0;left:0;right:0;bottom:0;background:radial-gradient(circle at 80% 30%, rgba(139,92,246,0.12) 0%, transparent 50%);pointer-events:none;"></div>
        <div style="position:relative;z-index:1;">
            <div style="font-size:16px;font-weight:700;color:#c4b5fd;margin-bottom:12px;">ğŸ—“ï¸ 2026ë…„ ë³‘ì˜¤(ä¸™åˆ)ë…„ ì‹ ì  ìš´ì„¸</div>
            <div style="font-size:15px;color:#e9d5ff;line-height:2;font-family:'Noto Serif KR',serif;">
                "ì–´í—ˆ, ${genderKo}! ${yearFortunes[yearFortuneIdx]}"
            </div>
            <div style="margin-top:14px;font-size:13px;color:#d8b4fe;line-height:1.8;">
                ${totalScore >= 70 ? `"ì˜¬í•´ ìš´ì´ ê½¤ ì¢‹ì•„ìš”! í•˜ì§€ë§Œ ë°©ì‹¬í•˜ë©´ ì•ˆ ë©ë‹ˆë‹¤. íŠ¹íˆ ${AREAS[areaScores.indexOf(Math.min(...areaScores))]}ì´ ì•½í•˜ë‹ˆ ê±°ê¸°ë¥¼ ì±™ê¸°ì„¸ìš”!"` :
                `"ì˜¬í•´ ì¢€ í˜ë“¤ ìˆ˜ ìˆì–´ìš”... í•˜ì§€ë§Œ ê±±ì • ë§ˆì„¸ìš”! ${AREAS[areaScores.indexOf(Math.max(...areaScores))]}ì´ ê°•í•˜ë‹ˆ, ê·¸ìª½ì— ì§‘ì¤‘í•˜ë©´ ê¸¸ì´ ì—´ë¦½ë‹ˆë‹¤!"`}
            </div>
        </div>
    </div>`;

    // 7. ê°œìš´ë²• (ì²˜ë°©)
    html += `<div style="background:#1c1917;border:1px solid #78716c;border-radius:14px;padding:22px;margin-bottom:16px;">
        <div style="font-size:16px;font-weight:700;color:#fbbf24;margin-bottom:12px;">ğŸ€ ê°œìš´ë²•(é–‹é‹æ³•) â€” ìš´ì„ ì—¬ëŠ” ë¹„ë²•</div>
        <div style="background:#292524;border-radius:10px;padding:16px;margin-bottom:12px;">
            <div style="font-size:14px;font-weight:600;color:#86efac;margin-bottom:6px;">ğŸŒ¿ ë¶€ì¡±í•œ ${EL_SHAMAN[minEl]}(${ELEMENT_NAMES[minEl]}) ê¸°ìš´ ë³´ì¶©ë²•</div>
            <div style="font-size:13px;color:#d6d3d1;line-height:1.8;">${needGaeun.text}</div>
        </div>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;">
            <div style="background:#292524;border-radius:10px;padding:14px;">
                <div style="font-size:13px;font-weight:600;color:#fcd34d;margin-bottom:6px;">ğŸ”¢ í–‰ìš´ì˜ ìˆ«ì</div>
                <div style="font-size:13px;color:#d6d3d1;">${[minEl*2+1, dayGanIdx+3, (dayJiIdx+5)%10+1].join(', ')}</div>
            </div>
            <div style="background:#292524;border-radius:10px;padding:14px;">
                <div style="font-size:13px;font-weight:600;color:#fcd34d;margin-bottom:6px;">ğŸ¨ í–‰ìš´ì˜ ìƒ‰ìƒ</div>
                <div style="font-size:13px;color:#d6d3d1;">${['ì´ˆë¡/ì²­ìƒ‰','ë¹¨ê°•/ìì£¼','ë…¸ë‘/ê°ˆìƒ‰','í°ìƒ‰/ì€ìƒ‰','ê²€ì •/ë‚¨ìƒ‰'][minEl]}</div>
            </div>
            <div style="background:#292524;border-radius:10px;padding:14px;">
                <div style="font-size:13px;font-weight:600;color:#fcd34d;margin-bottom:6px;">ğŸ§­ í–‰ìš´ì˜ ë°©í–¥</div>
                <div style="font-size:13px;color:#d6d3d1;">${['ë™ìª½','ë‚¨ìª½','ì¤‘ì•™','ì„œìª½','ë¶ìª½'][minEl]}</div>
            </div>
            <div style="background:#292524;border-radius:10px;padding:14px;">
                <div style="font-size:13px;font-weight:600;color:#fcd34d;margin-bottom:6px;">ğŸ½ï¸ í–‰ìš´ì˜ ìŒì‹</div>
                <div style="font-size:13px;color:#d6d3d1;">${['í‘¸ë¥¸ ì±„ì†Œ, ì‹ ë§› ìŒì‹','ê³ ì¶”, ì“´ë§› ìŒì‹','ê³¡ë¥˜, ë‹¨ë§› ìŒì‹','ë¬´, ë§¤ìš´ë§› ìŒì‹','í•´ì‚°ë¬¼, ì§ ë§› ìŒì‹'][minEl]}</div>
            </div>
        </div>
    </div>`;

    // 8. ë§ˆë¬´ë¦¬ (ë¬´ì†ì¸ ë§íˆ¬)
    html += `<div style="background:linear-gradient(135deg, #1a0a2e 0%, #2d1b4e 50%, #1a0a2e 100%);border:2px solid #8b5cf6;border-radius:14px;padding:24px;text-align:center;position:relative;overflow:hidden;">
        <div style="position:absolute;top:0;left:0;right:0;bottom:0;background:radial-gradient(circle at 50% 50%, rgba(139,92,246,0.1) 0%, transparent 60%);pointer-events:none;"></div>
        <div style="position:relative;z-index:1;">
            <div style="font-size:24px;margin-bottom:10px;">ğŸ™âœ¨ğŸ”®âœ¨ğŸ™</div>
            <div style="font-size:16px;color:#c4b5fd;font-family:'Noto Serif KR',serif;line-height:2;">
                "${genderKo}, ì‚¬ì£¼íŒ”ìê°€ ë‹¤ê°€ ì•„ë‹ˆì—ìš”!<br>
                íƒ€ê³ ë‚œ ìš´ëª…ì€ 30%, ë‚˜ë¨¸ì§€ 70%ëŠ” ìê¸° í•˜ê¸° ë‚˜ë¦„ì´ì—ìš”.<br>
                ì¢‹ì€ ë§ˆìŒ ë¨¹ê³ , ì°©í•˜ê²Œ ì‚´ë©´ ì‹ ì´ ë„ì™€ì¤ë‹ˆë‹¤.<br>
                <span style="color:#fbbf24;font-weight:700;">ë§Œì‚¬í˜•í†µí•˜ì‹œê¸¸ ë¹•ë‹ˆë‹¤~ ğŸ™</span>"
            </div>
        </div>
    </div>`;

    section.innerHTML = html;
}
</script>

</body>
</html>
