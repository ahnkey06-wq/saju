<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ì‚¬ì£¼íŒ”ì ë¶„ì„ Â· å››æŸ±å…«å­—</title>
<meta name="description" content="ìƒë…„ì›”ì¼ì‹œë¥¼ ì…ë ¥í•˜ë©´ ì‚¬ì£¼íŒ”ì(å››æŸ±å…«å­—)ë¥¼ ìë™ ê³„ì‚°í•˜ê³  ì˜¤í–‰ ë¶„ì„, ì„±ê²©, ìš´ì„¸ë¥¼ ì•Œë ¤ë“œë¦½ë‹ˆë‹¤.">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700;900&family=Noto+Serif+KR:wght@400;500;600;700;900&display=swap" rel="stylesheet">
<style>
:root {
    --bg: #1a1410;
    --bg-light: #2a2218;
    --bg-card: #332a1f;
    --bg-card-light: #3d3225;
    --border: #5a4a35;
    --border-light: #7a6a50;
    --gold: #d4a543;
    --gold-light: #e8c468;
    --gold-dark: #b08930;
    --red: #c44040;
    --red-light: #e06060;
    --text: #f0e6d6;
    --text-secondary: #bfb09a;
    --text-muted: #8a7a65;
    --wood: #4a9e5e;
    --fire: #d45050;
    --earth: #c4a042;
    --metal: #c0c0c0;
    --water: #4a7ec4;
}
* { margin:0; padding:0; box-sizing:border-box; }
body {
    font-family: 'Noto Sans KR', sans-serif;
    background: var(--bg);
    color: var(--text);
    min-height: 100vh;
    background-image:
        radial-gradient(ellipse at 20% 50%, rgba(212,165,67,0.03) 0%, transparent 50%),
        radial-gradient(ellipse at 80% 50%, rgba(196,64,64,0.03) 0%, transparent 50%);
}
.serif { font-family: 'Noto Serif KR', serif; }

/* Header */
.header {
    text-align: center;
    padding: 48px 20px 32px;
    position: relative;
}
.header::after {
    content: '';
    display: block;
    width: 120px;
    height: 2px;
    background: linear-gradient(90deg, transparent, var(--gold), transparent);
    margin: 24px auto 0;
}
.header-hanja {
    font-size: 14px;
    color: var(--gold);
    letter-spacing: 12px;
    margin-bottom: 8px;
}
.header h1 {
    font-family: 'Noto Serif KR', serif;
    font-size: 36px;
    font-weight: 700;
    color: var(--text);
    letter-spacing: 4px;
}
.header h1 span { color: var(--gold); }
.header-sub {
    font-size: 14px;
    color: var(--text-muted);
    margin-top: 8px;
}

/* Container */
.container {
    max-width: 800px;
    margin: 0 auto;
    padding: 0 20px 80px;
}

/* Input Section */
.input-section {
    background: var(--bg-card);
    border: 1px solid var(--border);
    border-radius: 16px;
    padding: 32px;
    margin-top: 32px;
    position: relative;
}
.input-section::before {
    content: 'â˜°';
    position: absolute;
    top: -14px;
    left: 50%;
    transform: translateX(-50%);
    background: var(--bg-card);
    color: var(--gold);
    padding: 0 16px;
    font-size: 20px;
}
.section-title {
    font-family: 'Noto Serif KR', serif;
    font-size: 20px;
    font-weight: 600;
    text-align: center;
    margin-bottom: 24px;
    color: var(--gold-light);
}
.form-row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 16px;
    margin-bottom: 16px;
}
.form-group {
    display: flex;
    flex-direction: column;
    gap: 6px;
}
.form-group.full {
    grid-column: 1 / -1;
}
.form-label {
    font-size: 13px;
    color: var(--text-secondary);
    font-weight: 500;
}
.form-input {
    background: var(--bg-light);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 12px 16px;
    color: var(--text);
    font-size: 15px;
    font-family: 'Noto Sans KR', sans-serif;
    outline: none;
    transition: all 0.3s;
    -webkit-appearance: none;
}
.form-input:focus {
    border-color: var(--gold);
    box-shadow: 0 0 0 3px rgba(212,165,67,0.15);
}
select.form-input {
    cursor: pointer;
}
.gender-row {
    display: flex;
    gap: 12px;
}
.gender-btn {
    flex: 1;
    padding: 12px;
    background: var(--bg-light);
    border: 1px solid var(--border);
    border-radius: 10px;
    color: var(--text-secondary);
    font-size: 15px;
    cursor: pointer;
    transition: all 0.3s;
    text-align: center;
    font-family: 'Noto Sans KR', sans-serif;
}
.gender-btn:hover { border-color: var(--gold); }
.gender-btn.active {
    background: rgba(212,165,67,0.15);
    border-color: var(--gold);
    color: var(--gold-light);
    font-weight: 600;
}
.submit-btn {
    display: block;
    width: 100%;
    padding: 16px;
    margin-top: 24px;
    background: linear-gradient(135deg, var(--gold-dark), var(--gold));
    border: none;
    border-radius: 12px;
    color: #1a1410;
    font-size: 17px;
    font-weight: 700;
    font-family: 'Noto Serif KR', serif;
    cursor: pointer;
    transition: all 0.3s;
    letter-spacing: 4px;
}
.submit-btn:hover {
    background: linear-gradient(135deg, var(--gold), var(--gold-light));
    transform: translateY(-1px);
    box-shadow: 0 4px 20px rgba(212,165,67,0.3);
}
.submit-btn:active { transform: translateY(0); }

/* Result Section */
#result { display: none; margin-top: 32px; }

/* Saju Pillars */
.pillars-card {
    background: var(--bg-card);
    border: 1px solid var(--border);
    border-radius: 16px;
    padding: 28px;
    text-align: center;
}
.pillars-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 12px;
    margin-top: 20px;
}
.pillar {
    background: var(--bg-light);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 16px 8px;
    transition: all 0.3s;
}
.pillar:hover {
    border-color: var(--gold);
    transform: translateY(-2px);
}
.pillar-label {
    font-size: 12px;
    color: var(--text-muted);
    margin-bottom: 4px;
}
.pillar-hanja {
    font-size: 11px;
    color: var(--text-muted);
}
.pillar-char {
    font-family: 'Noto Serif KR', serif;
    font-size: 36px;
    font-weight: 700;
    line-height: 1.2;
    margin: 6px 0;
}
.pillar-name {
    font-size: 13px;
    color: var(--text-secondary);
    margin-top: 2px;
}
.pillar-element {
    display: inline-block;
    font-size: 11px;
    padding: 2px 8px;
    border-radius: 6px;
    margin-top: 6px;
    font-weight: 500;
}
.el-wood { background: rgba(74,158,94,0.2); color: var(--wood); }
.el-fire { background: rgba(212,80,80,0.2); color: var(--fire); }
.el-earth { background: rgba(196,160,66,0.2); color: var(--earth); }
.el-metal { background: rgba(192,192,192,0.2); color: var(--metal); }
.el-water { background: rgba(74,126,196,0.2); color: var(--water); }
.divider {
    width: 100%;
    height: 1px;
    background: var(--border);
    margin: 8px 0;
}

/* Ohaeng (Five Elements) */
.ohaeng-card {
    background: var(--bg-card);
    border: 1px solid var(--border);
    border-radius: 16px;
    padding: 28px;
    margin-top: 16px;
}
.ohaeng-bars {
    display: flex;
    flex-direction: column;
    gap: 14px;
    margin-top: 20px;
}
.ohaeng-row {
    display: flex;
    align-items: center;
    gap: 12px;
}
.ohaeng-label {
    width: 60px;
    font-size: 14px;
    font-weight: 600;
    text-align: right;
    flex-shrink: 0;
}
.ohaeng-bar-bg {
    flex: 1;
    height: 28px;
    background: var(--bg-light);
    border-radius: 8px;
    overflow: hidden;
    position: relative;
}
.ohaeng-bar {
    height: 100%;
    border-radius: 8px;
    transition: width 1s ease-out;
    display: flex;
    align-items: center;
    padding-left: 10px;
    font-size: 12px;
    font-weight: 600;
    color: #fff;
    min-width: 30px;
}
.bar-wood { background: linear-gradient(90deg, #3a7e4e, #5abe72); }
.bar-fire { background: linear-gradient(90deg, #b03030, #e05050); }
.bar-earth { background: linear-gradient(90deg, #a08030, #c4a042); }
.bar-metal { background: linear-gradient(90deg, #808080, #b0b0b0); }
.bar-water { background: linear-gradient(90deg, #3a5ea0, #5a8ed4); }
.ohaeng-count {
    width: 28px;
    font-size: 14px;
    font-weight: 700;
    text-align: center;
    flex-shrink: 0;
}

/* Analysis Cards */
.analysis-card {
    background: var(--bg-card);
    border: 1px solid var(--border);
    border-radius: 16px;
    padding: 28px;
    margin-top: 16px;
}
.analysis-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
    margin-top: 16px;
}
.analysis-item {
    background: var(--bg-light);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 16px;
}
.analysis-item-title {
    font-size: 13px;
    color: var(--gold);
    font-weight: 600;
    margin-bottom: 6px;
}
.analysis-item-text {
    font-size: 14px;
    color: var(--text-secondary);
    line-height: 1.6;
}
.personality-text {
    margin-top: 16px;
    font-size: 15px;
    color: var(--text-secondary);
    line-height: 1.8;
    padding: 20px;
    background: var(--bg-light);
    border-radius: 12px;
    border-left: 3px solid var(--gold);
}

/* Ilgan Box */
.ilgan-box {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 20px;
    margin-top: 16px;
    padding: 20px;
    background: var(--bg-light);
    border-radius: 12px;
    border: 1px solid var(--border);
}
.ilgan-char {
    font-family: 'Noto Serif KR', serif;
    font-size: 48px;
    font-weight: 900;
}
.ilgan-info h3 {
    font-size: 18px;
    font-weight: 700;
    margin-bottom: 4px;
}
.ilgan-info p {
    font-size: 14px;
    color: var(--text-secondary);
}

/* Footer */
.footer {
    text-align: center;
    padding: 32px 20px;
    color: var(--text-muted);
    font-size: 12px;
    border-top: 1px solid var(--border);
    margin-top: 48px;
}
.footer-hanja {
    font-family: 'Noto Serif KR', serif;
    font-size: 14px;
    color: var(--border-light);
    letter-spacing: 8px;
    margin-bottom: 8px;
}

/* Responsive */
@media (max-width: 640px) {
    .header h1 { font-size: 28px; }
    .form-row { grid-template-columns: 1fr; }
    .pillars-grid { grid-template-columns: repeat(4, 1fr); gap: 6px; }
    .pillar { padding: 12px 4px; }
    .pillar-char { font-size: 28px; }
    .analysis-grid { grid-template-columns: 1fr; }
    .input-section, .pillars-card, .ohaeng-card, .analysis-card { padding: 20px; }
    .ilgan-char { font-size: 36px; }
}
</style>
</head>
<body>

<header class="header">
    <div class="header-hanja serif">å›› æŸ± å…« å­—</div>
    <h1 class="serif">ì‚¬ì£¼<span>íŒ”ì</span> ë¶„ì„</h1>
    <div class="header-sub">ìƒë…„ì›”ì¼ì‹œë¥¼ ì…ë ¥í•˜ë©´ ë‹¹ì‹ ì˜ ì‚¬ì£¼íŒ”ìë¥¼ í’€ì–´ë“œë¦½ë‹ˆë‹¤</div>
</header>

<main class="container">
    <!-- Input Form -->
    <section class="input-section">
        <div class="section-title serif">ìƒë…„ì›”ì¼ì‹œ ì…ë ¥</div>
        <div class="form-row">
            <div class="form-group">
                <label class="form-label">ì–‘ë ¥ / ìŒë ¥</label>
                <select id="calType" class="form-input">
                    <option value="solar">ì–‘ë ¥ (é™½æ›†)</option>
                    <option value="lunar">ìŒë ¥ (é™°æ›†)</option>
                </select>
            </div>
            <div class="form-group">
                <label class="form-label">ì„±ë³„</label>
                <div class="gender-row">
                    <button type="button" class="gender-btn active" data-gender="male" onclick="selectGender(this)">â™‚ ë‚¨ì„±</button>
                    <button type="button" class="gender-btn" data-gender="female" onclick="selectGender(this)">â™€ ì—¬ì„±</button>
                </div>
            </div>
        </div>
        <div class="form-row">
            <div class="form-group">
                <label class="form-label">ì¶œìƒë…„ë„</label>
                <select id="year" class="form-input"></select>
            </div>
            <div class="form-group">
                <label class="form-label">ì¶œìƒì›”</label>
                <select id="month" class="form-input"></select>
            </div>
        </div>
        <div class="form-row">
            <div class="form-group">
                <label class="form-label">ì¶œìƒì¼</label>
                <select id="day" class="form-input"></select>
            </div>
            <div class="form-group">
                <label class="form-label">ì¶œìƒì‹œê°„</label>
                <select id="hour" class="form-input">
                    <option value="-1">ëª¨ë¦„</option>
                    <option value="0">å­ì‹œ (23:00~01:00)</option>
                    <option value="1">ä¸‘ì‹œ (01:00~03:00)</option>
                    <option value="2">å¯…ì‹œ (03:00~05:00)</option>
                    <option value="3">å¯ì‹œ (05:00~07:00)</option>
                    <option value="4">è¾°ì‹œ (07:00~09:00)</option>
                    <option value="5">å·³ì‹œ (09:00~11:00)</option>
                    <option value="6">åˆì‹œ (11:00~13:00)</option>
                    <option value="7">æœªì‹œ (13:00~15:00)</option>
                    <option value="8">ç”³ì‹œ (15:00~17:00)</option>
                    <option value="9">é…‰ì‹œ (17:00~19:00)</option>
                    <option value="10">æˆŒì‹œ (19:00~21:00)</option>
                    <option value="11">äº¥ì‹œ (21:00~23:00)</option>
                </select>
            </div>
        </div>
        <button class="submit-btn" onclick="analyze()">ì‚¬ ì£¼ ë¶„ ì„</button>
    </section>

    <!-- Result -->
    <div id="result">
        <!-- Ilgan (Day Master) -->
        <section class="analysis-card" id="ilganSection">
            <div class="section-title serif">ğŸ”® ì¼ê°„ (æ—¥å¹²) â€” ë‚˜ì˜ ë³¸ì§ˆ</div>
            <div id="ilganBox" class="ilgan-box"></div>
        </section>

        <!-- Four Pillars -->
        <section class="pillars-card" id="pillarsSection">
            <div class="section-title serif">å››æŸ±å…«å­— â€” ì‚¬ì£¼íŒ”ì</div>
            <div class="pillars-grid" id="pillarsGrid"></div>
        </section>

        <!-- Five Elements -->
        <section class="ohaeng-card" id="ohaengSection">
            <div class="section-title serif">äº”è¡Œ â€” ì˜¤í–‰ ë¶„ì„</div>
            <div class="ohaeng-bars" id="ohaengBars"></div>
        </section>

        <!-- Personality -->
        <section class="analysis-card" id="personalitySection">
            <div class="section-title serif">æ€§æ ¼ â€” ì„±ê²© ë¶„ì„</div>
            <div id="personalityText" class="personality-text"></div>
        </section>

        <!-- Detailed Analysis -->
        <section class="analysis-card" id="detailSection">
            <div class="section-title serif">å‘½ç† â€” ìƒì„¸ ë¶„ì„</div>
            <div class="analysis-grid" id="detailGrid"></div>
        </section>
    </div>
</main>

<footer class="footer">
    <div class="footer-hanja serif">å‘½ ç† å­¸</div>
    <p>ë³¸ ì‚¬ì´íŠ¸ì˜ ì‚¬ì£¼ ë¶„ì„ì€ ì°¸ê³ ìš©ì´ë©°, ì „ë¬¸ ì—­í•™ì¸ì˜ ìƒë‹´ì„ ëŒ€ì²´í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>
    <p style="margin-top:4px;">Â© 2025 ì‚¬ì£¼íŒ”ì ë¶„ì„ Â· å››æŸ±å…«å­—</p>
</footer>

<script>
// ===== ì²œê°„(å¤©å¹²) & ì§€ì§€(åœ°æ”¯) ë°ì´í„° =====
const CHEONGAN = ['ê°‘','ì„','ë³‘','ì •','ë¬´','ê¸°','ê²½','ì‹ ','ì„','ê³„'];
const CHEONGAN_HANJA = ['ç”²','ä¹™','ä¸™','ä¸','æˆŠ','å·±','åºš','è¾›','å£¬','ç™¸'];
const JIJI = ['ì','ì¶•','ì¸','ë¬˜','ì§„','ì‚¬','ì˜¤','ë¯¸','ì‹ ','ìœ ','ìˆ ','í•´'];
const JIJI_HANJA = ['å­','ä¸‘','å¯…','å¯','è¾°','å·³','åˆ','æœª','ç”³','é…‰','æˆŒ','äº¥'];

// ì˜¤í–‰ ë§¤í•‘
const CHEONGAN_ELEMENT = [0,0,1,1,2,2,3,3,4,4]; // ëª©,ëª©,í™”,í™”,í† ,í† ,ê¸ˆ,ê¸ˆ,ìˆ˜,ìˆ˜
const JIJI_ELEMENT = [4,2,0,0,2,1,1,2,3,3,2,4]; // ìˆ˜,í† ,ëª©,ëª©,í† ,í™”,í™”,í† ,ê¸ˆ,ê¸ˆ,í† ,ìˆ˜
const ELEMENT_NAMES = ['ëª©(æœ¨)','í™”(ç«)','í† (åœŸ)','ê¸ˆ(é‡‘)','ìˆ˜(æ°´)'];
const ELEMENT_COLORS = ['var(--wood)','var(--fire)','var(--earth)','var(--metal)','var(--water)'];
const ELEMENT_CLASSES = ['el-wood','el-fire','el-earth','el-metal','el-water'];
const BAR_CLASSES = ['bar-wood','bar-fire','bar-earth','bar-metal','bar-water'];
const ELEMENT_SHORT = ['æœ¨','ç«','åœŸ','é‡‘','æ°´'];

// ìŒì–‘
const CHEONGAN_YINYANG = ['ì–‘','ìŒ','ì–‘','ìŒ','ì–‘','ìŒ','ì–‘','ìŒ','ì–‘','ìŒ'];

// ì‹œê°„ ì²œê°„ ê³„ì‚° (ì¼ê°„ ê¸°ì¤€)
function getHourGan(dayGanIdx, hourIdx) {
    const base = (dayGanIdx % 5) * 2;
    return (base + hourIdx) % 10;
}

// ===== ë§Œì„¸ë ¥ ê³„ì‚° (ê°„ì†Œí™”) =====
// ê¸°ì¤€ì¼: 1900ë…„ 1ì›” 31ì¼ = ê²½ì(åºšå­)ë…„ ì •ì¶•(ä¸ä¸‘)ì›” ê°‘ì§„(ç”²è¾°)ì¼
// Julian Day Number ê¸°ë°˜ ê³„ì‚°

function solarToJDN(y, m, d) {
    const a = Math.floor((14 - m) / 12);
    const yy = y + 4800 - a;
    const mm = m + 12 * a - 3;
    return d + Math.floor((153 * mm + 2) / 5) + 365 * yy + Math.floor(yy / 4) - Math.floor(yy / 100) + Math.floor(yy / 400) - 32045;
}

// ì ˆê¸°(ç¯€æ°£) ê¸°ë°˜ ì›”ì£¼ ê³„ì‚° - ê°„ì†Œí™”ëœ ì ˆê¸° ì‹œì‘ì¼
// ê° ì›”ì˜ ì ˆê¸° ì‹œì‘ì¼ (ì–‘ë ¥ ê¸°ì¤€ ëŒ€ëµì )
const JEOLGI_DATES = [
    [2, 4],   // 1ì›”(ì¸ì›”): ì…ì¶˜ ~2/4
    [3, 6],   // 2ì›”(ë¬˜ì›”): ê²½ì¹© ~3/6
    [4, 5],   // 3ì›”(ì§„ì›”): ì²­ëª… ~4/5
    [5, 6],   // 4ì›”(ì‚¬ì›”): ì…í•˜ ~5/6
    [6, 6],   // 5ì›”(ì˜¤ì›”): ë§ì¢… ~6/6
    [7, 7],   // 6ì›”(ë¯¸ì›”): ì†Œì„œ ~7/7
    [8, 7],   // 7ì›”(ì‹ ì›”): ì…ì¶” ~8/7
    [9, 8],   // 8ì›”(ìœ ì›”): ë°±ë¡œ ~9/8
    [10, 8],  // 9ì›”(ìˆ ì›”): í•œë¡œ ~10/8
    [11, 7],  // 10ì›”(í•´ì›”): ì…ë™ ~11/7
    [12, 7],  // 11ì›”(ìì›”): ëŒ€ì„¤ ~12/7
    [1, 5],   // 12ì›”(ì¶•ì›”): ì†Œí•œ ~1/5
];

function getMonthPillar(yearGanIdx, solarMonth, solarDay) {
    // ì ˆê¸° ê¸°ì¤€ìœ¼ë¡œ ì›” ê²°ì •
    let monthIdx = -1; // ì¸ì›”=0 (1ì›”), ë¬˜ì›”=1 (2ì›”), ...
    for (let i = 0; i < 12; i++) {
        const [jm, jd] = JEOLGI_DATES[i];
        if (solarMonth === jm && solarDay >= jd) {
            monthIdx = i;
        } else if (solarMonth === jm && solarDay < jd) {
            monthIdx = (i + 11) % 12;
        }
    }
    if (monthIdx === -1) {
        // í•´ë‹¹ ì›”ì˜ ì ˆê¸° ê¸°ë°˜
        for (let i = 0; i < 12; i++) {
            const [jm, jd] = JEOLGI_DATES[i];
            if (solarMonth === jm) {
                monthIdx = solarDay >= jd ? i : (i + 11) % 12;
                break;
            }
        }
    }
    if (monthIdx === -1) monthIdx = (solarMonth + 9) % 12;

    // ì›” ì²œê°„: ì—°ê°„ ê¸°ì¤€
    const monthGanBase = (yearGanIdx % 5) * 2 + 2;
    const monthGan = (monthGanBase + monthIdx) % 10;
    // ì›” ì§€ì§€: ì¸(2)ë¶€í„°
    const monthJi = (monthIdx + 2) % 12;

    return { gan: monthGan, ji: monthJi };
}

// ì—°ì£¼ ê³„ì‚°
function getYearPillar(year, solarMonth, solarDay) {
    // ì…ì¶˜(2/4) ì „ì´ë©´ ì „ë…„ë„
    let adjYear = year;
    if (solarMonth < 2 || (solarMonth === 2 && solarDay < 4)) {
        adjYear = year - 1;
    }
    const ganIdx = (adjYear - 4) % 10;
    const jiIdx = (adjYear - 4) % 12;
    return { gan: (ganIdx + 10) % 10, ji: (jiIdx + 12) % 12 };
}

// ì¼ì£¼ ê³„ì‚° (JDN ê¸°ì¤€)
function getDayPillar(y, m, d) {
    const jdn = solarToJDN(y, m, d);
    // ê¸°ì¤€: JDN 2451911 = 2001-01-01 = ë¬´ì˜¤(æˆŠåˆ)ì¼
    // æˆŠ=4, åˆ=6
    const diff = jdn - 2451911;
    const ganIdx = ((diff % 10) + 4 + 100) % 10;
    const jiIdx = ((diff % 12) + 6 + 120) % 12;
    return { gan: ganIdx, ji: jiIdx };
}

// ===== ì¼ê°„ë³„ ì„±ê²© & ë¶„ì„ =====
const ILGAN_DATA = {
    0: { name: 'ê°‘ëª©(ç”²æœ¨)', symbol: 'ğŸŒ³', nature: 'í° ë‚˜ë¬´, ëŒ€ë“¤ë³´',
        personality: 'ì •ì˜ê°ì´ ê°•í•˜ê³  ê³§ì€ ì„±í’ˆì˜ ì†Œìœ ìì…ë‹ˆë‹¤. ë¦¬ë”ì‹­ì´ ë›°ì–´ë‚˜ë©° í° ëœ»ì„ í’ˆê³  ìˆìŠµë‹ˆë‹¤. ìš°ì§í•˜ê³  ì±…ì„ê°ì´ ê°•í•˜ì§€ë§Œ, ë•Œë¡œëŠ” ê³ ì§‘ì´ ì„¸ê³  ìœ ì—°ì„±ì´ ë¶€ì¡±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í° ë‚˜ë¬´ì²˜ëŸ¼ í•œ ê³³ì— ë¿Œë¦¬ë¥¼ ë‚´ë¦¬ë©´ í”ë“¤ë¦¬ì§€ ì•ŠëŠ” ëˆê¸°ê°€ ìˆìŠµë‹ˆë‹¤.',
        career: 'ê²½ì˜ì, ì •ì¹˜ì¸, êµìœ¡ì, ë²•ì¡°ì¸',
        love: 'í—Œì‹ ì ì´ë©° í•œë²ˆ ë§ˆìŒì„ ì£¼ë©´ ë³€í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤',
        health: 'ê°„(è‚), ë‹´(è†½) ì£¼ì˜',
        lucky: 'ë´„(æ˜¥), ë™ìª½(æ±)' },
    1: { name: 'ì„ëª©(ä¹™æœ¨)', symbol: 'ğŸŒ¿', nature: 'í’€, ë„ì¿¨, ê½ƒ',
        personality: 'ë¶€ë“œëŸ½ê³  ìœ ì—°í•œ ì„±í’ˆìœ¼ë¡œ ì ì‘ë ¥ì´ ë›°ì–´ë‚©ë‹ˆë‹¤. ì˜ˆìˆ ì  ê°ê°ì´ íƒì›”í•˜ë©° ì„¬ì„¸í•œ ê°ì„±ì˜ ì†Œìœ ìì…ë‹ˆë‹¤. ê²‰ìœ¼ë¡œëŠ” ìœ ìˆœí•´ ë³´ì´ì§€ë§Œ ë‚´ë©´ì— ê°•í•œ ìƒëª…ë ¥ì„ í’ˆê³  ìˆì–´, ì–´ë–¤ í™˜ê²½ì—ì„œë„ ì‚´ì•„ë‚¨ëŠ” ëˆì§ˆê¸´ ë©´ì´ ìˆìŠµë‹ˆë‹¤.',
        career: 'ì˜ˆìˆ ê°€, ë””ìì´ë„ˆ, ìƒë‹´ì‚¬, êµì‚¬',
        love: 'ê°ì„±ì ì´ë©° ìƒëŒ€ë°©ì˜ ë§ˆìŒì„ ì˜ ì½ìŠµë‹ˆë‹¤',
        health: 'ê°„(è‚), ì‹ ê²½ê³„ ì£¼ì˜',
        lucky: 'ë´„(æ˜¥), ë™ìª½(æ±)' },
    2: { name: 'ë³‘í™”(ä¸™ç«)', symbol: 'â˜€ï¸', nature: 'íƒœì–‘, í° ë¶ˆ',
        personality: 'ë°ê³  í™”ë ¤í•œ ì„±ê²©ìœ¼ë¡œ ì£¼ë³€ì„ í™˜í•˜ê²Œ ë°íˆëŠ” ì‚¬ëŒì…ë‹ˆë‹¤. ì—´ì •ì ì´ê³  í™œë™ì ì´ë©° í‘œí˜„ë ¥ì´ ë›°ì–´ë‚©ë‹ˆë‹¤. ë‚™ì²œì ì´ê³  ê¸ì •ì ì¸ ì—ë„ˆì§€ê°€ ë„˜ì¹˜ì§€ë§Œ, ë•Œë¡œëŠ” ë‹¤í˜ˆì§ˆì ì´ê³  ê¸‰í•œ ë©´ì´ ìˆìŠµë‹ˆë‹¤. íƒœì–‘ì²˜ëŸ¼ ëª¨ë‘ì—ê²Œ ë”°ëœ»í•¨ì„ ì¤ë‹ˆë‹¤.',
        career: 'ë°©ì†¡ì¸, ì—°ì˜ˆì¸, ê°•ì‚¬, ë§ˆì¼€í„°',
        love: 'ì ê·¹ì ì´ë©° ì‚¬ë‘ì— ìˆì–´ ëœ¨ê±°ìš´ ì—´ì •ì„ ë³´ì…ë‹ˆë‹¤',
        health: 'ì‹¬ì¥(å¿ƒ), ì†Œì¥(å°è…¸) ì£¼ì˜',
        lucky: 'ì—¬ë¦„(å¤), ë‚¨ìª½(å—)' },
    3: { name: 'ì •í™”(ä¸ç«)', symbol: 'ğŸ•¯ï¸', nature: 'ì´›ë¶ˆ, ë³„ë¹›',
        personality: 'ì€ì€í•˜ê³  ì§€ì ì¸ ë§¤ë ¥ì˜ ì†Œìœ ìì…ë‹ˆë‹¤. ë‚´ë©´ì´ ë”°ëœ»í•˜ê³  ë°°ë ¤ì‹¬ì´ ê¹Šìœ¼ë©°, ì§ê´€ë ¥ì´ ë›°ì–´ë‚©ë‹ˆë‹¤. ì¡°ìš©í•˜ì§€ë§Œ ê¹Šì€ í†µì°°ë ¥ìœ¼ë¡œ í•µì‹¬ì„ ê¿°ëš«ìŠµë‹ˆë‹¤. ì´›ë¶ˆì²˜ëŸ¼ ì–´ë‘  ì†ì—ì„œ ë¹›ì„ ë°œí•˜ë©°, í•™ë¬¸ê³¼ ì˜ˆìˆ ì— ì¬ëŠ¥ì´ ìˆìŠµë‹ˆë‹¤.',
        career: 'ì—°êµ¬ì, í•™ì, ì‘ê°€, ì¢…êµì¸',
        love: 'ê¹Šì€ ë‚´ë©´ì˜ êµê°ì„ ì¤‘ì‹œí•©ë‹ˆë‹¤',
        health: 'ì‹¬ì¥(å¿ƒ), ëˆˆ(ç›®) ì£¼ì˜',
        lucky: 'ì—¬ë¦„(å¤), ë‚¨ìª½(å—)' },
    4: { name: 'ë¬´í† (æˆŠåœŸ)', symbol: 'â›°ï¸', nature: 'ì‚°, í° ë•…, ì œë°©',
        personality: 'ë“¬ì§í•˜ê³  í¬ìš©ë ¥ì´ í° ì„±ê²©ì…ë‹ˆë‹¤. ì‚°ì²˜ëŸ¼ ë¬µì§í•˜ê³  ì•ˆì •ì ì´ë©°, ë„“ì€ ëŒ€ì§€ì²˜ëŸ¼ ëª¨ë“  ê²ƒì„ í’ˆì–´ì£¼ëŠ” ë„ˆê·¸ëŸ¬ì›€ì´ ìˆìŠµë‹ˆë‹¤. ì‹ ë¢°ê°ì„ ì£¼ë©° ì£¼ë³€ ì‚¬ëŒë“¤ì˜ ì¤‘ì‹¬ì´ ë©ë‹ˆë‹¤. ë•Œë¡œëŠ” ë³€í™”ì— ë‘”ê°í•˜ê³  ëŠë¦° ë©´ì´ ìˆìŠµë‹ˆë‹¤.',
        career: 'ë¶€ë™ì‚°, ê±´ì¶•, ë†ì—…, ì¤‘ê°œì—…',
        love: 'ì•ˆì •ì ì´ê³  ë¯¿ìŒì§í•œ íŒŒíŠ¸ë„ˆì…ë‹ˆë‹¤',
        health: 'ìœ„(èƒƒ), ë¹„ì¥(è„¾) ì£¼ì˜',
        lucky: 'í™˜ì ˆê¸°(åœŸç”¨), ì¤‘ì•™' },
    5: { name: 'ê¸°í† (å·±åœŸ)', symbol: 'ğŸŒ¾', nature: 'ë°­, ë…¼, ì •ì›',
        personality: 'ì„¬ì„¸í•˜ê³  ì‹¤ë¦¬ì ì¸ ì„±ê²©ì…ë‹ˆë‹¤. ë°­ì²˜ëŸ¼ ë§Œë¬¼ì„ ê¸°ë¥´ëŠ” ì–‘ìœ¡ì˜ í˜ì´ ìˆìœ¼ë©°, ê¼¼ê¼¼í•˜ê³  ì‹¤ìš©ì ì…ë‹ˆë‹¤. ê²¸ì†í•˜ê³  ë´‰ì‚¬ì •ì‹ ì´ ê°•í•˜ë©°, ì‘ì€ ê²ƒë„ ì†Œì¤‘íˆ ì—¬ê¸°ëŠ” ë”°ëœ»í•œ ë§ˆìŒì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤.',
        career: 'êµìœ¡ì, ìš”ë¦¬ì‚¬, ë†ì—…, ì„œë¹„ìŠ¤ì—…',
        love: 'í—Œì‹ ì ì´ë©° ê°€ì •ì ì¸ ì„±í–¥ì´ ê°•í•©ë‹ˆë‹¤',
        health: 'ìœ„(èƒƒ), ì†Œí™”ê¸° ì£¼ì˜',
        lucky: 'í™˜ì ˆê¸°(åœŸç”¨), ì¤‘ì•™' },
    6: { name: 'ê²½ê¸ˆ(åºšé‡‘)', symbol: 'âš”ï¸', nature: 'ì‡ , ì¹¼, ë°”ìœ„',
        personality: 'ê°•ì¸í•˜ê³  ê²°ë‹¨ë ¥ ìˆëŠ” ì„±ê²©ì…ë‹ˆë‹¤. ì‡ ì²˜ëŸ¼ ë‹¨ë‹¨í•˜ê³  ì¹¼ì²˜ëŸ¼ ë‚ ì¹´ë¡œìš´ íŒë‹¨ë ¥ì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤. ì˜ë¦¬ê°€ ìˆê³  ì •ì˜ê°ì´ ê°•í•˜ë©°, ëª©í‘œë¥¼ í–¥í•´ ê³¼ê°í•˜ê²Œ ëŒì§„í•©ë‹ˆë‹¤. ë•Œë¡œëŠ” ì§€ë‚˜ì¹˜ê²Œ ê°•í•´ì„œ ë¶€ë”ªí˜ì´ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.',
        career: 'êµ°ì¸, ê²€ì°°, ì™¸ê³¼ì˜ì‚¬, ì—”ì§€ë‹ˆì–´',
        love: 'ì§ì„ ì ì´ë©° í•œë²ˆ ê²°ì •í•˜ë©´ ë°€ì–´ë¶™ì…ë‹ˆë‹¤',
        health: 'í(è‚º), ëŒ€ì¥(å¤§è…¸) ì£¼ì˜',
        lucky: 'ê°€ì„(ç§‹), ì„œìª½(è¥¿)' },
    7: { name: 'ì‹ ê¸ˆ(è¾›é‡‘)', symbol: 'ğŸ’', nature: 'ë³´ì„, ê¸ˆì€, ë°”ëŠ˜',
        personality: 'ì„¸ë ¨ë˜ê³  ì˜ˆë¯¼í•œ ê°ì„±ì˜ ì†Œìœ ìì…ë‹ˆë‹¤. ë³´ì„ì²˜ëŸ¼ ë¹›ë‚˜ëŠ” ë§¤ë ¥ì´ ìˆìœ¼ë©°, ë¯¸ì  ê°ê°ì´ ë›°ì–´ë‚©ë‹ˆë‹¤. ì™„ë²½ì£¼ì˜ì  ì„±í–¥ì´ ìˆê³ , ë‚ ì¹´ë¡œìš´ í†µì°°ë ¥ìœ¼ë¡œ ë³¸ì§ˆì„ ê¿°ëš«ìŠµë‹ˆë‹¤. ì˜ˆë¯¼í•˜ì—¬ ìƒì²˜ë¥¼ ì˜ ë°›ê¸°ë„ í•©ë‹ˆë‹¤.',
        career: 'ë³´ì„ìƒ, ê¸ˆìœµ, ì˜ˆìˆ ê°€, IT ì „ë¬¸ê°€',
        love: 'ì´ìƒì´ ë†’ê³  ë¡œë§¨í‹±í•œ ì—°ì• ë¥¼ í•©ë‹ˆë‹¤',
        health: 'í(è‚º), ê¸°ê´€ì§€ ì£¼ì˜',
        lucky: 'ê°€ì„(ç§‹), ì„œìª½(è¥¿)' },
    8: { name: 'ì„ìˆ˜(å£¬æ°´)', symbol: 'ğŸŒŠ', nature: 'ë°”ë‹¤, ê°•, í° ë¬¼',
        personality: 'ì§€í˜œë¡­ê³  í¬ìš©ë ¥ì´ í° ì„±ê²©ì…ë‹ˆë‹¤. ë°”ë‹¤ì²˜ëŸ¼ ë„“ê³  ê¹Šì€ ë§ˆìŒì„ ê°€ì§€ê³  ìˆìœ¼ë©°, ì–´ë–¤ ê²ƒì´ë“  ìˆ˜ìš©í•˜ëŠ” ê´€ëŒ€í•¨ì´ ìˆìŠµë‹ˆë‹¤. í™œë™ì ì´ë©° ë³€í™”ë¥¼ ë‘ë ¤ì›Œí•˜ì§€ ì•Šê³ , ê°•í•œ ì¶”ì§„ë ¥ìœ¼ë¡œ ëª©í‘œë¥¼ ë‹¬ì„±í•©ë‹ˆë‹¤.',
        career: 'ë¬´ì—­, ìœ í†µ, ì—¬í–‰ì—…, ì² í•™ì',
        love: 'ììœ ë¡œìš°ë©´ì„œë„ ê¹Šì€ ì‚¬ë‘ì„ í•©ë‹ˆë‹¤',
        health: 'ì‹ ì¥(è…), ë°©ê´‘(è†€èƒ±) ì£¼ì˜',
        lucky: 'ê²¨ìš¸(å†¬), ë¶ìª½(åŒ—)' },
    9: { name: 'ê³„ìˆ˜(ç™¸æ°´)', symbol: 'ğŸ’§', nature: 'ì´ìŠ¬, ë¹„, ì‹œëƒ‡ë¬¼',
        personality: 'ì§€ì ì´ê³  ì„¬ì„¸í•œ ì„±ê²©ì…ë‹ˆë‹¤. ì´ìŠ¬ì²˜ëŸ¼ ë§‘ê³  ìˆœìˆ˜í•œ ë§ˆìŒì„ ê°€ì§€ê³  ìˆìœ¼ë©°, ì§ê´€ë ¥ê³¼ ì˜ê°ì´ ë›°ì–´ë‚©ë‹ˆë‹¤. ì¡°ìš©í•˜ì§€ë§Œ ê¹Šì€ ì‚¬ê³ ë ¥ì„ ê°€ì§€ê³  ìˆê³ , í•™ë¬¸ê³¼ ì˜ˆìˆ ì— ì¬ëŠ¥ì´ ìˆìŠµë‹ˆë‹¤. ê°ì„±ì´ í’ë¶€í•˜ê³  ë°°ë ¤ì‹¬ì´ ê¹ŠìŠµë‹ˆë‹¤.',
        career: 'í•™ì, ì—°êµ¬ì›, ì˜ˆìˆ ê°€, ì‹¬ë¦¬ìƒë‹´',
        love: 'ì„¬ì„¸í•˜ë©° ëˆˆì— ë³´ì´ì§€ ì•ŠëŠ” ë°°ë ¤ë¥¼ í•©ë‹ˆë‹¤',
        health: 'ì‹ ì¥(è…), ë¹„ë‡¨ê¸° ì£¼ì˜',
        lucky: 'ê²¨ìš¸(å†¬), ë¶ìª½(åŒ—)' }
};

// ===== UI í•¨ìˆ˜ =====
function selectGender(btn) {
    document.querySelectorAll('.gender-btn').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
}

// í¼ ì´ˆê¸°í™”
(function initForm() {
    const yearSel = document.getElementById('year');
    const monthSel = document.getElementById('month');
    const daySel = document.getElementById('day');
    const currentYear = new Date().getFullYear();

    for (let y = currentYear; y >= 1920; y--) {
        yearSel.add(new Option(y + 'ë…„', y));
    }
    yearSel.value = 1990;

    for (let m = 1; m <= 12; m++) {
        monthSel.add(new Option(m + 'ì›”', m));
    }

    for (let d = 1; d <= 31; d++) {
        daySel.add(new Option(d + 'ì¼', d));
    }
})();

// ===== ë¶„ì„ ì‹¤í–‰ =====
function analyze() {
    const year = parseInt(document.getElementById('year').value);
    const month = parseInt(document.getElementById('month').value);
    const day = parseInt(document.getElementById('day').value);
    const hourIdx = parseInt(document.getElementById('hour').value);
    const gender = document.querySelector('.gender-btn.active').dataset.gender;

    // ì—°ì£¼
    const yearP = getYearPillar(year, month, day);
    // ì›”ì£¼
    const monthP = getMonthPillar(yearP.gan, month, day);
    // ì¼ì£¼
    const dayP = getDayPillar(year, month, day);
    // ì‹œì£¼
    let hourP = null;
    if (hourIdx >= 0) {
        const hourGan = getHourGan(dayP.gan, hourIdx);
        hourP = { gan: hourGan, ji: hourIdx };
    }

    // ì˜¤í–‰ ê³„ì‚°
    const elements = [0, 0, 0, 0, 0]; // ëª©,í™”,í† ,ê¸ˆ,ìˆ˜
    elements[CHEONGAN_ELEMENT[yearP.gan]]++;
    elements[JIJI_ELEMENT[yearP.ji]]++;
    elements[CHEONGAN_ELEMENT[monthP.gan]]++;
    elements[JIJI_ELEMENT[monthP.ji]]++;
    elements[CHEONGAN_ELEMENT[dayP.gan]]++;
    elements[JIJI_ELEMENT[dayP.ji]]++;
    if (hourP) {
        elements[CHEONGAN_ELEMENT[hourP.gan]]++;
        elements[JIJI_ELEMENT[hourP.ji]]++;
    }

    const totalElements = elements.reduce((a, b) => a + b, 0);

    // ê²°ê³¼ í‘œì‹œ
    renderIlgan(dayP.gan);
    renderPillars(yearP, monthP, dayP, hourP);
    renderOhaeng(elements, totalElements);
    renderPersonality(dayP.gan, elements);
    renderDetail(dayP.gan, yearP, monthP, dayP, hourP, elements, gender);

    document.getElementById('result').style.display = 'block';
    document.getElementById('result').scrollIntoView({ behavior: 'smooth', block: 'start' });
}

function renderIlgan(ganIdx) {
    const data = ILGAN_DATA[ganIdx];
    const elIdx = CHEONGAN_ELEMENT[ganIdx];
    document.getElementById('ilganBox').innerHTML = `
        <div class="ilgan-char" style="color:${ELEMENT_COLORS[elIdx]}">${data.symbol} ${CHEONGAN_HANJA[ganIdx]}</div>
        <div class="ilgan-info">
            <h3 style="color:${ELEMENT_COLORS[elIdx]}">${data.name}</h3>
            <p>${data.nature}</p>
            <p style="margin-top:4px;font-size:12px;color:var(--text-muted)">${CHEONGAN_YINYANG[ganIdx]}(${ganIdx % 2 === 0 ? 'é™½' : 'é™°'}) Â· ${ELEMENT_NAMES[elIdx]}</p>
        </div>
    `;
}

function renderPillars(yearP, monthP, dayP, hourP) {
    const pillars = [
        { label: 'ì‹œì£¼', hanja: 'æ™‚æŸ±', p: hourP },
        { label: 'ì¼ì£¼', hanja: 'æ—¥æŸ±', p: dayP },
        { label: 'ì›”ì£¼', hanja: 'æœˆæŸ±', p: monthP },
        { label: 'ì—°ì£¼', hanja: 'å¹´æŸ±', p: yearP },
    ];

    let html = '';
    pillars.forEach(({ label, hanja, p }) => {
        if (!p) {
            html += `<div class="pillar" style="opacity:0.4">
                <div class="pillar-label">${label}</div>
                <div class="pillar-hanja">${hanja}</div>
                <div class="pillar-char serif" style="color:var(--text-muted)">?</div>
                <div class="divider"></div>
                <div class="pillar-char serif" style="color:var(--text-muted)">?</div>
                <div class="pillar-name">ì‹œê°„ ë¯¸ì…ë ¥</div>
            </div>`;
            return;
        }
        const ganEl = CHEONGAN_ELEMENT[p.gan];
        const jiEl = JIJI_ELEMENT[p.ji];
        html += `<div class="pillar">
            <div class="pillar-label">${label}</div>
            <div class="pillar-hanja">${hanja}</div>
            <div class="pillar-char serif" style="color:${ELEMENT_COLORS[ganEl]}">${CHEONGAN_HANJA[p.gan]}</div>
            <div class="pillar-name">${CHEONGAN[p.gan]} Â· ${ELEMENT_SHORT[ganEl]}</div>
            <span class="pillar-element ${ELEMENT_CLASSES[ganEl]}">${ELEMENT_NAMES[ganEl]}</span>
            <div class="divider"></div>
            <div class="pillar-char serif" style="color:${ELEMENT_COLORS[jiEl]}">${JIJI_HANJA[p.ji]}</div>
            <div class="pillar-name">${JIJI[p.ji]} Â· ${ELEMENT_SHORT[jiEl]}</div>
            <span class="pillar-element ${ELEMENT_CLASSES[jiEl]}">${ELEMENT_NAMES[jiEl]}</span>
        </div>`;
    });

    document.getElementById('pillarsGrid').innerHTML = html;
}

function renderOhaeng(elements, total) {
    const maxEl = Math.max(...elements);
    let html = '';
    const names = ['ğŸŒ³ ëª©(æœ¨)', 'ğŸ”¥ í™”(ç«)', 'ğŸ”ï¸ í† (åœŸ)', 'âš”ï¸ ê¸ˆ(é‡‘)', 'ğŸ’§ ìˆ˜(æ°´)'];
    elements.forEach((count, i) => {
        const pct = total > 0 ? Math.round(count / total * 100) : 0;
        const width = maxEl > 0 ? Math.max(count / maxEl * 100, 5) : 5;
        html += `<div class="ohaeng-row">
            <div class="ohaeng-label" style="color:${ELEMENT_COLORS[i]}">${names[i]}</div>
            <div class="ohaeng-bar-bg">
                <div class="ohaeng-bar ${BAR_CLASSES[i]}" style="width:${width}%">${pct}%</div>
            </div>
            <div class="ohaeng-count" style="color:${ELEMENT_COLORS[i]}">${count}</div>
        </div>`;
    });
    document.getElementById('ohaengBars').innerHTML = html;
}

function renderPersonality(ganIdx, elements) {
    const data = ILGAN_DATA[ganIdx];
    const maxEl = elements.indexOf(Math.max(...elements));
    const minEl = elements.indexOf(Math.min(...elements));

    let extra = '';
    if (elements[maxEl] >= 3) {
        extra += `<br><br>ì˜¤í–‰ì—ì„œ <strong style="color:${ELEMENT_COLORS[maxEl]}">${ELEMENT_NAMES[maxEl]}</strong>ì´ ê°•í•˜ê²Œ ë‚˜íƒ€ë‚©ë‹ˆë‹¤. `;
        const strongTraits = ['ì„±ì¥ê³¼ ë°œì „ì— ëŒ€í•œ ìš•êµ¬ê°€ í¬ê³  ì¸ìí•œ ì„±í’ˆ', 'ì—´ì •ê³¼ ì˜ˆì˜ê°€ ë„˜ì¹˜ë©° í‘œí˜„ë ¥ì´ ë›°ì–´ë‚¨', 'ì•ˆì •ì„ ì¶”êµ¬í•˜ê³  ì‹ ë¢°ê°ì´ ê°•í•¨', 'ê²°ë‹¨ë ¥ê³¼ ì •ì˜ê°ì´ ë›°ì–´ë‚¨', 'ì§€í˜œë¡­ê³  ìœ ì—°í•œ ì‚¬ê³ ë¥¼ í•©ë‹ˆë‹¤'];
        extra += strongTraits[maxEl] + '.';
    }
    if (elements[minEl] === 0) {
        extra += `<br><br>âš ï¸ <strong style="color:${ELEMENT_COLORS[minEl]}">${ELEMENT_NAMES[minEl]}</strong>ì´ ë¶€ì¡±í•©ë‹ˆë‹¤. `;
        const weakAdvice = ['ì¸ë‚´ì‹¬ì„ ê¸°ë¥´ê³  ìì—°ê³¼ ê°€ê¹Œì´í•˜ë©´ ì¢‹ìŠµë‹ˆë‹¤', 'ì—´ì •ê³¼ í™œë ¥ì„ ë³´ì¶©í•˜ì„¸ìš”. ìš´ë™ì´ ë„ì›€ë©ë‹ˆë‹¤', 'ì•ˆì •ê°ì„ ì°¾ëŠ” ë…¸ë ¥ì´ í•„ìš”í•©ë‹ˆë‹¤', 'ê²°ë‹¨ë ¥ì„ ê¸°ë¥´ê³  ìê¸°ì£¼ì¥ì„ ë¶„ëª…íˆ í•˜ì„¸ìš”', 'ìœ ì—°í•œ ì‚¬ê³ ì™€ ì§€í˜œë¥¼ ê¸°ë¥´ì„¸ìš”'];
        extra += weakAdvice[minEl] + '.';
    }

    document.getElementById('personalityText').innerHTML = data.personality + extra;
}

function renderDetail(ganIdx, yearP, monthP, dayP, hourP, elements, gender) {
    const data = ILGAN_DATA[ganIdx];
    const yinyang = CHEONGAN_YINYANG[ganIdx] === 'ì–‘' ? 'é™½' : 'é™°';

    // ìš©ì‹  (ê°„ì†Œí™”: ê°€ì¥ ì•½í•œ ì˜¤í–‰)
    const minEl = elements.indexOf(Math.min(...elements));

    // 12ìš´ì„± (ì¼ì§€ ê¸°ì¤€ ê°„ì†Œí™”)
    const unsung12 = ['ì ˆ','íƒœ','ì–‘','ì¥ìƒ','ëª©ìš•','ê´€ëŒ€','ê±´ë¡','ì œì™•','ì‡ ','ë³‘','ì‚¬','ë¬˜'];
    const unsungIdx = (dayP.ji - dayP.gan * 12 / 10 + 120) % 12;
    const unsungName = unsung12[Math.floor(unsungIdx) % 12];

    let html = `
        <div class="analysis-item">
            <div class="analysis-item-title">ğŸ’¼ ì í•©í•œ ì§ì—…</div>
            <div class="analysis-item-text">${data.career}</div>
        </div>
        <div class="analysis-item">
            <div class="analysis-item-title">â¤ï¸ ì—°ì•  ì„±í–¥</div>
            <div class="analysis-item-text">${data.love}</div>
        </div>
        <div class="analysis-item">
            <div class="analysis-item-title">ğŸ¥ ê±´ê°• ì£¼ì˜</div>
            <div class="analysis-item-text">${data.health}</div>
        </div>
        <div class="analysis-item">
            <div class="analysis-item-title">ğŸ€ ê¸¸ìš´ ë°©í–¥</div>
            <div class="analysis-item-text">${data.lucky}</div>
        </div>
        <div class="analysis-item">
            <div class="analysis-item-title">âš–ï¸ ìŒì–‘</div>
            <div class="analysis-item-text">${CHEONGAN_YINYANG[ganIdx]}(${yinyang}) â€” ${ganIdx % 2 === 0 ? 'ì ê·¹ì ì´ê³  ì™¸í–¥ì ì¸ ê¸°ìš´' : 'ë‚´ë©´ì ì´ê³  ìˆ˜ìš©ì ì¸ ê¸°ìš´'}</div>
        </div>
        <div class="analysis-item">
            <div class="analysis-item-title">ğŸ¯ ìš©ì‹  (ç”¨ç¥)</div>
            <div class="analysis-item-text" style="color:${ELEMENT_COLORS[minEl]}">
                ${ELEMENT_NAMES[minEl]} â€” ë¶€ì¡±í•œ ì˜¤í–‰ì„ ë³´ì¶©í•˜ë©´ ìš´ì´ ì¢‹ì•„ì§‘ë‹ˆë‹¤
            </div>
        </div>
    `;

    document.getElementById('detailGrid').innerHTML = html;
}
</script>

</body>
</html>
